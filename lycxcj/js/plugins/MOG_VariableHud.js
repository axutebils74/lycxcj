var Imported=Imported||{};Imported.MOG_VariableHud=!0;var Moghunter=Moghunter||{};Moghunter.parameters=PluginManager.parameters("MOG_VariableHud"),Moghunter.variableHud_Max=20,Moghunter.variableHud_Visible=[],Moghunter.variableHud_VisibleInt=[],Moghunter.variableHud_VariableID=[],Moghunter.variableHud_ValueLimit=[],Moghunter.variableHud_FileName=[],Moghunter.variableHud_LayX=[],Moghunter.variableHud_LayY=[],Moghunter.variableHud_NumX=[],Moghunter.variableHud_NumY=[],Moghunter.variableHud_NumAlign=[],Moghunter.variableHud_NumFontSize=[],Moghunter.variableHud_Type=[];for(var i=0;i<Moghunter.variableHud_Max;i++)Moghunter.variableHud_Visible[i]=String(Moghunter.parameters["Hud "+String(i+1)+" Enable"]||"false"),Moghunter.variableHud_VisibleInt[i]=String(Moghunter.parameters["Hud "+String(i+1)+" Start Visible"]||"true"),Moghunter.variableHud_Type[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Mode"]||0),Moghunter.variableHud_VariableID[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Variable ID"]||1),Moghunter.variableHud_ValueLimit[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Maximum Value"]||9999),Moghunter.variableHud_FileName[i]=String(Moghunter.parameters["Hud "+String(i+1)+" File Name"]||"Hud_"),Moghunter.variableHud_LayX[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Layout X"]||0),Moghunter.variableHud_LayY[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Layout Y"]||0),Moghunter.variableHud_NumX[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Number X"]||-12),Moghunter.variableHud_NumY[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Number Y"]||10),Moghunter.variableHud_NumAlign[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Number Align"]||1),Moghunter.variableHud_NumFontSize[i]=Number(Moghunter.parameters["Hud "+String(i+1)+" Font Size"]||18);ImageManager.loadVariableHud=function(e){return this.loadBitmap("img/variablehud/",e,0,!0)};var _mog_variableHud_pluginCommand=Game_Interpreter.prototype.pluginCommand;Game_Interpreter.prototype.pluginCommand=function(e,a){if(_mog_variableHud_pluginCommand.call(this,e,a),"hide_variable_hud"===e){var i=Number(a[1])-1;$gameSystem._variableHudData[i]&&($gameSystem._variableHudData[i][0]=!1)}else if("show_variable_hud"===e){i=Number(a[1])-1;$gameSystem._variableHudData[i]&&($gameSystem._variableHudData[i][0]=!0)}return!0};var _mog_variableHud_gsys_initialize=Game_System.prototype.initialize;Game_System.prototype.initialize=function(){_mog_variableHud_gsys_initialize.call(this),this._variableHudData=[],this._variableHudVisible=!0},Game_CharacterBase.prototype.screen_realX=function(){return this.scrolledX()*$gameMap.tileWidth()},Game_CharacterBase.prototype.screen_realY=function(){return this.scrolledY()*$gameMap.tileHeight()};var _mog_variableHud_scMap_createAllWindows=Scene_Map.prototype.createAllWindows;function VariableHud(){this.initialize.apply(this,arguments)}Scene_Map.prototype.createAllWindows=function(){this.createVariableHuds(),_mog_variableHud_scMap_createAllWindows.call(this)},Scene_Map.prototype.createVariableHuds=function(){this.createVariableHudField(),this._variableHud=[];for(var e=0;e<Moghunter.variableHud_Max;e++){if(!$gameSystem._variableHudData[e]){var a="true"===String(Moghunter.variableHud_VisibleInt[e]);$gameSystem._variableHudData[e]=[a,0]}this._variableHud[e]=new VariableHud(e),this._variableField.addChild(this._variableHud[e])}},Scene_Map.prototype.createVariableHudField=function(){this._variableField=new Sprite,this.addChild(this._variableField)},VariableHud.prototype=Object.create(Sprite.prototype),VariableHud.prototype.constructor=VariableHud,VariableHud.prototype.initialize=function(e){Sprite.prototype.initialize.call(this),this._index=e,this._enabled="true"===String(Moghunter.variableHud_Visible[this._index]),this._enabled&&this.createSprites()},VariableHud.prototype.variableID=function(){return Moghunter.variableHud_VariableID[this._index]},VariableHud.prototype.maxValue=function(){return Number(Moghunter.variableHud_ValueLimit[this._index])},VariableHud.prototype.type=function(){return Moghunter.variableHud_Type[this._index]},VariableHud.prototype.number=function(){return 0===this.type()?$gameVariables.value(this.variableID()):$gameParty.numItems(this.item())},VariableHud.prototype.item=function(){return $dataItems[this.variableID()]},VariableHud.prototype.createSprites=function(){this._variable=$gameVariables.value(this.variableID()),this._hud_size=[-1,0,0,0],this.createLayout(),this.createNumber(),this.refreshHud(),this.needHide()&&(this.opacity=0)},VariableHud.prototype.createLayout=function(){var e=String(Moghunter.variableHud_FileName[this._index]);this._layout=new Sprite(ImageManager.loadVariableHud(e)),this._layout.x=Number(Moghunter.variableHud_LayX[this._index]),this._layout.y=Number(Moghunter.variableHud_LayY[this._index]),this.addChild(this._layout)},VariableHud.prototype.createNumber=function(){this._number=new Sprite(new Bitmap(200,46)),this._number.x=this._layout.x+Number(Moghunter.variableHud_NumX[this._index]),this._number.y=this._layout.y+Number(Moghunter.variableHud_NumY[this._index]),this._number.bitmap.fontSize=Moghunter.variableHud_NumFontSize[this._index],this.addChild(this._number)},VariableHud.prototype.refreshNumber=function(){this._number.bitmap.clear(),this._number.bitmap.drawText(String(this._variable),0,0,190,44,this.aligntype())},VariableHud.prototype.refreshHud=function(){0===this.type()&&this.number()>this.maxValue()&&$gameVariables.setValue(this.variableID(),this.maxValue()),this._variable=this.number(),this.refreshNumber()},VariableHud.prototype.needRefreshHud=function(){return this._variable!=this.number()},VariableHud.prototype.aligntype=function(){return 0===Moghunter.variableHud_NumAlign[this._index]?"left":1===Moghunter.variableHud_NumAlign[this._index]?"center":"right"},VariableHud.prototype.update=function(){Sprite.prototype.update.call(this),this._enabled&&this.updateSprites()},VariableHud.prototype.needHide=function(){return!!$gameMessage.isBusy()||(!$gameSystem._variableHudData[this._index][0]||!(!Imported.MOG_ChronoEngine||!$gameSystem.isChronoMode()))},VariableHud.prototype.needFade=function(){return-1!==this._hud_size[0]&&(!($gamePlayer.screen_realX()<this._hud_size[0])&&(!($gamePlayer.screen_realX()>this._hud_size[2])&&(!($gamePlayer.screen_realY()<this._hud_size[1])&&!($gamePlayer.screen_realY()>this._hud_size[3]))))},VariableHud.prototype.getData=function(){this._hud_size[0]=this._layout.x-$gameMap.tileWidth()/2,this._hud_size[1]=this._layout.y-$gameMap.tileHeight()/2,this._hud_size[2]=this._layout.x+this._layout.bitmap.width,this._hud_size[3]=this._layout.y+this._layout.bitmap.height},VariableHud.prototype.updateVisible=function(){this.needHide()?this.opacity-=15:this.needFade()?this.opacity>90&&(this.opacity-=10,this.opacity<90&&(this.opacity=90)):this.opacity+=10},VariableHud.prototype.updateSprites=function(){this.needRefreshHud()&&this.refreshHud(),-1===this._hud_size[0]&&this._layout.bitmap.isReady()&&this.getData(),this.updateVisible()};