/*! FPSMeter 0.3.1 - 9th May 2013 | https://github.com/Darsain/fpsmeter */
!function(t,e){function n(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function o(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function a(t,e){if("array"!==o(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,a=e.length;n<a;n++)if(e[n]===t)return n;return-1}function i(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(o(e[1][t])){case"object":e[0][t]=i({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?i.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function r(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function h(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function l(t,e){function s(t,e,n,o){return O[0|t][Math.round(Math.min((e-n)/(o-n)*I,I))]}function d(){T.legend.fps!==V&&(T.legend.fps=V,T.legend[f]=V?"FPS":"ms"),z=V?P.fps:P.duration,T.count[f]=999<z?"999+":z.toFixed(99<z?0:H.decimals)}function g(){for(S=c(),R<S-H.threshold&&(P.fps-=P.fps/Math.max(1,60*H.smoothing/H.interval),P.duration=1e3/P.fps),E=H.history;E--;)B[E]=0===E?P.fps:B[E-1],N[E]=0===E?P.duration:N[E-1];if(d(),H.heat){if(q.length)for(E=q.length;E--;)q[E].el.style[k[q[E].name].heatOn]=V?s(k[q[E].name].heatmap,P.fps,0,H.maxFps):s(k[q[E].name].heatmap,P.duration,H.threshold,0);if(T.graph&&k.column.heatOn)for(E=j.length;E--;)j[E].style[k.column.heatOn]=V?s(k.column.heatmap,B[E],0,H.maxFps):s(k.column.heatmap,N[E],H.threshold,0)}if(T.graph)for(A=0;A<H.history;A++)j[A].style.height=(V?B[A]?Math.round(M/H.maxFps*Math.min(B[A],H.maxFps)):0:N[A]?Math.round(M/H.threshold*Math.min(N[A],H.threshold)):0)+"px"}function m(){20>H.interval?(F=u(m),g()):(F=setTimeout(m,H.interval),C=u(g))}function w(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),P.toggle()}function v(){H.toggleOn&&h(T.container,H.toggleOn,w,1),t.removeChild(T.container)}function y(){if(T.container&&v(),k=l.theme[H.theme],!(O=k.compiledHeatmaps||[]).length&&k.heatmaps.length){for(A=0;A<k.heatmaps.length;A++)for(O[A]=[],E=0;E<=I;E++){var e,o=O[A],a=E;e=.33/I*E;var i=k.heatmaps[A].saturation,c=k.heatmaps[A].lightness,s=void 0,p=void 0,u=void 0,g=u=void 0,m=s=p=void 0;m=void 0;0===(u=.5>=c?c*(1+i):c+i-c*i)?e="#000":(p=(u-(g=2*c-u))/u,m=(e*=6)-(s=Math.floor(e)),m*=u*p,0===s||6===s?(s=u,p=g+m,u=g):1===s?(s=u-m,p=u,u=g):2===s?(s=g,p=u,u=g+m):3===s?(s=g,p=u-m):4===s?(s=g+m,p=g):(s=u,p=g,u-=m),e="#"+r(s)+r(p)+r(u)),o[a]=e}k.compiledHeatmaps=O}for(var f in T.container=n(document.createElement("div"),k.container),T.count=T.container.appendChild(n(document.createElement("div"),k.count)),T.legend=T.container.appendChild(n(document.createElement("div"),k.legend)),T.graph=H.graph?T.container.appendChild(n(document.createElement("div"),k.graph)):0,q.length=0,T)T[f]&&k[f].heatOn&&q.push({name:f,el:T[f]});if(j.length=0,T.graph)for(T.graph.style.width=H.history*k.column.width+(H.history-1)*k.column.spacing+"px",E=0;E<H.history;E++)j[E]=T.graph.appendChild(n(document.createElement("div"),k.column)),j[E].style.position="absolute",j[E].style.bottom=0,j[E].style.right=E*k.column.width+E*k.column.spacing+"px",j[E].style.width=k.column.width+"px",j[E].style.height="0px";n(T.container,H),d(),t.appendChild(T.container),T.graph&&(M=T.graph.clientHeight),H.toggleOn&&("click"===H.toggleOn&&(T.container.style.cursor="pointer"),h(T.container,H.toggleOn,w))}"object"===o(t)&&undefined===t.nodeType&&(e=t,t=document.body),t||(t=document.body);var k,O,S,F,C,M,z,E,A,P=this,H=i({},l.defaults,e||{}),T={},j=[],I=100,q=[],D=H.threshold,L=0,R=c()-D,B=[],N=[],V="fps"===H.show;P.options=H,P.fps=0,P.duration=0,P.isPaused=0,P.tickStart=function(){L=c()},P.tick=function(){S=c(),D+=(S-R-D)/H.smoothing,P.fps=1e3/D,P.duration=L<R?D:S-L,R=S},P.pause=function(){return F&&(P.isPaused=1,clearTimeout(F),p(F),p(C),F=C=0),P},P.resume=function(){return F||(P.isPaused=0,m()),P},P.set=function(t,e){return H[t]=e,V="fps"===H.show,-1!==a(t,x)&&y(),-1!==a(t,b)&&n(T.container,H),P},P.showDuration=function(){return P.set("show","ms"),P},P.showFps=function(){return P.set("show","fps"),P},P.toggle=function(){return P.set("show",V?"ms":"fps"),P},P.hide=function(){return P.pause(),T.container.style.display="none",P},P.show=function(){return P.resume(),T.container.style.display="block",P},P.destroy=function(){P.pause(),v(),P.tick=P.tickStart=function(){}},y(),m()}var c,s=t.performance;c=s&&(s.now||s.webkitNow)?s[s.now?"now":"webkitNow"].bind(s):function(){return+new Date};for(var p=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,u=t.requestAnimationFrame,d=0,g=0,m=(s=["moz","webkit","o"]).length;g<m&&!p;++g)u=(p=t[s[g]+"CancelAnimationFrame"]||t[s[g]+"CancelRequestAnimationFrame"])&&t[s[g]+"RequestAnimationFrame"];p||(u=function(e){var n=c(),o=Math.max(0,16-(n-d));return d=n+o,t.setTimeout((function(){e(n+o)}),o)},p=function(t){clearTimeout(t)});var f="string"===o(document.createElement("div").textContent)?"textContent":"innerText";l.extend=i,window.FPSMeter=l,l.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var x=["toggleOn","theme","heat","graph","history"],b="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter);