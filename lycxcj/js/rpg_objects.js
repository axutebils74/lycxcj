function Game_Temp(){this.initialize.apply(this,arguments)}function Game_System(){this.initialize.apply(this,arguments)}function Game_Timer(){this.initialize.apply(this,arguments)}function Game_Message(){this.initialize.apply(this,arguments)}function Game_Switches(){this.initialize.apply(this,arguments)}function Game_Variables(){this.initialize.apply(this,arguments)}function Game_SelfSwitches(){this.initialize.apply(this,arguments)}function Game_Screen(){this.initialize.apply(this,arguments)}function Game_Picture(){this.initialize.apply(this,arguments)}function Game_Item(){this.initialize.apply(this,arguments)}function Game_Action(){this.initialize.apply(this,arguments)}function Game_ActionResult(){this.initialize.apply(this,arguments)}function Game_BattlerBase(){this.initialize.apply(this,arguments)}function Game_Battler(){this.initialize.apply(this,arguments)}function Game_Actor(){this.initialize.apply(this,arguments)}function Game_Enemy(){this.initialize.apply(this,arguments)}function Game_Actors(){this.initialize.apply(this,arguments)}function Game_Unit(){this.initialize.apply(this,arguments)}function Game_Party(){this.initialize.apply(this,arguments)}function Game_Troop(){this.initialize.apply(this,arguments)}function Game_Map(){this.initialize.apply(this,arguments)}function Game_CommonEvent(){this.initialize.apply(this,arguments)}function Game_CharacterBase(){this.initialize.apply(this,arguments)}function Game_Character(){this.initialize.apply(this,arguments)}function Game_Player(){this.initialize.apply(this,arguments)}function Game_Follower(){this.initialize.apply(this,arguments)}function Game_Followers(){this.initialize.apply(this,arguments)}function Game_Vehicle(){this.initialize.apply(this,arguments)}function Game_Event(){this.initialize.apply(this,arguments)}function Game_Interpreter(){this.initialize.apply(this,arguments)}Game_Temp.prototype.initialize=function(){this._isPlaytest=Utils.isOptionValid("test"),this._commonEventId=0,this._destinationX=null,this._destinationY=null},Game_Temp.prototype.isPlaytest=function(){return this._isPlaytest},Game_Temp.prototype.reserveCommonEvent=function(t){this._commonEventId=t},Game_Temp.prototype.clearCommonEvent=function(){this._commonEventId=0},Game_Temp.prototype.isCommonEventReserved=function(){return this._commonEventId>0},Game_Temp.prototype.reservedCommonEvent=function(){return $dataCommonEvents[this._commonEventId]},Game_Temp.prototype.setDestination=function(t,e){this._destinationX=t,this._destinationY=e},Game_Temp.prototype.clearDestination=function(){this._destinationX=null,this._destinationY=null},Game_Temp.prototype.isDestinationValid=function(){return null!==this._destinationX},Game_Temp.prototype.destinationX=function(){return this._destinationX},Game_Temp.prototype.destinationY=function(){return this._destinationY},Game_System.prototype.initialize=function(){this._saveEnabled=!0,this._menuEnabled=!0,this._encounterEnabled=!0,this._formationEnabled=!0,this._battleCount=0,this._winCount=0,this._escapeCount=0,this._saveCount=0,this._versionId=0,this._framesOnSave=0,this._bgmOnSave=null,this._bgsOnSave=null,this._windowTone=null,this._battleBgm=null,this._victoryMe=null,this._defeatMe=null,this._savedBgm=null,this._walkingBgm=null},Game_System.prototype.isJapanese=function(){return $dataSystem.locale.match(/^ja/)},Game_System.prototype.isChinese=function(){return $dataSystem.locale.match(/^zh/)},Game_System.prototype.isKorean=function(){return $dataSystem.locale.match(/^ko/)},Game_System.prototype.isCJK=function(){return $dataSystem.locale.match(/^(ja|zh|ko)/)},Game_System.prototype.isRussian=function(){return $dataSystem.locale.match(/^ru/)},Game_System.prototype.isSideView=function(){return $dataSystem.optSideView},Game_System.prototype.isSaveEnabled=function(){return this._saveEnabled},Game_System.prototype.disableSave=function(){this._saveEnabled=!1},Game_System.prototype.enableSave=function(){this._saveEnabled=!0},Game_System.prototype.isMenuEnabled=function(){return this._menuEnabled},Game_System.prototype.disableMenu=function(){this._menuEnabled=!1},Game_System.prototype.enableMenu=function(){this._menuEnabled=!0},Game_System.prototype.isEncounterEnabled=function(){return this._encounterEnabled},Game_System.prototype.disableEncounter=function(){this._encounterEnabled=!1},Game_System.prototype.enableEncounter=function(){this._encounterEnabled=!0},Game_System.prototype.isFormationEnabled=function(){return this._formationEnabled},Game_System.prototype.disableFormation=function(){this._formationEnabled=!1},Game_System.prototype.enableFormation=function(){this._formationEnabled=!0},Game_System.prototype.battleCount=function(){return this._battleCount},Game_System.prototype.winCount=function(){return this._winCount},Game_System.prototype.escapeCount=function(){return this._escapeCount},Game_System.prototype.saveCount=function(){return this._saveCount},Game_System.prototype.versionId=function(){return this._versionId},Game_System.prototype.windowTone=function(){return this._windowTone||$dataSystem.windowTone},Game_System.prototype.setWindowTone=function(t){this._windowTone=t},Game_System.prototype.battleBgm=function(){return this._battleBgm||$dataSystem.battleBgm},Game_System.prototype.setBattleBgm=function(t){this._battleBgm=t},Game_System.prototype.victoryMe=function(){return this._victoryMe||$dataSystem.victoryMe},Game_System.prototype.setVictoryMe=function(t){this._victoryMe=t},Game_System.prototype.defeatMe=function(){return this._defeatMe||$dataSystem.defeatMe},Game_System.prototype.setDefeatMe=function(t){this._defeatMe=t},Game_System.prototype.onBattleStart=function(){this._battleCount++},Game_System.prototype.onBattleWin=function(){this._winCount++},Game_System.prototype.onBattleEscape=function(){this._escapeCount++},Game_System.prototype.onBeforeSave=function(){this._saveCount++,this._versionId=$dataSystem.versionId,this._framesOnSave=Graphics.frameCount,this._bgmOnSave=AudioManager.saveBgm(),this._bgsOnSave=AudioManager.saveBgs()},Game_System.prototype.onAfterLoad=function(){Graphics.frameCount=this._framesOnSave,AudioManager.playBgm(this._bgmOnSave),AudioManager.playBgs(this._bgsOnSave)},Game_System.prototype.playtime=function(){return Math.floor(Graphics.frameCount/60)},Game_System.prototype.playtimeText=function(){var t=Math.floor(this.playtime()/60/60),e=Math.floor(this.playtime()/60)%60,a=this.playtime()%60;return t.padZero(2)+":"+e.padZero(2)+":"+a.padZero(2)},Game_System.prototype.saveBgm=function(){this._savedBgm=AudioManager.saveBgm()},Game_System.prototype.replayBgm=function(){this._savedBgm&&AudioManager.replayBgm(this._savedBgm)},Game_System.prototype.saveWalkingBgm=function(){this._walkingBgm=AudioManager.saveBgm()},Game_System.prototype.replayWalkingBgm=function(){this._walkingBgm&&AudioManager.playBgm(this._walkingBgm)},Game_Timer.prototype.initialize=function(){this._frames=0,this._working=!1},Game_Timer.prototype.update=function(t){t&&this._working&&this._frames>0&&(this._frames--,0===this._frames&&this.onExpire())},Game_Timer.prototype.start=function(t){this._frames=t,this._working=!0},Game_Timer.prototype.stop=function(){this._working=!1},Game_Timer.prototype.isWorking=function(){return this._working},Game_Timer.prototype.seconds=function(){return Math.floor(this._frames/60)},Game_Timer.prototype.onExpire=function(){BattleManager.abort()},Game_Message.prototype.initialize=function(){this.clear()},Game_Message.prototype.clear=function(){this._texts=[],this._choices=[],this._faceName="",this._faceIndex=0,this._background=0,this._positionType=2,this._choiceDefaultType=0,this._choiceCancelType=0,this._choiceBackground=0,this._choicePositionType=2,this._numInputVariableId=0,this._numInputMaxDigits=0,this._itemChoiceVariableId=0,this._itemChoiceItypeId=0,this._scrollMode=!1,this._scrollSpeed=2,this._scrollNoFast=!1,this._choiceCallback=null},Game_Message.prototype.choices=function(){return this._choices},Game_Message.prototype.faceName=function(){return this._faceName},Game_Message.prototype.faceIndex=function(){return this._faceIndex},Game_Message.prototype.background=function(){return this._background},Game_Message.prototype.positionType=function(){return this._positionType},Game_Message.prototype.choiceDefaultType=function(){return this._choiceDefaultType},Game_Message.prototype.choiceCancelType=function(){return this._choiceCancelType},Game_Message.prototype.choiceBackground=function(){return this._choiceBackground},Game_Message.prototype.choicePositionType=function(){return this._choicePositionType},Game_Message.prototype.numInputVariableId=function(){return this._numInputVariableId},Game_Message.prototype.numInputMaxDigits=function(){return this._numInputMaxDigits},Game_Message.prototype.itemChoiceVariableId=function(){return this._itemChoiceVariableId},Game_Message.prototype.itemChoiceItypeId=function(){return this._itemChoiceItypeId},Game_Message.prototype.scrollMode=function(){return this._scrollMode},Game_Message.prototype.scrollSpeed=function(){return this._scrollSpeed},Game_Message.prototype.scrollNoFast=function(){return this._scrollNoFast},Game_Message.prototype.add=function(t){this._texts.push(t)},Game_Message.prototype.setFaceImage=function(t,e){this._faceName=t,this._faceIndex=e},Game_Message.prototype.setBackground=function(t){this._background=t},Game_Message.prototype.setPositionType=function(t){this._positionType=t},Game_Message.prototype.setChoices=function(t,e,a){this._choices=t,this._choiceDefaultType=e,this._choiceCancelType=a},Game_Message.prototype.setChoiceBackground=function(t){this._choiceBackground=t},Game_Message.prototype.setChoicePositionType=function(t){this._choicePositionType=t},Game_Message.prototype.setNumberInput=function(t,e){this._numInputVariableId=t,this._numInputMaxDigits=e},Game_Message.prototype.setItemChoice=function(t,e){this._itemChoiceVariableId=t,this._itemChoiceItypeId=e},Game_Message.prototype.setScroll=function(t,e){this._scrollMode=!0,this._scrollSpeed=t,this._scrollNoFast=e},Game_Message.prototype.setChoiceCallback=function(t){this._choiceCallback=t},Game_Message.prototype.onChoice=function(t){this._choiceCallback&&(this._choiceCallback(t),this._choiceCallback=null)},Game_Message.prototype.hasText=function(){return this._texts.length>0},Game_Message.prototype.isChoice=function(){return this._choices.length>0},Game_Message.prototype.isNumberInput=function(){return this._numInputVariableId>0},Game_Message.prototype.isItemChoice=function(){return this._itemChoiceVariableId>0},Game_Message.prototype.isBusy=function(){return this.hasText()||this.isChoice()||this.isNumberInput()||this.isItemChoice()},Game_Message.prototype.newPage=function(){this._texts.length>0&&(this._texts[this._texts.length-1]+="\f")},Game_Message.prototype.allText=function(){return this._texts.reduce((function(t,e){return t+"\n"+e}))},Game_Switches.prototype.initialize=function(){this.clear()},Game_Switches.prototype.clear=function(){this._data=[]},Game_Switches.prototype.value=function(t){return!!this._data[t]},Game_Switches.prototype.setValue=function(t,e){t>0&&t<$dataSystem.switches.length&&(this._data[t]=e,this.onChange())},Game_Switches.prototype.onChange=function(){$gameMap.requestRefresh()},Game_Variables.prototype.initialize=function(){this.clear()},Game_Variables.prototype.clear=function(){this._data=[]},Game_Variables.prototype.value=function(t){return this._data[t]||0},Game_Variables.prototype.setValue=function(t,e){t>0&&t<$dataSystem.variables.length&&("number"==typeof e&&(e=Math.floor(e)),this._data[t]=e,this.onChange())},Game_Variables.prototype.onChange=function(){$gameMap.requestRefresh()},Game_SelfSwitches.prototype.initialize=function(){this.clear()},Game_SelfSwitches.prototype.clear=function(){this._data={}},Game_SelfSwitches.prototype.value=function(t){return!!this._data[t]},Game_SelfSwitches.prototype.setValue=function(t,e){e?this._data[t]=!0:delete this._data[t],this.onChange()},Game_SelfSwitches.prototype.onChange=function(){$gameMap.requestRefresh()},Game_Screen.prototype.initialize=function(){this.clear()},Game_Screen.prototype.clear=function(){this.clearFade(),this.clearTone(),this.clearFlash(),this.clearShake(),this.clearZoom(),this.clearWeather(),this.clearPictures()},Game_Screen.prototype.onBattleStart=function(){this.clearFade(),this.clearFlash(),this.clearShake(),this.clearZoom(),this.eraseBattlePictures()},Game_Screen.prototype.brightness=function(){return this._brightness},Game_Screen.prototype.tone=function(){return this._tone},Game_Screen.prototype.flashColor=function(){return this._flashColor},Game_Screen.prototype.shake=function(){return this._shake},Game_Screen.prototype.zoomX=function(){return this._zoomX},Game_Screen.prototype.zoomY=function(){return this._zoomY},Game_Screen.prototype.zoomScale=function(){return this._zoomScale},Game_Screen.prototype.weatherType=function(){return this._weatherType},Game_Screen.prototype.weatherPower=function(){return this._weatherPower},Game_Screen.prototype.picture=function(t){var e=this.realPictureId(t);return this._pictures[e]},Game_Screen.prototype.realPictureId=function(t){return $gameParty.inBattle()?t+this.maxPictures():t},Game_Screen.prototype.clearFade=function(){this._brightness=255,this._fadeOutDuration=0,this._fadeInDuration=0},Game_Screen.prototype.clearTone=function(){this._tone=[0,0,0,0],this._toneTarget=[0,0,0,0],this._toneDuration=0},Game_Screen.prototype.clearFlash=function(){this._flashColor=[0,0,0,0],this._flashDuration=0},Game_Screen.prototype.clearShake=function(){this._shakePower=0,this._shakeSpeed=0,this._shakeDuration=0,this._shakeDirection=1,this._shake=0},Game_Screen.prototype.clearZoom=function(){this._zoomX=0,this._zoomY=0,this._zoomScale=1,this._zoomScaleTarget=1,this._zoomDuration=0},Game_Screen.prototype.clearWeather=function(){this._weatherType="none",this._weatherPower=0,this._weatherPowerTarget=0,this._weatherDuration=0},Game_Screen.prototype.clearPictures=function(){this._pictures=[]},Game_Screen.prototype.eraseBattlePictures=function(){this._pictures=this._pictures.slice(0,this.maxPictures()+1)},Game_Screen.prototype.maxPictures=function(){return 100},Game_Screen.prototype.startFadeOut=function(t){this._fadeOutDuration=t,this._fadeInDuration=0},Game_Screen.prototype.startFadeIn=function(t){this._fadeInDuration=t,this._fadeOutDuration=0},Game_Screen.prototype.startTint=function(t,e){this._toneTarget=t.clone(),this._toneDuration=e,0===this._toneDuration&&(this._tone=this._toneTarget.clone())},Game_Screen.prototype.startFlash=function(t,e){this._flashColor=t.clone(),this._flashDuration=e},Game_Screen.prototype.startShake=function(t,e,a){this._shakePower=t,this._shakeSpeed=e,this._shakeDuration=a},Game_Screen.prototype.startZoom=function(t,e,a,i){this._zoomX=t,this._zoomY=e,this._zoomScaleTarget=a,this._zoomDuration=i},Game_Screen.prototype.setZoom=function(t,e,a){this._zoomX=t,this._zoomY=e,this._zoomScale=a},Game_Screen.prototype.changeWeather=function(t,e,a){"none"===t&&0!==a||(this._weatherType=t),this._weatherPowerTarget="none"===t?0:e,this._weatherDuration=a,0===a&&(this._weatherPower=this._weatherPowerTarget)},Game_Screen.prototype.update=function(){this.updateFadeOut(),this.updateFadeIn(),this.updateTone(),this.updateFlash(),this.updateShake(),this.updateZoom(),this.updateWeather(),this.updatePictures()},Game_Screen.prototype.updateFadeOut=function(){if(this._fadeOutDuration>0){var t=this._fadeOutDuration;this._brightness=this._brightness*(t-1)/t,this._fadeOutDuration--}},Game_Screen.prototype.updateFadeIn=function(){if(this._fadeInDuration>0){var t=this._fadeInDuration;this._brightness=(this._brightness*(t-1)+255)/t,this._fadeInDuration--}},Game_Screen.prototype.updateTone=function(){if(this._toneDuration>0){for(var t=this._toneDuration,e=0;e<4;e++)this._tone[e]=(this._tone[e]*(t-1)+this._toneTarget[e])/t;this._toneDuration--}},Game_Screen.prototype.updateFlash=function(){if(this._flashDuration>0){var t=this._flashDuration;this._flashColor[3]*=(t-1)/t,this._flashDuration--}},Game_Screen.prototype.updateShake=function(){if(this._shakeDuration>0||0!==this._shake){var t=this._shakePower*this._shakeSpeed*this._shakeDirection/10;this._shakeDuration<=1&&this._shake*(this._shake+t)<0?this._shake=0:this._shake+=t,this._shake>2*this._shakePower&&(this._shakeDirection=-1),this._shake<2*-this._shakePower&&(this._shakeDirection=1),this._shakeDuration--}},Game_Screen.prototype.updateZoom=function(){if(this._zoomDuration>0){var t=this._zoomDuration,e=this._zoomScaleTarget;this._zoomScale=(this._zoomScale*(t-1)+e)/t,this._zoomDuration--}},Game_Screen.prototype.updateWeather=function(){if(this._weatherDuration>0){var t=this._weatherDuration,e=this._weatherPowerTarget;this._weatherPower=(this._weatherPower*(t-1)+e)/t,this._weatherDuration--,0===this._weatherDuration&&0===this._weatherPowerTarget&&(this._weatherType="none")}},Game_Screen.prototype.updatePictures=function(){this._pictures.forEach((function(t){t&&t.update()}))},Game_Screen.prototype.startFlashForDamage=function(){this.startFlash([255,0,0,128],8)},Game_Screen.prototype.showPicture=function(t,e,a,i,r,s,o,n,p){var h=this.realPictureId(t),c=new Game_Picture;c.show(e,a,i,r,s,o,n,p),this._pictures[h]=c},Game_Screen.prototype.movePicture=function(t,e,a,i,r,s,o,n,p){var h=this.picture(t);h&&h.move(e,a,i,r,s,o,n,p)},Game_Screen.prototype.rotatePicture=function(t,e){var a=this.picture(t);a&&a.rotate(e)},Game_Screen.prototype.tintPicture=function(t,e,a){var i=this.picture(t);i&&i.tint(e,a)},Game_Screen.prototype.erasePicture=function(t){var e=this.realPictureId(t);this._pictures[e]=null},Game_Picture.prototype.initialize=function(){this.initBasic(),this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.name=function(){return this._name},Game_Picture.prototype.origin=function(){return this._origin},Game_Picture.prototype.x=function(){return this._x},Game_Picture.prototype.y=function(){return this._y},Game_Picture.prototype.scaleX=function(){return this._scaleX},Game_Picture.prototype.scaleY=function(){return this._scaleY},Game_Picture.prototype.opacity=function(){return this._opacity},Game_Picture.prototype.blendMode=function(){return this._blendMode},Game_Picture.prototype.tone=function(){return this._tone},Game_Picture.prototype.angle=function(){return this._angle},Game_Picture.prototype.initBasic=function(){this._name="",this._origin=0,this._x=0,this._y=0,this._scaleX=100,this._scaleY=100,this._opacity=255,this._blendMode=0},Game_Picture.prototype.initTarget=function(){this._targetX=this._x,this._targetY=this._y,this._targetScaleX=this._scaleX,this._targetScaleY=this._scaleY,this._targetOpacity=this._opacity,this._duration=0},Game_Picture.prototype.initTone=function(){this._tone=null,this._toneTarget=null,this._toneDuration=0},Game_Picture.prototype.initRotation=function(){this._angle=0,this._rotationSpeed=0},Game_Picture.prototype.show=function(t,e,a,i,r,s,o,n){this._name=t,this._origin=e,this._x=a,this._y=i,this._scaleX=r,this._scaleY=s,this._opacity=o,this._blendMode=n,this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.move=function(t,e,a,i,r,s,o,n){this._origin=t,this._targetX=e,this._targetY=a,this._targetScaleX=i,this._targetScaleY=r,this._targetOpacity=s,this._blendMode=o,this._duration=n},Game_Picture.prototype.rotate=function(t){this._rotationSpeed=t},Game_Picture.prototype.tint=function(t,e){this._tone||(this._tone=[0,0,0,0]),this._toneTarget=t.clone(),this._toneDuration=e,0===this._toneDuration&&(this._tone=this._toneTarget.clone())},Game_Picture.prototype.erase=function(){this._name="",this._origin=0,this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.update=function(){this.updateMove(),this.updateTone(),this.updateRotation()},Game_Picture.prototype.updateMove=function(){if(this._duration>0){var t=this._duration;this._x=(this._x*(t-1)+this._targetX)/t,this._y=(this._y*(t-1)+this._targetY)/t,this._scaleX=(this._scaleX*(t-1)+this._targetScaleX)/t,this._scaleY=(this._scaleY*(t-1)+this._targetScaleY)/t,this._opacity=(this._opacity*(t-1)+this._targetOpacity)/t,this._duration--}},Game_Picture.prototype.updateTone=function(){if(this._toneDuration>0){for(var t=this._toneDuration,e=0;e<4;e++)this._tone[e]=(this._tone[e]*(t-1)+this._toneTarget[e])/t;this._toneDuration--}},Game_Picture.prototype.updateRotation=function(){this._rotationSpeed>0&&(this._angle+=this._rotationSpeed/2)},Game_Item.prototype.initialize=function(t){this._dataClass="",this._itemId=0,t&&this.setObject(t)},Game_Item.prototype.isSkill=function(){return"skill"===this._dataClass},Game_Item.prototype.isItem=function(){return"item"===this._dataClass},Game_Item.prototype.isUsableItem=function(){return this.isSkill()||this.isItem()},Game_Item.prototype.isWeapon=function(){return"weapon"===this._dataClass},Game_Item.prototype.isArmor=function(){return"armor"===this._dataClass},Game_Item.prototype.isEquipItem=function(){return this.isWeapon()||this.isArmor()},Game_Item.prototype.isNull=function(){return""===this._dataClass},Game_Item.prototype.itemId=function(){return this._itemId},Game_Item.prototype.object=function(){return this.isSkill()?$dataSkills[this._itemId]:this.isItem()?$dataItems[this._itemId]:this.isWeapon()?$dataWeapons[this._itemId]:this.isArmor()?$dataArmors[this._itemId]:null},Game_Item.prototype.setObject=function(t){DataManager.isSkill(t)?this._dataClass="skill":DataManager.isItem(t)?this._dataClass="item":DataManager.isWeapon(t)?this._dataClass="weapon":DataManager.isArmor(t)?this._dataClass="armor":this._dataClass="",this._itemId=t?t.id:0},Game_Item.prototype.setEquip=function(t,e){this._dataClass=t?"weapon":"armor",this._itemId=e},Game_Action.EFFECT_RECOVER_HP=11,Game_Action.EFFECT_RECOVER_MP=12,Game_Action.EFFECT_GAIN_TP=13,Game_Action.EFFECT_ADD_STATE=21,Game_Action.EFFECT_REMOVE_STATE=22,Game_Action.EFFECT_ADD_BUFF=31,Game_Action.EFFECT_ADD_DEBUFF=32,Game_Action.EFFECT_REMOVE_BUFF=33,Game_Action.EFFECT_REMOVE_DEBUFF=34,Game_Action.EFFECT_SPECIAL=41,Game_Action.EFFECT_GROW=42,Game_Action.EFFECT_LEARN_SKILL=43,Game_Action.EFFECT_COMMON_EVENT=44,Game_Action.SPECIAL_EFFECT_ESCAPE=0,Game_Action.HITTYPE_CERTAIN=0,Game_Action.HITTYPE_PHYSICAL=1,Game_Action.HITTYPE_MAGICAL=2,Game_Action.prototype.initialize=function(t,e){this._subjectActorId=0,this._subjectEnemyIndex=-1,this._forcing=e||!1,this.setSubject(t),this.clear()},Game_Action.prototype.clear=function(){this._item=new Game_Item,this._targetIndex=-1},Game_Action.prototype.setSubject=function(t){t.isActor()?(this._subjectActorId=t.actorId(),this._subjectEnemyIndex=-1):(this._subjectEnemyIndex=t.index(),this._subjectActorId=0)},Game_Action.prototype.subject=function(){return this._subjectActorId>0?$gameActors.actor(this._subjectActorId):$gameTroop.members()[this._subjectEnemyIndex]},Game_Action.prototype.friendsUnit=function(){return this.subject().friendsUnit()},Game_Action.prototype.opponentsUnit=function(){return this.subject().opponentsUnit()},Game_Action.prototype.setEnemyAction=function(t){t?this.setSkill(t.skillId):this.clear()},Game_Action.prototype.setAttack=function(){this.setSkill(this.subject().attackSkillId())},Game_Action.prototype.setGuard=function(){this.setSkill(this.subject().guardSkillId())},Game_Action.prototype.setSkill=function(t){this._item.setObject($dataSkills[t])},Game_Action.prototype.setItem=function(t){this._item.setObject($dataItems[t])},Game_Action.prototype.setItemObject=function(t){this._item.setObject(t)},Game_Action.prototype.setTarget=function(t){this._targetIndex=t},Game_Action.prototype.item=function(){return this._item.object()},Game_Action.prototype.isSkill=function(){return this._item.isSkill()},Game_Action.prototype.isItem=function(){return this._item.isItem()},Game_Action.prototype.numRepeats=function(){var t=this.item().repeats;return this.isAttack()&&(t+=this.subject().attackTimesAdd()),Math.floor(t)},Game_Action.prototype.checkItemScope=function(t){return t.contains(this.item().scope)},Game_Action.prototype.isForOpponent=function(){return this.checkItemScope([1,2,3,4,5,6])},Game_Action.prototype.isForFriend=function(){return this.checkItemScope([7,8,9,10,11])},Game_Action.prototype.isForDeadFriend=function(){return this.checkItemScope([9,10])},Game_Action.prototype.isForUser=function(){return this.checkItemScope([11])},Game_Action.prototype.isForOne=function(){return this.checkItemScope([1,3,7,9,11])},Game_Action.prototype.isForRandom=function(){return this.checkItemScope([3,4,5,6])},Game_Action.prototype.isForAll=function(){return this.checkItemScope([2,8,10])},Game_Action.prototype.needsSelection=function(){return this.checkItemScope([1,7,9])},Game_Action.prototype.numTargets=function(){return this.isForRandom()?this.item().scope-2:0},Game_Action.prototype.checkDamageType=function(t){return t.contains(this.item().damage.type)},Game_Action.prototype.isHpEffect=function(){return this.checkDamageType([1,3,5])},Game_Action.prototype.isMpEffect=function(){return this.checkDamageType([2,4,6])},Game_Action.prototype.isDamage=function(){return this.checkDamageType([1,2])},Game_Action.prototype.isRecover=function(){return this.checkDamageType([3,4])},Game_Action.prototype.isDrain=function(){return this.checkDamageType([5,6])},Game_Action.prototype.isHpRecover=function(){return this.checkDamageType([3])},Game_Action.prototype.isMpRecover=function(){return this.checkDamageType([4])},Game_Action.prototype.isCertainHit=function(){return this.item().hitType===Game_Action.HITTYPE_CERTAIN},Game_Action.prototype.isPhysical=function(){return this.item().hitType===Game_Action.HITTYPE_PHYSICAL},Game_Action.prototype.isMagical=function(){return this.item().hitType===Game_Action.HITTYPE_MAGICAL},Game_Action.prototype.isAttack=function(){return this.item()===$dataSkills[this.subject().attackSkillId()]},Game_Action.prototype.isGuard=function(){return this.item()===$dataSkills[this.subject().guardSkillId()]},Game_Action.prototype.isMagicSkill=function(){return!!this.isSkill()&&$dataSystem.magicSkills.contains(this.item().stypeId)},Game_Action.prototype.decideRandomTarget=function(){var t;(t=this.isForDeadFriend()?this.friendsUnit().randomDeadTarget():this.isForFriend()?this.friendsUnit().randomTarget():this.opponentsUnit().randomTarget())?this._targetIndex=t.index:this.clear()},Game_Action.prototype.setConfusion=function(){this.setAttack()},Game_Action.prototype.prepare=function(){this.subject().isConfused()&&!this._forcing&&this.setConfusion()},Game_Action.prototype.isValid=function(){return this._forcing&&this.item()||this.subject().canUse(this.item())},Game_Action.prototype.speed=function(){var t=this.subject().agi,e=t+Math.randomInt(Math.floor(5+t/4));return this.item()&&(e+=this.item().speed),this.isAttack()&&(e+=this.subject().attackSpeed()),e},Game_Action.prototype.makeTargets=function(){var t=[];return!this._forcing&&this.subject().isConfused()?t=[this.confusionTarget()]:this.isForOpponent()?t=this.targetsForOpponents():this.isForFriend()&&(t=this.targetsForFriends()),this.repeatTargets(t)},Game_Action.prototype.repeatTargets=function(t){for(var e=[],a=this.numRepeats(),i=0;i<t.length;i++){var r=t[i];if(r)for(var s=0;s<a;s++)e.push(r)}return e},Game_Action.prototype.confusionTarget=function(){switch(this.subject().confusionLevel()){case 1:return this.opponentsUnit().randomTarget();case 2:return 0===Math.randomInt(2)?this.opponentsUnit().randomTarget():this.friendsUnit().randomTarget();default:return this.friendsUnit().randomTarget()}},Game_Action.prototype.targetsForOpponents=function(){var t=[],e=this.opponentsUnit();if(this.isForRandom())for(var a=0;a<this.numTargets();a++)t.push(e.randomTarget());else this.isForOne()?this._targetIndex<0?t.push(e.randomTarget()):t.push(e.smoothTarget(this._targetIndex)):t=e.aliveMembers();return t},Game_Action.prototype.targetsForFriends=function(){var t=[],e=this.friendsUnit();return this.isForUser()?[this.subject()]:(this.isForDeadFriend()?this.isForOne()?t.push(e.smoothDeadTarget(this._targetIndex)):t=e.deadMembers():this.isForOne()?this._targetIndex<0?t.push(e.randomTarget()):t.push(e.smoothTarget(this._targetIndex)):t=e.aliveMembers(),t)},Game_Action.prototype.evaluate=function(){var t=0;return this.itemTargetCandidates().forEach((function(e){var a=this.evaluateWithTarget(e);this.isForAll()?t+=a:a>t&&(t=a,this._targetIndex=e.index)}),this),(t*=this.numRepeats())>0&&(t+=Math.random()),t},Game_Action.prototype.itemTargetCandidates=function(){return this.isValid()?this.isForOpponent()?this.opponentsUnit().aliveMembers():this.isForUser()?[this.subject()]:this.isForDeadFriend()?this.friendsUnit().deadMembers():this.friendsUnit().aliveMembers():[]},Game_Action.prototype.evaluateWithTarget=function(t){if(this.isHpEffect()){var e=this.makeDamageValue(t,!1);return this.isForOpponent()?e/Math.max(t.hp,1):Math.min(-e,t.mhp-t.hp)/t.mhp}},Game_Action.prototype.testApply=function(t){return this.isForDeadFriend()===t.isDead()&&($gameParty.inBattle()||this.isForOpponent()||this.isHpRecover()&&t.hp<t.mhp||this.isMpRecover()&&t.mp<t.mmp||this.hasItemAnyValidEffects(t))},Game_Action.prototype.hasItemAnyValidEffects=function(t){return this.item().effects.some((function(e){return this.testItemEffect(t,e)}),this)},Game_Action.prototype.testItemEffect=function(t,e){switch(e.code){case Game_Action.EFFECT_RECOVER_HP:return t.hp<t.mhp||e.value1<0||e.value2<0;case Game_Action.EFFECT_RECOVER_MP:return t.mp<t.mmp||e.value1<0||e.value2<0;case Game_Action.EFFECT_ADD_STATE:return!t.isStateAffected(e.dataId);case Game_Action.EFFECT_REMOVE_STATE:return t.isStateAffected(e.dataId);case Game_Action.EFFECT_ADD_BUFF:return!t.isMaxBuffAffected(e.dataId);case Game_Action.EFFECT_ADD_DEBUFF:return!t.isMaxDebuffAffected(e.dataId);case Game_Action.EFFECT_REMOVE_BUFF:return t.isBuffAffected(e.dataId);case Game_Action.EFFECT_REMOVE_DEBUFF:return t.isDebuffAffected(e.dataId);case Game_Action.EFFECT_LEARN_SKILL:return t.isActor()&&!t.isLearnedSkill(e.dataId);default:return!0}},Game_Action.prototype.itemCnt=function(t){return this.isPhysical()&&t.canMove()?t.cnt:0},Game_Action.prototype.itemMrf=function(t){return this.isMagical()?t.mrf:0},Game_Action.prototype.itemHit=function(t){return this.isPhysical()?.01*this.item().successRate*this.subject().hit:.01*this.item().successRate},Game_Action.prototype.itemEva=function(t){return this.isPhysical()?t.eva:this.isMagical()?t.mev:0},Game_Action.prototype.itemCri=function(t){return this.item().damage.critical?this.subject().cri*(1-t.cev):0},Game_Action.prototype.apply=function(t){var e=t.result();if(this.subject().clearResult(),e.clear(),e.used=this.testApply(t),e.missed=e.used&&Math.random()>=this.itemHit(t),e.evaded=!e.missed&&Math.random()<this.itemEva(t),e.physical=this.isPhysical(),e.drain=this.isDrain(),e.isHit()){if(this.item().damage.type>0){e.critical=Math.random()<this.itemCri(t);var a=this.makeDamageValue(t,e.critical);this.executeDamage(t,a)}this.item().effects.forEach((function(e){this.applyItemEffect(t,e)}),this),this.applyItemUserEffect(t)}},Game_Action.prototype.makeDamageValue=function(t,e){var a=this.item(),i=this.evalDamageFormula(t),r=i*this.calcElementRate(t);return this.isPhysical()&&(r*=t.pdr),this.isMagical()&&(r*=t.mdr),i<0&&(r*=t.rec),e&&(r=this.applyCritical(r)),r=this.applyVariance(r,a.damage.variance),r=this.applyGuard(r,t),r=Math.round(r)},Game_Action.prototype.evalDamageFormula=function(target){try{var item=this.item(),a=this.subject(),b=target,v=$gameVariables._data,sign=[3,4].contains(item.damage.type)?-1:1;return Math.max(eval(item.damage.formula),0)*sign}catch(t){return 0}},Game_Action.prototype.calcElementRate=function(t){return this.item().damage.elementId<0?this.elementsMaxRate(t,this.subject().attackElements()):t.elementRate(this.item().damage.elementId)},Game_Action.prototype.elementsMaxRate=function(t,e){return e.length>0?Math.max.apply(null,e.map((function(e){return t.elementRate(e)}),this)):1},Game_Action.prototype.applyCritical=function(t){return 3*t},Game_Action.prototype.applyVariance=function(t,e){var a=Math.floor(Math.max(Math.abs(t)*e/100,0)),i=Math.randomInt(a+1)+Math.randomInt(a+1)-a;return t>=0?t+i:t-i},Game_Action.prototype.applyGuard=function(t,e){return t/(t>0&&e.isGuard()?2*e.grd:1)},Game_Action.prototype.executeDamage=function(t,e){var a=t.result();0===e&&(a.critical=!1),this.isHpEffect()&&this.executeHpDamage(t,e),this.isMpEffect()&&this.executeMpDamage(t,e)},Game_Action.prototype.executeHpDamage=function(t,e){this.isDrain()&&(e=Math.min(t.hp,e)),this.makeSuccess(t),t.gainHp(-e),e>0&&t.onDamage(e),this.gainDrainedHp(e)},Game_Action.prototype.executeMpDamage=function(t,e){this.isMpRecover()||(e=Math.min(t.mp,e)),0!==e&&this.makeSuccess(t),t.gainMp(-e),this.gainDrainedMp(e)},Game_Action.prototype.gainDrainedHp=function(t){this.isDrain()&&this.subject().gainHp(t)},Game_Action.prototype.gainDrainedMp=function(t){this.isDrain()&&this.subject().gainMp(t)},Game_Action.prototype.applyItemEffect=function(t,e){switch(e.code){case Game_Action.EFFECT_RECOVER_HP:this.itemEffectRecoverHp(t,e);break;case Game_Action.EFFECT_RECOVER_MP:this.itemEffectRecoverMp(t,e);break;case Game_Action.EFFECT_GAIN_TP:this.itemEffectGainTp(t,e);break;case Game_Action.EFFECT_ADD_STATE:this.itemEffectAddState(t,e);break;case Game_Action.EFFECT_REMOVE_STATE:this.itemEffectRemoveState(t,e);break;case Game_Action.EFFECT_ADD_BUFF:this.itemEffectAddBuff(t,e);break;case Game_Action.EFFECT_ADD_DEBUFF:this.itemEffectAddDebuff(t,e);break;case Game_Action.EFFECT_REMOVE_BUFF:this.itemEffectRemoveBuff(t,e);break;case Game_Action.EFFECT_REMOVE_DEBUFF:this.itemEffectRemoveDebuff(t,e);break;case Game_Action.EFFECT_SPECIAL:this.itemEffectSpecial(t,e);break;case Game_Action.EFFECT_GROW:this.itemEffectGrow(t,e);break;case Game_Action.EFFECT_LEARN_SKILL:this.itemEffectLearnSkill(t,e);break;case Game_Action.EFFECT_COMMON_EVENT:this.itemEffectCommonEvent(t,e)}},Game_Action.prototype.itemEffectRecoverHp=function(t,e){var a=(t.mhp*e.value1+e.value2)*t.rec;this.isItem()&&(a*=this.subject().pha),0!==(a=Math.floor(a))&&(t.gainHp(a),this.makeSuccess(t))},Game_Action.prototype.itemEffectRecoverMp=function(t,e){var a=(t.mmp*e.value1+e.value2)*t.rec;this.isItem()&&(a*=this.subject().pha),0!==(a=Math.floor(a))&&(t.gainMp(a),this.makeSuccess(t))},Game_Action.prototype.itemEffectGainTp=function(t,e){var a=Math.floor(e.value1);0!==a&&(t.gainTp(a),this.makeSuccess(t))},Game_Action.prototype.itemEffectAddState=function(t,e){0===e.dataId?this.itemEffectAddAttackState(t,e):this.itemEffectAddNormalState(t,e)},Game_Action.prototype.itemEffectAddAttackState=function(t,e){this.subject().attackStates().forEach(function(a){var i=e.value1;i*=t.stateRate(a),i*=this.subject().attackStatesRate(a),i*=this.lukEffectRate(t),Math.random()<i&&(t.addState(a),this.makeSuccess(t))}.bind(this),t)},Game_Action.prototype.itemEffectAddNormalState=function(t,e){var a=e.value1;this.isCertainHit()||(a*=t.stateRate(e.dataId),a*=this.lukEffectRate(t)),Math.random()<a&&(t.addState(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectRemoveState=function(t,e){var a=e.value1;Math.random()<a&&(t.removeState(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectAddBuff=function(t,e){t.addBuff(e.dataId,e.value1),this.makeSuccess(t)},Game_Action.prototype.itemEffectAddDebuff=function(t,e){var a=t.debuffRate(e.dataId)*this.lukEffectRate(t);Math.random()<a&&(t.addDebuff(e.dataId,e.value1),this.makeSuccess(t))},Game_Action.prototype.itemEffectRemoveBuff=function(t,e){t.isBuffAffected(e.dataId)&&(t.removeBuff(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectRemoveDebuff=function(t,e){t.isDebuffAffected(e.dataId)&&(t.removeBuff(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectSpecial=function(t,e){e.dataId===Game_Action.SPECIAL_EFFECT_ESCAPE&&(t.escape(),this.makeSuccess(t))},Game_Action.prototype.itemEffectGrow=function(t,e){t.addParam(e.dataId,Math.floor(e.value1)),this.makeSuccess(t)},Game_Action.prototype.itemEffectLearnSkill=function(t,e){t.isActor()&&(t.learnSkill(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectCommonEvent=function(t,e){},Game_Action.prototype.makeSuccess=function(t){t.result().success=!0},Game_Action.prototype.applyItemUserEffect=function(t){var e=Math.floor(this.item().tpGain*this.subject().tcr);this.subject().gainSilentTp(e)},Game_Action.prototype.lukEffectRate=function(t){return Math.max(1+.001*(this.subject().luk-t.luk),0)},Game_Action.prototype.applyGlobal=function(){this.item().effects.forEach((function(t){t.code===Game_Action.EFFECT_COMMON_EVENT&&$gameTemp.reserveCommonEvent(t.dataId)}),this)},Game_ActionResult.prototype.initialize=function(){this.clear()},Game_ActionResult.prototype.clear=function(){this.used=!1,this.missed=!1,this.evaded=!1,this.physical=!1,this.drain=!1,this.critical=!1,this.success=!1,this.hpAffected=!1,this.hpDamage=0,this.mpDamage=0,this.tpDamage=0,this.addedStates=[],this.removedStates=[],this.addedBuffs=[],this.addedDebuffs=[],this.removedBuffs=[]},Game_ActionResult.prototype.addedStateObjects=function(){return this.addedStates.map((function(t){return $dataStates[t]}))},Game_ActionResult.prototype.removedStateObjects=function(){return this.removedStates.map((function(t){return $dataStates[t]}))},Game_ActionResult.prototype.isStatusAffected=function(){return this.addedStates.length>0||this.removedStates.length>0||this.addedBuffs.length>0||this.addedDebuffs.length>0||this.removedBuffs.length>0},Game_ActionResult.prototype.isHit=function(){return this.used&&!this.missed&&!this.evaded},Game_ActionResult.prototype.isStateAdded=function(t){return this.addedStates.contains(t)},Game_ActionResult.prototype.pushAddedState=function(t){this.isStateAdded(t)||this.addedStates.push(t)},Game_ActionResult.prototype.isStateRemoved=function(t){return this.removedStates.contains(t)},Game_ActionResult.prototype.pushRemovedState=function(t){this.isStateRemoved(t)||this.removedStates.push(t)},Game_ActionResult.prototype.isBuffAdded=function(t){return this.addedBuffs.contains(t)},Game_ActionResult.prototype.pushAddedBuff=function(t){this.isBuffAdded(t)||this.addedBuffs.push(t)},Game_ActionResult.prototype.isDebuffAdded=function(t){return this.addedDebuffs.contains(t)},Game_ActionResult.prototype.pushAddedDebuff=function(t){this.isDebuffAdded(t)||this.addedDebuffs.push(t)},Game_ActionResult.prototype.isBuffRemoved=function(t){return this.removedBuffs.contains(t)},Game_ActionResult.prototype.pushRemovedBuff=function(t){this.isBuffRemoved(t)||this.removedBuffs.push(t)},Game_BattlerBase.TRAIT_ELEMENT_RATE=11,Game_BattlerBase.TRAIT_DEBUFF_RATE=12,Game_BattlerBase.TRAIT_STATE_RATE=13,Game_BattlerBase.TRAIT_STATE_RESIST=14,Game_BattlerBase.TRAIT_PARAM=21,Game_BattlerBase.TRAIT_XPARAM=22,Game_BattlerBase.TRAIT_SPARAM=23,Game_BattlerBase.TRAIT_ATTACK_ELEMENT=31,Game_BattlerBase.TRAIT_ATTACK_STATE=32,Game_BattlerBase.TRAIT_ATTACK_SPEED=33,Game_BattlerBase.TRAIT_ATTACK_TIMES=34,Game_BattlerBase.TRAIT_STYPE_ADD=41,Game_BattlerBase.TRAIT_STYPE_SEAL=42,Game_BattlerBase.TRAIT_SKILL_ADD=43,Game_BattlerBase.TRAIT_SKILL_SEAL=44,Game_BattlerBase.TRAIT_EQUIP_WTYPE=51,Game_BattlerBase.TRAIT_EQUIP_ATYPE=52,Game_BattlerBase.TRAIT_EQUIP_LOCK=53,Game_BattlerBase.TRAIT_EQUIP_SEAL=54,Game_BattlerBase.TRAIT_SLOT_TYPE=55,Game_BattlerBase.TRAIT_ACTION_PLUS=61,Game_BattlerBase.TRAIT_SPECIAL_FLAG=62,Game_BattlerBase.TRAIT_COLLAPSE_TYPE=63,Game_BattlerBase.TRAIT_PARTY_ABILITY=64,Game_BattlerBase.FLAG_ID_AUTO_BATTLE=0,Game_BattlerBase.FLAG_ID_GUARD=1,Game_BattlerBase.FLAG_ID_SUBSTITUTE=2,Game_BattlerBase.FLAG_ID_PRESERVE_TP=3,Game_BattlerBase.ICON_BUFF_START=32,Game_BattlerBase.ICON_DEBUFF_START=48,Object.defineProperties(Game_BattlerBase.prototype,{hp:{get:function(){return this._hp},configurable:!0},mp:{get:function(){return this._mp},configurable:!0},tp:{get:function(){return this._tp},configurable:!0},mhp:{get:function(){return this.param(0)},configurable:!0},mmp:{get:function(){return this.param(1)},configurable:!0},atk:{get:function(){return this.param(2)},configurable:!0},def:{get:function(){return this.param(3)},configurable:!0},mat:{get:function(){return this.param(4)},configurable:!0},mdf:{get:function(){return this.param(5)},configurable:!0},agi:{get:function(){return this.param(6)},configurable:!0},luk:{get:function(){return this.param(7)},configurable:!0},hit:{get:function(){return this.xparam(0)},configurable:!0},eva:{get:function(){return this.xparam(1)},configurable:!0},cri:{get:function(){return this.xparam(2)},configurable:!0},cev:{get:function(){return this.xparam(3)},configurable:!0},mev:{get:function(){return this.xparam(4)},configurable:!0},mrf:{get:function(){return this.xparam(5)},configurable:!0},cnt:{get:function(){return this.xparam(6)},configurable:!0},hrg:{get:function(){return this.xparam(7)},configurable:!0},mrg:{get:function(){return this.xparam(8)},configurable:!0},trg:{get:function(){return this.xparam(9)},configurable:!0},tgr:{get:function(){return this.sparam(0)},configurable:!0},grd:{get:function(){return this.sparam(1)},configurable:!0},rec:{get:function(){return this.sparam(2)},configurable:!0},pha:{get:function(){return this.sparam(3)},configurable:!0},mcr:{get:function(){return this.sparam(4)},configurable:!0},tcr:{get:function(){return this.sparam(5)},configurable:!0},pdr:{get:function(){return this.sparam(6)},configurable:!0},mdr:{get:function(){return this.sparam(7)},configurable:!0},fdr:{get:function(){return this.sparam(8)},configurable:!0},exr:{get:function(){return this.sparam(9)},configurable:!0}}),Game_BattlerBase.prototype.initialize=function(){this.initMembers()},Game_BattlerBase.prototype.initMembers=function(){this._hp=1,this._mp=0,this._tp=0,this._hidden=!1,this.clearParamPlus(),this.clearStates(),this.clearBuffs()},Game_BattlerBase.prototype.clearParamPlus=function(){this._paramPlus=[0,0,0,0,0,0,0,0]},Game_BattlerBase.prototype.clearStates=function(){this._states=[],this._stateTurns={}},Game_BattlerBase.prototype.eraseState=function(t){var e=this._states.indexOf(t);e>=0&&this._states.splice(e,1),delete this._stateTurns[t]},Game_BattlerBase.prototype.isStateAffected=function(t){return this._states.contains(t)},Game_BattlerBase.prototype.isDeathStateAffected=function(){return this.isStateAffected(this.deathStateId())},Game_BattlerBase.prototype.deathStateId=function(){return 1},Game_BattlerBase.prototype.resetStateCounts=function(t){var e=$dataStates[t],a=1+Math.max(e.maxTurns-e.minTurns,0);this._stateTurns[t]=e.minTurns+Math.randomInt(a)},Game_BattlerBase.prototype.isStateExpired=function(t){return 0===this._stateTurns[t]},Game_BattlerBase.prototype.updateStateTurns=function(){this._states.forEach((function(t){this._stateTurns[t]>0&&this._stateTurns[t]--}),this)},Game_BattlerBase.prototype.clearBuffs=function(){this._buffs=[0,0,0,0,0,0,0,0],this._buffTurns=[0,0,0,0,0,0,0,0]},Game_BattlerBase.prototype.eraseBuff=function(t){this._buffs[t]=0,this._buffTurns[t]=0},Game_BattlerBase.prototype.buffLength=function(){return this._buffs.length},Game_BattlerBase.prototype.buff=function(t){return this._buffs[t]},Game_BattlerBase.prototype.isBuffAffected=function(t){return this._buffs[t]>0},Game_BattlerBase.prototype.isDebuffAffected=function(t){return this._buffs[t]<0},Game_BattlerBase.prototype.isBuffOrDebuffAffected=function(t){return 0!==this._buffs[t]},Game_BattlerBase.prototype.isMaxBuffAffected=function(t){return 2===this._buffs[t]},Game_BattlerBase.prototype.isMaxDebuffAffected=function(t){return-2===this._buffs[t]},Game_BattlerBase.prototype.increaseBuff=function(t){this.isMaxBuffAffected(t)||this._buffs[t]++},Game_BattlerBase.prototype.decreaseBuff=function(t){this.isMaxDebuffAffected(t)||this._buffs[t]--},Game_BattlerBase.prototype.overwriteBuffTurns=function(t,e){this._buffTurns[t]<e&&(this._buffTurns[t]=e)},Game_BattlerBase.prototype.isBuffExpired=function(t){return 0===this._buffTurns[t]},Game_BattlerBase.prototype.updateBuffTurns=function(){for(var t=0;t<this._buffTurns.length;t++)this._buffTurns[t]>0&&this._buffTurns[t]--},Game_BattlerBase.prototype.die=function(){this._hp=0,this.clearStates(),this.clearBuffs()},Game_BattlerBase.prototype.revive=function(){0===this._hp&&(this._hp=1)},Game_BattlerBase.prototype.states=function(){return this._states.map((function(t){return $dataStates[t]}))},Game_BattlerBase.prototype.stateIcons=function(){return this.states().map((function(t){return t.iconIndex})).filter((function(t){return t>0}))},Game_BattlerBase.prototype.buffIcons=function(){for(var t=[],e=0;e<this._buffs.length;e++)0!==this._buffs[e]&&t.push(this.buffIconIndex(this._buffs[e],e));return t},Game_BattlerBase.prototype.buffIconIndex=function(t,e){return t>0?Game_BattlerBase.ICON_BUFF_START+8*(t-1)+e:t<0?Game_BattlerBase.ICON_DEBUFF_START+8*(-t-1)+e:0},Game_BattlerBase.prototype.allIcons=function(){return this.stateIcons().concat(this.buffIcons())},Game_BattlerBase.prototype.traitObjects=function(){return this.states()},Game_BattlerBase.prototype.allTraits=function(){return this.traitObjects().reduce((function(t,e){return t.concat(e.traits)}),[])},Game_BattlerBase.prototype.traits=function(t){return this.allTraits().filter((function(e){return e.code===t}))},Game_BattlerBase.prototype.traitsWithId=function(t,e){return this.allTraits().filter((function(a){return a.code===t&&a.dataId===e}))},Game_BattlerBase.prototype.traitsPi=function(t,e){return this.traitsWithId(t,e).reduce((function(t,e){return t*e.value}),1)},Game_BattlerBase.prototype.traitsSum=function(t,e){return this.traitsWithId(t,e).reduce((function(t,e){return t+e.value}),0)},Game_BattlerBase.prototype.traitsSumAll=function(t){return this.traits(t).reduce((function(t,e){return t+e.value}),0)},Game_BattlerBase.prototype.traitsSet=function(t){return this.traits(t).reduce((function(t,e){return t.concat(e.dataId)}),[])},Game_BattlerBase.prototype.paramBase=function(t){return 0},Game_BattlerBase.prototype.paramPlus=function(t){return this._paramPlus[t]},Game_BattlerBase.prototype.paramMin=function(t){return 1===t?0:1},Game_BattlerBase.prototype.paramMax=function(t){return 0===t?999999:1===t?9999:999},Game_BattlerBase.prototype.paramRate=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_PARAM,t)},Game_BattlerBase.prototype.paramBuffRate=function(t){return.25*this._buffs[t]+1},Game_BattlerBase.prototype.param=function(t){var e=this.paramBase(t)+this.paramPlus(t);e*=this.paramRate(t)*this.paramBuffRate(t);var a=this.paramMax(t),i=this.paramMin(t);return Math.round(e.clamp(i,a))},Game_BattlerBase.prototype.xparam=function(t){return this.traitsSum(Game_BattlerBase.TRAIT_XPARAM,t)},Game_BattlerBase.prototype.sparam=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_SPARAM,t)},Game_BattlerBase.prototype.elementRate=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_ELEMENT_RATE,t)},Game_BattlerBase.prototype.debuffRate=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_DEBUFF_RATE,t)},Game_BattlerBase.prototype.stateRate=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_STATE_RATE,t)},Game_BattlerBase.prototype.stateResistSet=function(){return this.traitsSet(Game_BattlerBase.TRAIT_STATE_RESIST)},Game_BattlerBase.prototype.isStateResist=function(t){return this.stateResistSet().contains(t)},Game_BattlerBase.prototype.attackElements=function(){return this.traitsSet(Game_BattlerBase.TRAIT_ATTACK_ELEMENT)},Game_BattlerBase.prototype.attackStates=function(){return this.traitsSet(Game_BattlerBase.TRAIT_ATTACK_STATE)},Game_BattlerBase.prototype.attackStatesRate=function(t){return this.traitsSum(Game_BattlerBase.TRAIT_ATTACK_STATE,t)},Game_BattlerBase.prototype.attackSpeed=function(){return this.traitsSumAll(Game_BattlerBase.TRAIT_ATTACK_SPEED)},Game_BattlerBase.prototype.attackTimesAdd=function(){return Math.max(this.traitsSumAll(Game_BattlerBase.TRAIT_ATTACK_TIMES),0)},Game_BattlerBase.prototype.addedSkillTypes=function(){return this.traitsSet(Game_BattlerBase.TRAIT_STYPE_ADD)},Game_BattlerBase.prototype.isSkillTypeSealed=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_STYPE_SEAL).contains(t)},Game_BattlerBase.prototype.addedSkills=function(){return this.traitsSet(Game_BattlerBase.TRAIT_SKILL_ADD)},Game_BattlerBase.prototype.isSkillSealed=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_SKILL_SEAL).contains(t)},Game_BattlerBase.prototype.isEquipWtypeOk=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_WTYPE).contains(t)},Game_BattlerBase.prototype.isEquipAtypeOk=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_ATYPE).contains(t)},Game_BattlerBase.prototype.isEquipTypeLocked=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_LOCK).contains(t)},Game_BattlerBase.prototype.isEquipTypeSealed=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_SEAL).contains(t)},Game_BattlerBase.prototype.slotType=function(){var t=this.traitsSet(Game_BattlerBase.TRAIT_SLOT_TYPE);return t.length>0?Math.max.apply(null,t):0},Game_BattlerBase.prototype.isDualWield=function(){return 1===this.slotType()},Game_BattlerBase.prototype.actionPlusSet=function(){return this.traits(Game_BattlerBase.TRAIT_ACTION_PLUS).map((function(t){return t.value}))},Game_BattlerBase.prototype.specialFlag=function(t){return this.traits(Game_BattlerBase.TRAIT_SPECIAL_FLAG).some((function(e){return e.dataId===t}))},Game_BattlerBase.prototype.collapseType=function(){var t=this.traitsSet(Game_BattlerBase.TRAIT_COLLAPSE_TYPE);return t.length>0?Math.max.apply(null,t):0},Game_BattlerBase.prototype.partyAbility=function(t){return this.traits(Game_BattlerBase.TRAIT_PARTY_ABILITY).some((function(e){return e.dataId===t}))},Game_BattlerBase.prototype.isAutoBattle=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_AUTO_BATTLE)},Game_BattlerBase.prototype.isGuard=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_GUARD)&&this.canMove()},Game_BattlerBase.prototype.isSubstitute=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_SUBSTITUTE)&&this.canMove()},Game_BattlerBase.prototype.isPreserveTp=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_PRESERVE_TP)},Game_BattlerBase.prototype.addParam=function(t,e){this._paramPlus[t]+=e,this.refresh()},Game_BattlerBase.prototype.setHp=function(t){this._hp=t,this.refresh()},Game_BattlerBase.prototype.setMp=function(t){this._mp=t,this.refresh()},Game_BattlerBase.prototype.setTp=function(t){this._tp=t,this.refresh()},Game_BattlerBase.prototype.maxTp=function(){return 100},Game_BattlerBase.prototype.refresh=function(){this.stateResistSet().forEach((function(t){this.eraseState(t)}),this),this._hp=this._hp.clamp(0,this.mhp),this._mp=this._mp.clamp(0,this.mmp),this._tp=this._tp.clamp(0,this.maxTp())},Game_BattlerBase.prototype.recoverAll=function(){this.clearStates(),this._hp=this.mhp,this._mp=this.mmp},Game_BattlerBase.prototype.hpRate=function(){return this.hp/this.mhp},Game_BattlerBase.prototype.mpRate=function(){return this.mmp>0?this.mp/this.mmp:0},Game_BattlerBase.prototype.tpRate=function(){return this.tp/100},Game_BattlerBase.prototype.hide=function(){this._hidden=!0},Game_BattlerBase.prototype.appear=function(){this._hidden=!1},Game_BattlerBase.prototype.isHidden=function(){return this._hidden},Game_BattlerBase.prototype.isAppeared=function(){return!this.isHidden()},Game_BattlerBase.prototype.isDead=function(){return this.isAppeared()&&this.isDeathStateAffected()},Game_BattlerBase.prototype.isAlive=function(){return this.isAppeared()&&!this.isDeathStateAffected()},Game_BattlerBase.prototype.isDying=function(){return this.isAlive()&&this._hp<this.mhp/4},Game_BattlerBase.prototype.isRestricted=function(){return this.isAppeared()&&this.restriction()>0},Game_BattlerBase.prototype.canInput=function(){return this.isAppeared()&&!this.isRestricted()&&!this.isAutoBattle()},Game_BattlerBase.prototype.canMove=function(){return this.isAppeared()&&this.restriction()<4},Game_BattlerBase.prototype.isConfused=function(){return this.isAppeared()&&this.restriction()>=1&&this.restriction()<=3},Game_BattlerBase.prototype.confusionLevel=function(){return this.isConfused()?this.restriction():0},Game_BattlerBase.prototype.isActor=function(){return!1},Game_BattlerBase.prototype.isEnemy=function(){return!1},Game_BattlerBase.prototype.sortStates=function(){this._states.sort((function(t,e){var a=$dataStates[t].priority,i=$dataStates[e].priority;return a!==i?i-a:t-e}))},Game_BattlerBase.prototype.restriction=function(){return Math.max.apply(null,this.states().map((function(t){return t.restriction})).concat(0))},Game_BattlerBase.prototype.addNewState=function(t){t===this.deathStateId()&&this.die();var e=this.isRestricted();this._states.push(t),this.sortStates(),!e&&this.isRestricted()&&this.onRestrict()},Game_BattlerBase.prototype.onRestrict=function(){},Game_BattlerBase.prototype.mostImportantStateText=function(){for(var t=this.states(),e=0;e<t.length;e++)if(t[e].message3)return t[e].message3;return""},Game_BattlerBase.prototype.stateMotionIndex=function(){var t=this.states();return t.length>0?t[0].motion:0},Game_BattlerBase.prototype.stateOverlayIndex=function(){var t=this.states();return t.length>0?t[0].overlay:0},Game_BattlerBase.prototype.isSkillWtypeOk=function(t){return!0},Game_BattlerBase.prototype.skillMpCost=function(t){return Math.floor(t.mpCost*this.mcr)},Game_BattlerBase.prototype.skillTpCost=function(t){return t.tpCost},Game_BattlerBase.prototype.canPaySkillCost=function(t){return this._tp>=this.skillTpCost(t)&&this._mp>=this.skillMpCost(t)},Game_BattlerBase.prototype.paySkillCost=function(t){this._mp-=this.skillMpCost(t),this._tp-=this.skillTpCost(t)},Game_BattlerBase.prototype.isOccasionOk=function(t){return $gameParty.inBattle()?0===t.occasion||1===t.occasion:0===t.occasion||2===t.occasion},Game_BattlerBase.prototype.meetsUsableItemConditions=function(t){return this.canMove()&&this.isOccasionOk(t)},Game_BattlerBase.prototype.meetsSkillConditions=function(t){return this.meetsUsableItemConditions(t)&&this.isSkillWtypeOk(t)&&this.canPaySkillCost(t)&&!this.isSkillSealed(t.id)&&!this.isSkillTypeSealed(t.stypeId)},Game_BattlerBase.prototype.meetsItemConditions=function(t){return this.meetsUsableItemConditions(t)&&$gameParty.hasItem(t)},Game_BattlerBase.prototype.canUse=function(t){return!!t&&(DataManager.isSkill(t)?this.meetsSkillConditions(t):!!DataManager.isItem(t)&&this.meetsItemConditions(t))},Game_BattlerBase.prototype.canEquip=function(t){return!!t&&(DataManager.isWeapon(t)?this.canEquipWeapon(t):!!DataManager.isArmor(t)&&this.canEquipArmor(t))},Game_BattlerBase.prototype.canEquipWeapon=function(t){return this.isEquipWtypeOk(t.wtypeId)&&!this.isEquipTypeSealed(t.etypeId)},Game_BattlerBase.prototype.canEquipArmor=function(t){return this.isEquipAtypeOk(t.atypeId)&&!this.isEquipTypeSealed(t.etypeId)},Game_BattlerBase.prototype.attackSkillId=function(){return 1},Game_BattlerBase.prototype.guardSkillId=function(){return 2},Game_BattlerBase.prototype.canAttack=function(){return this.canUse($dataSkills[this.attackSkillId()])},Game_BattlerBase.prototype.canGuard=function(){return this.canUse($dataSkills[this.guardSkillId()])},Game_Battler.prototype=Object.create(Game_BattlerBase.prototype),Game_Battler.prototype.constructor=Game_Battler,Game_Battler.prototype.initialize=function(){Game_BattlerBase.prototype.initialize.call(this)},Game_Battler.prototype.initMembers=function(){Game_BattlerBase.prototype.initMembers.call(this),this._actions=[],this._speed=0,this._result=new Game_ActionResult,this._actionState="",this._lastTargetIndex=0,this._animations=[],this._damagePopup=!1,this._effectType=null,this._motionType=null,this._weaponImageId=0,this._motionRefresh=!1,this._selected=!1},Game_Battler.prototype.clearAnimations=function(){this._animations=[]},Game_Battler.prototype.clearDamagePopup=function(){this._damagePopup=!1},Game_Battler.prototype.clearWeaponAnimation=function(){this._weaponImageId=0},Game_Battler.prototype.clearEffect=function(){this._effectType=null},Game_Battler.prototype.clearMotion=function(){this._motionType=null,this._motionRefresh=!1},Game_Battler.prototype.requestEffect=function(t){this._effectType=t},Game_Battler.prototype.requestMotion=function(t){this._motionType=t},Game_Battler.prototype.requestMotionRefresh=function(){this._motionRefresh=!0},Game_Battler.prototype.select=function(){this._selected=!0},Game_Battler.prototype.deselect=function(){this._selected=!1},Game_Battler.prototype.isAnimationRequested=function(){return this._animations.length>0},Game_Battler.prototype.isDamagePopupRequested=function(){return this._damagePopup},Game_Battler.prototype.isEffectRequested=function(){return!!this._effectType},Game_Battler.prototype.isMotionRequested=function(){return!!this._motionType},Game_Battler.prototype.isWeaponAnimationRequested=function(){return this._weaponImageId>0},Game_Battler.prototype.isMotionRefreshRequested=function(){return this._motionRefresh},Game_Battler.prototype.isSelected=function(){return this._selected},Game_Battler.prototype.effectType=function(){return this._effectType},Game_Battler.prototype.motionType=function(){return this._motionType},Game_Battler.prototype.weaponImageId=function(){return this._weaponImageId},Game_Battler.prototype.shiftAnimation=function(){return this._animations.shift()},Game_Battler.prototype.startAnimation=function(t,e,a){var i={animationId:t,mirror:e,delay:a};this._animations.push(i)},Game_Battler.prototype.startDamagePopup=function(){this._damagePopup=!0},Game_Battler.prototype.startWeaponAnimation=function(t){this._weaponImageId=t},Game_Battler.prototype.action=function(t){return this._actions[t]},Game_Battler.prototype.setAction=function(t,e){this._actions[t]=e},Game_Battler.prototype.numActions=function(){return this._actions.length},Game_Battler.prototype.clearActions=function(){this._actions=[]},Game_Battler.prototype.result=function(){return this._result},Game_Battler.prototype.clearResult=function(){this._result.clear()},Game_Battler.prototype.refresh=function(){Game_BattlerBase.prototype.refresh.call(this),0===this.hp?this.addState(this.deathStateId()):this.removeState(this.deathStateId())},Game_Battler.prototype.addState=function(t){this.isStateAddable(t)&&(this.isStateAffected(t)||(this.addNewState(t),this.refresh()),this.resetStateCounts(t),this._result.pushAddedState(t))},Game_Battler.prototype.isStateAddable=function(t){return this.isAlive()&&$dataStates[t]&&!this.isStateResist(t)&&!this._result.isStateRemoved(t)&&!this.isStateRestrict(t)},Game_Battler.prototype.isStateRestrict=function(t){return $dataStates[t].removeByRestriction&&this.isRestricted()},Game_Battler.prototype.onRestrict=function(){Game_BattlerBase.prototype.onRestrict.call(this),this.clearActions(),this.states().forEach((function(t){t.removeByRestriction&&this.removeState(t.id)}),this)},Game_Battler.prototype.removeState=function(t){this.isStateAffected(t)&&(t===this.deathStateId()&&this.revive(),this.eraseState(t),this.refresh(),this._result.pushRemovedState(t))},Game_Battler.prototype.escape=function(){$gameParty.inBattle()&&this.hide(),this.clearActions(),this.clearStates(),SoundManager.playEscape()},Game_Battler.prototype.addBuff=function(t,e){this.isAlive()&&(this.increaseBuff(t),this.isBuffAffected(t)&&this.overwriteBuffTurns(t,e),this._result.pushAddedBuff(t),this.refresh())},Game_Battler.prototype.addDebuff=function(t,e){this.isAlive()&&(this.decreaseBuff(t),this.isDebuffAffected(t)&&this.overwriteBuffTurns(t,e),this._result.pushAddedDebuff(t),this.refresh())},Game_Battler.prototype.removeBuff=function(t){this.isAlive()&&this.isBuffOrDebuffAffected(t)&&(this.eraseBuff(t),this._result.pushRemovedBuff(t),this.refresh())},Game_Battler.prototype.removeBattleStates=function(){this.states().forEach((function(t){t.removeAtBattleEnd&&this.removeState(t.id)}),this)},Game_Battler.prototype.removeAllBuffs=function(){for(var t=0;t<this.buffLength();t++)this.removeBuff(t)},Game_Battler.prototype.removeStatesAuto=function(t){this.states().forEach((function(e){this.isStateExpired(e.id)&&e.autoRemovalTiming===t&&this.removeState(e.id)}),this)},Game_Battler.prototype.removeBuffsAuto=function(){for(var t=0;t<this.buffLength();t++)this.isBuffExpired(t)&&this.removeBuff(t)},Game_Battler.prototype.removeStatesByDamage=function(){this.states().forEach((function(t){t.removeByDamage&&Math.randomInt(100)<t.chanceByDamage&&this.removeState(t.id)}),this)},Game_Battler.prototype.makeActionTimes=function(){return this.actionPlusSet().reduce((function(t,e){return Math.random()<e?t+1:t}),1)},Game_Battler.prototype.makeActions=function(){if(this.clearActions(),this.canMove()){var t=this.makeActionTimes();this._actions=[];for(var e=0;e<t;e++)this._actions.push(new Game_Action(this))}},Game_Battler.prototype.speed=function(){return this._speed},Game_Battler.prototype.makeSpeed=function(){this._speed=Math.min.apply(null,this._actions.map((function(t){return t.speed()})))||0},Game_Battler.prototype.currentAction=function(){return this._actions[0]},Game_Battler.prototype.removeCurrentAction=function(){this._actions.shift()},Game_Battler.prototype.setLastTarget=function(t){this._lastTargetIndex=t?t.index():0},Game_Battler.prototype.forceAction=function(t,e){this.clearActions();var a=new Game_Action(this,!0);a.setSkill(t),-2===e?a.setTarget(this._lastTargetIndex):-1===e?a.decideRandomTarget():a.setTarget(e),this._actions.push(a)},Game_Battler.prototype.useItem=function(t){DataManager.isSkill(t)?this.paySkillCost(t):DataManager.isItem(t)&&this.consumeItem(t)},Game_Battler.prototype.consumeItem=function(t){$gameParty.consumeItem(t)},Game_Battler.prototype.gainHp=function(t){this._result.hpDamage=-t,this._result.hpAffected=!0,this.setHp(this.hp+t)},Game_Battler.prototype.gainMp=function(t){this._result.mpDamage=-t,this.setMp(this.mp+t)},Game_Battler.prototype.gainTp=function(t){this._result.tpDamage=-t,this.setTp(this.tp+t)},Game_Battler.prototype.gainSilentTp=function(t){this.setTp(this.tp+t)},Game_Battler.prototype.initTp=function(){this.setTp(Math.randomInt(25))},Game_Battler.prototype.clearTp=function(){this.setTp(0)},Game_Battler.prototype.chargeTpByDamage=function(t){var e=Math.floor(50*t*this.tcr);this.gainSilentTp(e)},Game_Battler.prototype.regenerateHp=function(){var t=Math.floor(this.mhp*this.hrg);0!==(t=Math.max(t,-this.maxSlipDamage()))&&this.gainHp(t)},Game_Battler.prototype.maxSlipDamage=function(){return $dataSystem.optSlipDeath?this.hp:Math.max(this.hp-1,0)},Game_Battler.prototype.regenerateMp=function(){var t=Math.floor(this.mmp*this.mrg);0!==t&&this.gainMp(t)},Game_Battler.prototype.regenerateTp=function(){var t=Math.floor(100*this.trg);this.gainSilentTp(t)},Game_Battler.prototype.regenerateAll=function(){this.isAlive()&&(this.regenerateHp(),this.regenerateMp(),this.regenerateTp())},Game_Battler.prototype.onBattleStart=function(){this.setActionState("undecided"),this.clearMotion(),this.isPreserveTp()||this.initTp()},Game_Battler.prototype.onAllActionsEnd=function(){this.clearResult(),this.removeStatesAuto(1),this.removeBuffsAuto()},Game_Battler.prototype.onTurnEnd=function(){this.clearResult(),this.regenerateAll(),this.updateStateTurns(),this.updateBuffTurns(),this.removeStatesAuto(2)},Game_Battler.prototype.onBattleEnd=function(){this.clearResult(),this.removeBattleStates(),this.removeAllBuffs(),this.clearActions(),this.isPreserveTp()||this.clearTp(),this.appear()},Game_Battler.prototype.onDamage=function(t){this.removeStatesByDamage(),this.chargeTpByDamage(t/this.mhp)},Game_Battler.prototype.setActionState=function(t){this._actionState=t,this.requestMotionRefresh()},Game_Battler.prototype.isUndecided=function(){return"undecided"===this._actionState},Game_Battler.prototype.isInputting=function(){return"inputting"===this._actionState},Game_Battler.prototype.isWaiting=function(){return"waiting"===this._actionState},Game_Battler.prototype.isActing=function(){return"acting"===this._actionState},Game_Battler.prototype.isChanting=function(){return!!this.isWaiting()&&this._actions.some((function(t){return t.isMagicSkill()}))},Game_Battler.prototype.isGuardWaiting=function(){return!!this.isWaiting()&&this._actions.some((function(t){return t.isGuard()}))},Game_Battler.prototype.performActionStart=function(t){t.isGuard()||this.setActionState("acting")},Game_Battler.prototype.performAction=function(t){},Game_Battler.prototype.performActionEnd=function(){this.setActionState("done")},Game_Battler.prototype.performDamage=function(){},Game_Battler.prototype.performMiss=function(){SoundManager.playMiss()},Game_Battler.prototype.performRecovery=function(){SoundManager.playRecovery()},Game_Battler.prototype.performEvasion=function(){SoundManager.playEvasion()},Game_Battler.prototype.performMagicEvasion=function(){SoundManager.playMagicEvasion()},Game_Battler.prototype.performCounter=function(){SoundManager.playEvasion()},Game_Battler.prototype.performReflection=function(){SoundManager.playReflection()},Game_Battler.prototype.performSubstitute=function(t){},Game_Battler.prototype.performCollapse=function(){},Game_Actor.prototype=Object.create(Game_Battler.prototype),Game_Actor.prototype.constructor=Game_Actor,Object.defineProperty(Game_Actor.prototype,"level",{get:function(){return this._level},configurable:!0}),Game_Actor.prototype.initialize=function(t){Game_Battler.prototype.initialize.call(this),this.setup(t)},Game_Actor.prototype.initMembers=function(){Game_Battler.prototype.initMembers.call(this),this._actorId=0,this._name="",this._nickname="",this._classId=0,this._level=0,this._characterName="",this._characterIndex=0,this._faceName="",this._faceIndex=0,this._battlerName="",this._exp={},this._skills=[],this._equips=[],this._actionInputIndex=0,this._lastMenuSkill=new Game_Item,this._lastBattleSkill=new Game_Item,this._lastCommandSymbol=""},Game_Actor.prototype.setup=function(t){var e=$dataActors[t];this._actorId=t,this._name=e.name,this._nickname=e.nickname,this._profile=e.profile,this._classId=e.classId,this._level=e.initialLevel,this.initImages(),this.initExp(),this.initSkills(),this.initEquips(e.equips),this.clearParamPlus(),this.recoverAll()},Game_Actor.prototype.actorId=function(){return this._actorId},Game_Actor.prototype.actor=function(){return $dataActors[this._actorId]},Game_Actor.prototype.name=function(){return this._name},Game_Actor.prototype.setName=function(t){this._name=t},Game_Actor.prototype.nickname=function(){return this._nickname},Game_Actor.prototype.setNickname=function(t){this._nickname=t},Game_Actor.prototype.profile=function(){return this._profile},Game_Actor.prototype.setProfile=function(t){this._profile=t},Game_Actor.prototype.characterName=function(){return this._characterName},Game_Actor.prototype.characterIndex=function(){return this._characterIndex},Game_Actor.prototype.faceName=function(){return this._faceName},Game_Actor.prototype.faceIndex=function(){return this._faceIndex},Game_Actor.prototype.battlerName=function(){return this._battlerName},Game_Actor.prototype.clearStates=function(){Game_Battler.prototype.clearStates.call(this),this._stateSteps={}},Game_Actor.prototype.eraseState=function(t){Game_Battler.prototype.eraseState.call(this,t),delete this._stateSteps[t]},Game_Actor.prototype.resetStateCounts=function(t){Game_Battler.prototype.resetStateCounts.call(this,t),this._stateSteps[t]=$dataStates[t].stepsToRemove},Game_Actor.prototype.initImages=function(){var t=this.actor();this._characterName=t.characterName,this._characterIndex=t.characterIndex,this._faceName=t.faceName,this._faceIndex=t.faceIndex,this._battlerName=t.battlerName},Game_Actor.prototype.expForLevel=function(t){var e=this.currentClass(),a=e.expParams[0],i=e.expParams[1],r=e.expParams[2],s=e.expParams[3];return Math.round(a*Math.pow(t-1,.9+r/250)*t*(t+1)/(6+Math.pow(t,2)/50/s)+(t-1)*i)},Game_Actor.prototype.initExp=function(){this._exp[this._classId]=this.currentLevelExp()},Game_Actor.prototype.currentExp=function(){return this._exp[this._classId]},Game_Actor.prototype.currentLevelExp=function(){return this.expForLevel(this._level)},Game_Actor.prototype.nextLevelExp=function(){return this.expForLevel(this._level+1)},Game_Actor.prototype.nextRequiredExp=function(){return this.nextLevelExp()-this.currentExp()},Game_Actor.prototype.maxLevel=function(){return this.actor().maxLevel},Game_Actor.prototype.isMaxLevel=function(){return this._level>=this.maxLevel()},Game_Actor.prototype.initSkills=function(){this._skills=[],this.currentClass().learnings.forEach((function(t){t.level<=this._level&&this.learnSkill(t.skillId)}),this)},Game_Actor.prototype.initEquips=function(t){var e=this.equipSlots(),a=e.length;this._equips=[];for(var i=0;i<a;i++)this._equips[i]=new Game_Item;for(var r=0;r<t.length;r++)r<a&&this._equips[r].setEquip(1===e[r],t[r]);this.releaseUnequippableItems(!0),this.refresh()},Game_Actor.prototype.equipSlots=function(){for(var t=[],e=1;e<$dataSystem.equipTypes.length;e++)t.push(e);return t.length>=2&&this.isDualWield()&&(t[1]=1),t},Game_Actor.prototype.equips=function(){return this._equips.map((function(t){return t.object()}))},Game_Actor.prototype.weapons=function(){return this.equips().filter((function(t){return t&&DataManager.isWeapon(t)}))},Game_Actor.prototype.armors=function(){return this.equips().filter((function(t){return t&&DataManager.isArmor(t)}))},Game_Actor.prototype.hasWeapon=function(t){return this.weapons().contains(t)},Game_Actor.prototype.hasArmor=function(t){return this.armors().contains(t)},Game_Actor.prototype.isEquipChangeOk=function(t){return!this.isEquipTypeLocked(this.equipSlots()[t])&&!this.isEquipTypeSealed(this.equipSlots()[t])},Game_Actor.prototype.changeEquip=function(t,e){!this.tradeItemWithParty(e,this.equips()[t])||e&&this.equipSlots()[t]!==e.etypeId||(this._equips[t].setObject(e),this.refresh())},Game_Actor.prototype.forceChangeEquip=function(t,e){this._equips[t].setObject(e),this.releaseUnequippableItems(!0),this.refresh()},Game_Actor.prototype.tradeItemWithParty=function(t,e){return!(t&&!$gameParty.hasItem(t))&&($gameParty.gainItem(e,1),$gameParty.loseItem(t,1),!0)},Game_Actor.prototype.changeEquipById=function(t,e){var a=t-1;1===this.equipSlots()[a]?this.changeEquip(a,$dataWeapons[e]):this.changeEquip(a,$dataArmors[e])},Game_Actor.prototype.isEquipped=function(t){return this.equips().contains(t)},Game_Actor.prototype.discardEquip=function(t){var e=this.equips().indexOf(t);e>=0&&this._equips[e].setObject(null)},Game_Actor.prototype.releaseUnequippableItems=function(t){for(;;){for(var e=this.equipSlots(),a=this.equips(),i=!1,r=0;r<a.length;r++){var s=a[r];!s||this.canEquip(s)&&s.etypeId===e[r]||(t||this.tradeItemWithParty(null,s),this._equips[r].setObject(null),i=!0)}if(!i)break}},Game_Actor.prototype.clearEquipments=function(){for(var t=this.equipSlots().length,e=0;e<t;e++)this.isEquipChangeOk(e)&&this.changeEquip(e,null)},Game_Actor.prototype.optimizeEquipments=function(){var t=this.equipSlots().length;this.clearEquipments();for(var e=0;e<t;e++)this.isEquipChangeOk(e)&&this.changeEquip(e,this.bestEquipItem(e))},Game_Actor.prototype.bestEquipItem=function(t){for(var e=this.equipSlots()[t],a=$gameParty.equipItems().filter((function(t){return t.etypeId===e&&this.canEquip(t)}),this),i=null,r=-1e3,s=0;s<a.length;s++){var o=this.calcEquipItemPerformance(a[s]);o>r&&(r=o,i=a[s])}return i},Game_Actor.prototype.calcEquipItemPerformance=function(t){return t.params.reduce((function(t,e){return t+e}))},Game_Actor.prototype.isSkillWtypeOk=function(t){var e=t.requiredWtypeId1,a=t.requiredWtypeId2;return!!(0===e&&0===a||e>0&&this.isWtypeEquipped(e)||a>0&&this.isWtypeEquipped(a))},Game_Actor.prototype.isWtypeEquipped=function(t){return this.weapons().some((function(e){return e.wtypeId===t}))},Game_Actor.prototype.refresh=function(){this.releaseUnequippableItems(!1),Game_Battler.prototype.refresh.call(this)},Game_Actor.prototype.isActor=function(){return!0},Game_Actor.prototype.friendsUnit=function(){return $gameParty},Game_Actor.prototype.opponentsUnit=function(){return $gameTroop},Game_Actor.prototype.index=function(){return $gameParty.members().indexOf(this)},Game_Actor.prototype.isBattleMember=function(){return $gameParty.battleMembers().contains(this)},Game_Actor.prototype.isFormationChangeOk=function(){return!0},Game_Actor.prototype.currentClass=function(){return $dataClasses[this._classId]},Game_Actor.prototype.isClass=function(t){return t&&this._classId===t.id},Game_Actor.prototype.skills=function(){var t=[];return this._skills.concat(this.addedSkills()).forEach((function(e){t.contains($dataSkills[e])||t.push($dataSkills[e])})),t},Game_Actor.prototype.usableSkills=function(){return this.skills().filter((function(t){return this.canUse(t)}),this)},Game_Actor.prototype.traitObjects=function(){var t=Game_Battler.prototype.traitObjects.call(this);t=t.concat([this.actor(),this.currentClass()]);for(var e=this.equips(),a=0;a<e.length;a++){var i=e[a];i&&t.push(i)}return t},Game_Actor.prototype.attackElements=function(){var t=Game_Battler.prototype.attackElements.call(this);return this.hasNoWeapons()&&!t.contains(this.bareHandsElementId())&&t.push(this.bareHandsElementId()),t},Game_Actor.prototype.hasNoWeapons=function(){return 0===this.weapons().length},Game_Actor.prototype.bareHandsElementId=function(){return 1},Game_Actor.prototype.paramMax=function(t){return 0===t?9999:Game_Battler.prototype.paramMax.call(this,t)},Game_Actor.prototype.paramBase=function(t){return this.currentClass().params[t][this._level]},Game_Actor.prototype.paramPlus=function(t){for(var e=Game_Battler.prototype.paramPlus.call(this,t),a=this.equips(),i=0;i<a.length;i++){var r=a[i];r&&(e+=r.params[t])}return e},Game_Actor.prototype.attackAnimationId1=function(){if(this.hasNoWeapons())return this.bareHandsAnimationId();var t=this.weapons();return t[0]?t[0].animationId:0},Game_Actor.prototype.attackAnimationId2=function(){var t=this.weapons();return t[1]?t[1].animationId:0},Game_Actor.prototype.bareHandsAnimationId=function(){return 1},Game_Actor.prototype.changeExp=function(t,e){this._exp[this._classId]=Math.max(t,0);for(var a=this._level,i=this.skills();!this.isMaxLevel()&&this.currentExp()>=this.nextLevelExp();)this.levelUp();for(;this.currentExp()<this.currentLevelExp();)this.levelDown();e&&this._level>a&&this.displayLevelUp(this.findNewSkills(i)),this.refresh()},Game_Actor.prototype.levelUp=function(){this._level++,this.currentClass().learnings.forEach((function(t){t.level===this._level&&this.learnSkill(t.skillId)}),this)},Game_Actor.prototype.levelDown=function(){this._level--},Game_Actor.prototype.findNewSkills=function(t){for(var e=this.skills(),a=0;a<t.length;a++){var i=e.indexOf(t[a]);i>=0&&e.splice(i,1)}return e},Game_Actor.prototype.displayLevelUp=function(t){var e=TextManager.levelUp.format(this._name,TextManager.level,this._level);$gameMessage.newPage(),$gameMessage.add(e),t.forEach((function(t){$gameMessage.add(TextManager.obtainSkill.format(t.name))}))},Game_Actor.prototype.gainExp=function(t){var e=this.currentExp()+Math.round(t*this.finalExpRate());this.changeExp(e,this.shouldDisplayLevelUp())},Game_Actor.prototype.finalExpRate=function(){return this.exr*(this.isBattleMember()?1:this.benchMembersExpRate())},Game_Actor.prototype.benchMembersExpRate=function(){return $dataSystem.optExtraExp?1:0},Game_Actor.prototype.shouldDisplayLevelUp=function(){return!0},Game_Actor.prototype.changeLevel=function(t,e){t=t.clamp(1,this.maxLevel()),this.changeExp(this.expForLevel(t),e)},Game_Actor.prototype.learnSkill=function(t){this.isLearnedSkill(t)||(this._skills.push(t),this._skills.sort((function(t,e){return t-e})))},Game_Actor.prototype.forgetSkill=function(t){var e=this._skills.indexOf(t);e>=0&&this._skills.splice(e,1)},Game_Actor.prototype.isLearnedSkill=function(t){return this._skills.contains(t)},Game_Actor.prototype.changeClass=function(t,e){e&&(this._exp[t]=this.currentExp()),this._classId=t,this.changeExp(this._exp[this._classId]||0,!1),this.refresh()},Game_Actor.prototype.setCharacterImage=function(t,e){this._characterName=t,this._characterIndex=e},Game_Actor.prototype.setFaceImage=function(t,e){this._faceName=t,this._faceIndex=e},Game_Actor.prototype.setBattlerImage=function(t){this._battlerName=t},Game_Actor.prototype.isSpriteVisible=function(){return $gameSystem.isSideView()},Game_Actor.prototype.startAnimation=function(t,e,a){e=!e,Game_Battler.prototype.startAnimation.call(this,t,e,a)},Game_Actor.prototype.performActionStart=function(t){Game_Battler.prototype.performActionStart.call(this,t)},Game_Actor.prototype.performAction=function(t){Game_Battler.prototype.performAction.call(this,t),t.isAttack()?this.performAttack():t.isGuard()?this.requestMotion("guard"):t.isMagicSkill()?this.requestMotion("spell"):t.isSkill()?this.requestMotion("skill"):t.isItem()&&this.requestMotion("item")},Game_Actor.prototype.performActionEnd=function(){Game_Battler.prototype.performActionEnd.call(this)},Game_Actor.prototype.performAttack=function(){var t=this.weapons(),e=t[0]?t[0].wtypeId:0,a=$dataSystem.attackMotions[e];a&&(0===a.type?this.requestMotion("thrust"):1===a.type?this.requestMotion("swing"):2===a.type&&this.requestMotion("missile"),this.startWeaponAnimation(a.weaponImageId))},Game_Actor.prototype.performDamage=function(){Game_Battler.prototype.performDamage.call(this),this.isSpriteVisible()?this.requestMotion("damage"):$gameScreen.startShake(5,5,10),SoundManager.playActorDamage()},Game_Actor.prototype.performEvasion=function(){Game_Battler.prototype.performEvasion.call(this),this.requestMotion("evade")},Game_Actor.prototype.performMagicEvasion=function(){Game_Battler.prototype.performMagicEvasion.call(this),this.requestMotion("evade")},Game_Actor.prototype.performCounter=function(){Game_Battler.prototype.performCounter.call(this),this.performAttack()},Game_Actor.prototype.performCollapse=function(){Game_Battler.prototype.performCollapse.call(this),$gameParty.inBattle()&&SoundManager.playActorCollapse()},Game_Actor.prototype.performVictory=function(){this.canMove()&&this.requestMotion("victory")},Game_Actor.prototype.performEscape=function(){this.canMove()&&this.requestMotion("escape")},Game_Actor.prototype.makeActionList=function(){var t=[],e=new Game_Action(this);return e.setAttack(),t.push(e),this.usableSkills().forEach((function(a){(e=new Game_Action(this)).setSkill(a.id),t.push(e)}),this),t},Game_Actor.prototype.makeAutoBattleActions=function(){for(var t=0;t<this.numActions();t++)for(var e=this.makeActionList(),a=Number.MIN_VALUE,i=0;i<e.length;i++){var r=e[i].evaluate();r>a&&(a=r,this.setAction(t,e[i]))}this.setActionState("waiting")},Game_Actor.prototype.makeConfusionActions=function(){for(var t=0;t<this.numActions();t++)this.action(t).setConfusion();this.setActionState("waiting")},Game_Actor.prototype.makeActions=function(){Game_Battler.prototype.makeActions.call(this),this.numActions()>0?this.setActionState("undecided"):this.setActionState("waiting"),this.isAutoBattle()?this.makeAutoBattleActions():this.isConfused()&&this.makeConfusionActions()},Game_Actor.prototype.onPlayerWalk=function(){this.clearResult(),this.checkFloorEffect(),$gamePlayer.isNormal()&&(this.turnEndOnMap(),this.states().forEach((function(t){this.updateStateSteps(t)}),this),this.showAddedStates(),this.showRemovedStates())},Game_Actor.prototype.updateStateSteps=function(t){t.removeByWalking&&this._stateSteps[t.id]>0&&0==--this._stateSteps[t.id]&&this.removeState(t.id)},Game_Actor.prototype.showAddedStates=function(){this.result().addedStateObjects().forEach((function(t){t.message1&&$gameMessage.add(this._name+t.message1)}),this)},Game_Actor.prototype.showRemovedStates=function(){this.result().removedStateObjects().forEach((function(t){t.message4&&$gameMessage.add(this._name+t.message4)}),this)},Game_Actor.prototype.stepsForTurn=function(){return 20},Game_Actor.prototype.turnEndOnMap=function(){$gameParty.steps()%this.stepsForTurn()==0&&(this.onTurnEnd(),this.result().hpDamage>0&&this.performMapDamage())},Game_Actor.prototype.checkFloorEffect=function(){$gamePlayer.isOnDamageFloor()&&this.executeFloorDamage()},Game_Actor.prototype.executeFloorDamage=function(){var t=Math.floor(this.basicFloorDamage()*this.fdr);t=Math.min(t,this.maxFloorDamage()),this.gainHp(-t),t>0&&this.performMapDamage()},Game_Actor.prototype.basicFloorDamage=function(){return 10},Game_Actor.prototype.maxFloorDamage=function(){return $dataSystem.optFloorDeath?this.hp:Math.max(this.hp-1,0)},Game_Actor.prototype.performMapDamage=function(){$gameParty.inBattle()||$gameScreen.startFlashForDamage()},Game_Actor.prototype.clearActions=function(){Game_Battler.prototype.clearActions.call(this),this._actionInputIndex=0},Game_Actor.prototype.inputtingAction=function(){return this.action(this._actionInputIndex)},Game_Actor.prototype.selectNextCommand=function(){return this._actionInputIndex<this.numActions()-1&&(this._actionInputIndex++,!0)},Game_Actor.prototype.selectPreviousCommand=function(){return this._actionInputIndex>0&&(this._actionInputIndex--,!0)},Game_Actor.prototype.lastMenuSkill=function(){return this._lastMenuSkill.object()},Game_Actor.prototype.setLastMenuSkill=function(t){this._lastMenuSkill.setObject(t)},Game_Actor.prototype.lastBattleSkill=function(){return this._lastBattleSkill.object()},Game_Actor.prototype.setLastBattleSkill=function(t){this._lastBattleSkill.setObject(t)},Game_Actor.prototype.lastCommandSymbol=function(){return this._lastCommandSymbol},Game_Actor.prototype.setLastCommandSymbol=function(t){this._lastCommandSymbol=t},Game_Enemy.prototype=Object.create(Game_Battler.prototype),Game_Enemy.prototype.constructor=Game_Enemy,Game_Enemy.prototype.initialize=function(t,e,a){Game_Battler.prototype.initialize.call(this),this.setup(t,e,a)},Game_Enemy.prototype.initMembers=function(){Game_Battler.prototype.initMembers.call(this),this._enemyId=0,this._letter="",this._plural=!1,this._screenX=0,this._screenY=0},Game_Enemy.prototype.setup=function(t,e,a){this._enemyId=t,this._screenX=e,this._screenY=a,this.recoverAll()},Game_Enemy.prototype.isEnemy=function(){return!0},Game_Enemy.prototype.friendsUnit=function(){return $gameTroop},Game_Enemy.prototype.opponentsUnit=function(){return $gameParty},Game_Enemy.prototype.index=function(){return $gameTroop.members().indexOf(this)},Game_Enemy.prototype.isBattleMember=function(){return this.index()>=0},Game_Enemy.prototype.enemyId=function(){return this._enemyId},Game_Enemy.prototype.enemy=function(){return $dataEnemies[this._enemyId]},Game_Enemy.prototype.traitObjects=function(){return Game_Battler.prototype.traitObjects.call(this).concat(this.enemy())},Game_Enemy.prototype.paramBase=function(t){return this.enemy().params[t]},Game_Enemy.prototype.exp=function(){return this.enemy().exp},Game_Enemy.prototype.gold=function(){return this.enemy().gold},Game_Enemy.prototype.makeDropItems=function(){return this.enemy().dropItems.reduce(function(t,e){return e.kind>0&&Math.random()*e.denominator<this.dropItemRate()?t.concat(this.itemObject(e.kind,e.dataId)):t}.bind(this),[])},Game_Enemy.prototype.dropItemRate=function(){return $gameParty.hasDropItemDouble()?2:1},Game_Enemy.prototype.itemObject=function(t,e){return 1===t?$dataItems[e]:2===t?$dataWeapons[e]:3===t?$dataArmors[e]:null},Game_Enemy.prototype.isSpriteVisible=function(){return!0},Game_Enemy.prototype.screenX=function(){return this._screenX},Game_Enemy.prototype.screenY=function(){return this._screenY},Game_Enemy.prototype.battlerName=function(){return this.enemy().battlerName},Game_Enemy.prototype.battlerHue=function(){return this.enemy().battlerHue},Game_Enemy.prototype.originalName=function(){return this.enemy().name},Game_Enemy.prototype.name=function(){return this.originalName()+(this._plural?this._letter:"")},Game_Enemy.prototype.isLetterEmpty=function(){return""===this._letter},Game_Enemy.prototype.setLetter=function(t){this._letter=t},Game_Enemy.prototype.setPlural=function(t){this._plural=t},Game_Enemy.prototype.performActionStart=function(t){Game_Battler.prototype.performActionStart.call(this,t),this.requestEffect("whiten")},Game_Enemy.prototype.performAction=function(t){Game_Battler.prototype.performAction.call(this,t)},Game_Enemy.prototype.performActionEnd=function(){Game_Battler.prototype.performActionEnd.call(this)},Game_Enemy.prototype.performDamage=function(){Game_Battler.prototype.performDamage.call(this),SoundManager.playEnemyDamage(),this.requestEffect("blink")},Game_Enemy.prototype.performCollapse=function(){switch(Game_Battler.prototype.performCollapse.call(this),this.collapseType()){case 0:this.requestEffect("collapse"),SoundManager.playEnemyCollapse();break;case 1:this.requestEffect("bossCollapse"),SoundManager.playBossCollapse1();break;case 2:this.requestEffect("instantCollapse")}},Game_Enemy.prototype.transform=function(t){var e=this.originalName();this._enemyId=t,this.originalName()!==e&&(this._letter="",this._plural=!1),this.refresh(),this.numActions()>0&&this.makeActions()},Game_Enemy.prototype.meetsCondition=function(t){var e=t.conditionParam1,a=t.conditionParam2;switch(t.conditionType){case 1:return this.meetsTurnCondition(e,a);case 2:return this.meetsHpCondition(e,a);case 3:return this.meetsMpCondition(e,a);case 4:return this.meetsStateCondition(e);case 5:return this.meetsPartyLevelCondition(e);case 6:return this.meetsSwitchCondition(e);default:return!0}},Game_Enemy.prototype.meetsTurnCondition=function(t,e){var a=$gameTroop.turnCount();return 0===e?a===t:a>0&&a>=t&&a%e==t%e},Game_Enemy.prototype.meetsHpCondition=function(t,e){return this.hpRate()>=t&&this.hpRate()<=e},Game_Enemy.prototype.meetsMpCondition=function(t,e){return this.mpRate()>=t&&this.mpRate()<=e},Game_Enemy.prototype.meetsStateCondition=function(t){return this.isStateAffected(t)},Game_Enemy.prototype.meetsPartyLevelCondition=function(t){return $gameParty.highestLevel()>=t},Game_Enemy.prototype.meetsSwitchCondition=function(t){return $gameSwitches.value(t)},Game_Enemy.prototype.isActionValid=function(t){return this.meetsCondition(t)&&this.canUse($dataSkills[t.skillId])},Game_Enemy.prototype.selectAction=function(t,e){var a=t.reduce((function(t,a){return t+a.rating-e}),0);if(!(a>0))return null;for(var i=Math.randomInt(a),r=0;r<t.length;r++){var s=t[r];if((i-=s.rating-e)<0)return s}},Game_Enemy.prototype.selectAllActions=function(t){var e=Math.max.apply(null,t.map((function(t){return t.rating})))-3;t=t.filter((function(t){return t.rating>e}));for(var a=0;a<this.numActions();a++)this.action(a).setEnemyAction(this.selectAction(t,e))},Game_Enemy.prototype.makeActions=function(){if(Game_Battler.prototype.makeActions.call(this),this.numActions()>0){var t=this.enemy().actions.filter((function(t){return this.isActionValid(t)}),this);t.length>0&&this.selectAllActions(t)}this.setActionState("waiting")},Game_Actors.prototype.initialize=function(){this._data=[]},Game_Actors.prototype.actor=function(t){return $dataActors[t]?(this._data[t]||(this._data[t]=new Game_Actor(t)),this._data[t]):null},Game_Unit.prototype.initialize=function(){this._inBattle=!1},Game_Unit.prototype.inBattle=function(){return this._inBattle},Game_Unit.prototype.members=function(){return[]},Game_Unit.prototype.aliveMembers=function(){return this.members().filter((function(t){return t.isAlive()}))},Game_Unit.prototype.deadMembers=function(){return this.members().filter((function(t){return t.isDead()}))},Game_Unit.prototype.movableMembers=function(){return this.members().filter((function(t){return t.canMove()}))},Game_Unit.prototype.clearActions=function(){return this.members().forEach((function(t){return t.clearActions()}))},Game_Unit.prototype.agility=function(){var t=this.members();return 0===t.length?1:t.reduce((function(t,e){return t+e.agi}),0)/t.length},Game_Unit.prototype.tgrSum=function(){return this.aliveMembers().reduce((function(t,e){return t+e.tgr}),0)},Game_Unit.prototype.randomTarget=function(){var t=Math.random()*this.tgrSum(),e=null;return this.aliveMembers().forEach((function(a){(t-=a.tgr)<=0&&!e&&(e=a)})),e},Game_Unit.prototype.randomDeadTarget=function(){var t=this.deadMembers();return 0===t.length?null:t[Math.floor(Math.random()*t.length)]},Game_Unit.prototype.smoothTarget=function(t){t<0&&(t=0);var e=this.members()[t];return e&&e.isAlive()?e:this.aliveMembers()[0]},Game_Unit.prototype.smoothDeadTarget=function(t){t<0&&(t=0);var e=this.members()[t];return e&&e.isDead()?e:this.deadMembers()[0]},Game_Unit.prototype.clearResults=function(){this.members().forEach((function(t){t.clearResult()}))},Game_Unit.prototype.onBattleStart=function(){this.members().forEach((function(t){t.onBattleStart()})),this._inBattle=!0},Game_Unit.prototype.onBattleEnd=function(){this._inBattle=!1,this.members().forEach((function(t){t.onBattleEnd()}))},Game_Unit.prototype.makeActions=function(){this.members().forEach((function(t){t.makeActions()}))},Game_Unit.prototype.select=function(t){this.members().forEach((function(e){e===t?e.select():e.deselect()}))},Game_Unit.prototype.isAllDead=function(){return 0===this.aliveMembers().length},Game_Unit.prototype.substituteBattler=function(){for(var t=this.members(),e=0;e<t.length;e++)if(t[e].isSubstitute())return t[e]},Game_Party.prototype=Object.create(Game_Unit.prototype),Game_Party.prototype.constructor=Game_Party,Game_Party.ABILITY_ENCOUNTER_HALF=0,Game_Party.ABILITY_ENCOUNTER_NONE=1,Game_Party.ABILITY_CANCEL_SURPRISE=2,Game_Party.ABILITY_RAISE_PREEMPTIVE=3,Game_Party.ABILITY_GOLD_DOUBLE=4,Game_Party.ABILITY_DROP_ITEM_DOUBLE=5,Game_Party.prototype.initialize=function(){Game_Unit.prototype.initialize.call(this),this._gold=0,this._steps=0,this._lastItem=new Game_Item,this._menuActorId=0,this._targetActorId=0,this._actors=[],this.initAllItems()},Game_Party.prototype.initAllItems=function(){this._items={},this._weapons={},this._armors={}},Game_Party.prototype.exists=function(){return this._actors.length>0},Game_Party.prototype.size=function(){return this.members().length},Game_Party.prototype.isEmpty=function(){return 0===this.size()},Game_Party.prototype.members=function(){return this.inBattle()?this.battleMembers():this.allMembers()},Game_Party.prototype.allMembers=function(){return this._actors.map((function(t){return $gameActors.actor(t)}))},Game_Party.prototype.battleMembers=function(){return this.allMembers().slice(0,this.maxBattleMembers()).filter((function(t){return t.isAppeared()}))},Game_Party.prototype.maxBattleMembers=function(){return 4},Game_Party.prototype.leader=function(){return this.battleMembers()[0]},Game_Party.prototype.reviveBattleMembers=function(){this.battleMembers().forEach((function(t){t.isDead()&&t.setHp(1)}))},Game_Party.prototype.items=function(){var t=[];for(var e in this._items)t.push($dataItems[e]);return t},Game_Party.prototype.weapons=function(){var t=[];for(var e in this._weapons)t.push($dataWeapons[e]);return t},Game_Party.prototype.armors=function(){var t=[];for(var e in this._armors)t.push($dataArmors[e]);return t},Game_Party.prototype.equipItems=function(){return this.weapons().concat(this.armors())},Game_Party.prototype.allItems=function(){return this.items().concat(this.equipItems())},Game_Party.prototype.itemContainer=function(t){return t?DataManager.isItem(t)?this._items:DataManager.isWeapon(t)?this._weapons:DataManager.isArmor(t)?this._armors:null:null},Game_Party.prototype.setupStartingMembers=function(){this._actors=[],$dataSystem.partyMembers.forEach((function(t){$gameActors.actor(t)&&this._actors.push(t)}),this)},Game_Party.prototype.name=function(){var t=this.battleMembers().length;return 0===t?"":1===t?this.leader().name():TextManager.partyName.format(this.leader().name())},Game_Party.prototype.setupBattleTest=function(){this.setupBattleTestMembers(),this.setupBattleTestItems()},Game_Party.prototype.setupBattleTestMembers=function(){$dataSystem.testBattlers.forEach((function(t){var e=$gameActors.actor(t.actorId);e&&(e.changeLevel(t.level,!1),e.initEquips(t.equips),e.recoverAll(),this.addActor(t.actorId))}),this)};Game_Party.prototype.setupBattleTestItems=function(){$dataItems.forEach((function(t){t&&t.name.length>0&&this.gainItem(t,this.maxItems(t))}),this)},Game_Party.prototype.highestLevel=function(){return Math.max.apply(null,this.members().map((function(t){return t.level})))},Game_Party.prototype.addActor=function(t){this._actors.contains(t)||(this._actors.push(t),$gamePlayer.refresh(),$gameMap.requestRefresh())},Game_Party.prototype.removeActor=function(t){this._actors.contains(t)&&(this._actors.splice(this._actors.indexOf(t),1),$gamePlayer.refresh(),$gameMap.requestRefresh())},Game_Party.prototype.gold=function(){return this._gold},Game_Party.prototype.gainGold=function(t){this._gold=(this._gold+t).clamp(0,this.maxGold())},Game_Party.prototype.loseGold=function(t){this.gainGold(-t)},Game_Party.prototype.maxGold=function(){return 99999999},Game_Party.prototype.steps=function(){return this._steps},Game_Party.prototype.increaseSteps=function(){this._steps++},Game_Party.prototype.numItems=function(t){var e=this.itemContainer(t);return e&&e[t.id]||0},Game_Party.prototype.maxItems=function(t){return 99},Game_Party.prototype.hasMaxItems=function(t){return this.numItems(t)>=this.maxItems(t)},Game_Party.prototype.hasItem=function(t,e){return void 0===e&&(e=!1),this.numItems(t)>0||!(!e||!this.isAnyMemberEquipped(t))},Game_Party.prototype.isAnyMemberEquipped=function(t){return this.members().some((function(e){return e.equips().contains(t)}))},Game_Party.prototype.gainItem=function(t,e,a){var i=this.itemContainer(t);if(i){var r=this.numItems(t)+e;i[t.id]=r.clamp(0,this.maxItems(t)),0===i[t.id]&&delete i[t.id],a&&r<0&&this.discardMembersEquip(t,-r),$gameMap.requestRefresh()}},Game_Party.prototype.discardMembersEquip=function(t,e){var a=e;this.members().forEach((function(e){for(;a>0&&e.isEquipped(t);)e.discardEquip(t),a--}))},Game_Party.prototype.loseItem=function(t,e,a){this.gainItem(t,-e,a)},Game_Party.prototype.consumeItem=function(t){DataManager.isItem(t)&&t.consumable&&this.loseItem(t,1)},Game_Party.prototype.canUse=function(t){return this.members().some((function(e){return e.canUse(t)}))},Game_Party.prototype.canInput=function(){return this.members().some((function(t){return t.canInput()}))},Game_Party.prototype.isAllDead=function(){return!!Game_Unit.prototype.isAllDead.call(this)&&(this.inBattle()||!this.isEmpty())},Game_Party.prototype.onPlayerWalk=function(){this.members().forEach((function(t){return t.onPlayerWalk()}))},Game_Party.prototype.menuActor=function(){var t=$gameActors.actor(this._menuActorId);return this.members().contains(t)||(t=this.members()[0]),t},Game_Party.prototype.setMenuActor=function(t){this._menuActorId=t.actorId()},Game_Party.prototype.makeMenuActorNext=function(){var t=this.members().indexOf(this.menuActor());t>=0?(t=(t+1)%this.members().length,this.setMenuActor(this.members()[t])):this.setMenuActor(this.members()[0])},Game_Party.prototype.makeMenuActorPrevious=function(){var t=this.members().indexOf(this.menuActor());t>=0?(t=(t+this.members().length-1)%this.members().length,this.setMenuActor(this.members()[t])):this.setMenuActor(this.members()[0])},Game_Party.prototype.targetActor=function(){var t=$gameActors.actor(this._targetActorId);return this.members().contains(t)||(t=this.members()[0]),t},Game_Party.prototype.setTargetActor=function(t){this._targetActorId=t.actorId()},Game_Party.prototype.lastItem=function(){return this._lastItem.object()},Game_Party.prototype.setLastItem=function(t){this._lastItem.setObject(t)},Game_Party.prototype.swapOrder=function(t,e){var a=this._actors[t];this._actors[t]=this._actors[e],this._actors[e]=a,$gamePlayer.refresh()},Game_Party.prototype.charactersForSavefile=function(){return this.battleMembers().map((function(t){return[t.characterName(),t.characterIndex()]}))},Game_Party.prototype.facesForSavefile=function(){return this.battleMembers().map((function(t){return[t.faceName(),t.faceIndex()]}))},Game_Party.prototype.partyAbility=function(t){return this.battleMembers().some((function(e){return e.partyAbility(t)}))},Game_Party.prototype.hasEncounterHalf=function(){return this.partyAbility(Game_Party.ABILITY_ENCOUNTER_HALF)},Game_Party.prototype.hasEncounterNone=function(){return this.partyAbility(Game_Party.ABILITY_ENCOUNTER_NONE)},Game_Party.prototype.hasCancelSurprise=function(){return this.partyAbility(Game_Party.ABILITY_CANCEL_SURPRISE)},Game_Party.prototype.hasRaisePreemptive=function(){return this.partyAbility(Game_Party.ABILITY_RAISE_PREEMPTIVE)},Game_Party.prototype.hasGoldDouble=function(){return this.partyAbility(Game_Party.ABILITY_GOLD_DOUBLE)},Game_Party.prototype.hasDropItemDouble=function(){return this.partyAbility(Game_Party.ABILITY_DROP_ITEM_DOUBLE)},Game_Party.prototype.ratePreemptive=function(t){var e=this.agility()>=t?.05:.03;return this.hasRaisePreemptive()&&(e*=4),e},Game_Party.prototype.rateSurprise=function(t){var e=this.agility()>=t?.03:.05;return this.hasCancelSurprise()&&(e=0),e},Game_Party.prototype.performVictory=function(){this.members().forEach((function(t){t.performVictory()}))},Game_Party.prototype.performEscape=function(){this.members().forEach((function(t){t.performEscape()}))},Game_Party.prototype.removeBattleStates=function(){this.members().forEach((function(t){t.removeBattleStates()}))},Game_Party.prototype.requestMotionRefresh=function(){this.members().forEach((function(t){t.requestMotionRefresh()}))},Game_Troop.prototype=Object.create(Game_Unit.prototype),Game_Troop.prototype.constructor=Game_Troop,Game_Troop.LETTER_TABLE_HALF=[" A"," B"," C"," D"," E"," F"," G"," H"," I"," J"," K"," L"," M"," N"," O"," P"," Q"," R"," S"," T"," U"," V"," W"," X"," Y"," Z"],Game_Troop.LETTER_TABLE_FULL=["Ａ","Ｂ","Ｃ","Ｄ","Ｅ","Ｆ","Ｇ","Ｈ","Ｉ","Ｊ","Ｋ","Ｌ","Ｍ","Ｎ","Ｏ","Ｐ","Ｑ","Ｒ","Ｓ","Ｔ","Ｕ","Ｖ","Ｗ","Ｘ","Ｙ","Ｚ"],Game_Troop.prototype.initialize=function(){Game_Unit.prototype.initialize.call(this),this._interpreter=new Game_Interpreter,this.clear()},Game_Troop.prototype.isEventRunning=function(){return this._interpreter.isRunning()},Game_Troop.prototype.updateInterpreter=function(){this._interpreter.update()},Game_Troop.prototype.turnCount=function(){return this._turnCount},Game_Troop.prototype.members=function(){return this._enemies},Game_Troop.prototype.clear=function(){this._interpreter.clear(),this._troopId=0,this._eventFlags={},this._enemies=[],this._turnCount=0,this._namesCount={}},Game_Troop.prototype.troop=function(){return $dataTroops[this._troopId]},Game_Troop.prototype.setup=function(t){this.clear(),this._troopId=t,this._enemies=[],this.troop().members.forEach((function(t){if($dataEnemies[t.enemyId]){var e=new Game_Enemy(t.enemyId,t.x,t.y);t.hidden&&e.hide(),this._enemies.push(e)}}),this),this.makeUniqueNames()},Game_Troop.prototype.makeUniqueNames=function(){var t=this.letterTable();this.members().forEach((function(e){if(e.isAlive()&&e.isLetterEmpty()){var a=e.originalName(),i=this._namesCount[a]||0;e.setLetter(t[i%t.length]),this._namesCount[a]=i+1}}),this),this.members().forEach((function(t){var e=t.originalName();this._namesCount[e]>=2&&t.setPlural(!0)}),this)},Game_Troop.prototype.letterTable=function(){return $gameSystem.isCJK()?Game_Troop.LETTER_TABLE_FULL:Game_Troop.LETTER_TABLE_HALF},Game_Troop.prototype.enemyNames=function(){var t=[];return this.members().forEach((function(e){var a=e.originalName();e.isAlive()&&!t.contains(a)&&t.push(a)})),t},Game_Troop.prototype.meetsConditions=function(t){var e=t.conditions;if(!(e.turnEnding||e.turnValid||e.enemyValid||e.actorValid||e.switchValid))return!1;if(e.turnEnding&&!BattleManager.isTurnEnd())return!1;if(e.turnValid){var a=this._turnCount,i=e.turnA,r=e.turnB;if(0===r&&a!==i)return!1;if(r>0&&(a<1||a<i||a%r!=i%r))return!1}if(e.enemyValid){var s=$gameTroop.members()[e.enemyIndex];if(!s||100*s.hpRate()>e.enemyHp)return!1}if(e.actorValid){var o=$gameActors.actor(e.actorId);if(!o||100*o.hpRate()>e.actorHp)return!1}return!(e.switchValid&&!$gameSwitches.value(e.switchId))},Game_Troop.prototype.setupBattleEvent=function(){if(!this._interpreter.isRunning()){if(this._interpreter.setupReservedCommonEvent())return;for(var t=this.troop().pages,e=0;e<t.length;e++){var a=t[e];if(this.meetsConditions(a)&&!this._eventFlags[e]){this._interpreter.setup(a.list),a.span<=1&&(this._eventFlags[e]=!0);break}}}},Game_Troop.prototype.increaseTurn=function(){for(var t=this.troop().pages,e=0;e<t.length;e++){1===t[e].span&&(this._eventFlags[e]=!1)}this._turnCount++},Game_Troop.prototype.expTotal=function(){return this.deadMembers().reduce((function(t,e){return t+e.exp()}),0)},Game_Troop.prototype.goldTotal=function(){return this.deadMembers().reduce((function(t,e){return t+e.gold()}),0)*this.goldRate()},Game_Troop.prototype.goldRate=function(){return $gameParty.hasGoldDouble()?2:1},Game_Troop.prototype.makeDropItems=function(){return this.deadMembers().reduce((function(t,e){return t.concat(e.makeDropItems())}),[])},Game_Map.prototype.initialize=function(){this._interpreter=new Game_Interpreter,this._mapId=0,this._tilesetId=0,this._events=[],this._commonEvents=[],this._vehicles=[],this._displayX=0,this._displayY=0,this._nameDisplay=!0,this._scrollDirection=2,this._scrollRest=0,this._scrollSpeed=4,this._parallaxName="",this._parallaxZero=!1,this._parallaxLoopX=!1,this._parallaxLoopY=!1,this._parallaxSx=0,this._parallaxSy=0,this._parallaxX=0,this._parallaxY=0,this._battleback1Name=null,this._battleback2Name=null,this.createVehicles()},Game_Map.prototype.setup=function(t){if(!$dataMap)throw new Error("The map data is not available");this._mapId=t,this._tilesetId=$dataMap.tilesetId,this._displayX=0,this._displayY=0,this.refereshVehicles(),this.setupEvents(),this.setupScroll(),this.setupParallax(),this.setupBattleback(),this._needsRefresh=!1},Game_Map.prototype.isEventRunning=function(){return this._interpreter.isRunning()||this.isAnyEventStarting()},Game_Map.prototype.tileWidth=function(){return 48},Game_Map.prototype.tileHeight=function(){return 48},Game_Map.prototype.mapId=function(){return this._mapId},Game_Map.prototype.tilesetId=function(){return this._tilesetId},Game_Map.prototype.displayX=function(){return this._displayX},Game_Map.prototype.displayY=function(){return this._displayY},Game_Map.prototype.parallaxName=function(){return this._parallaxName},Game_Map.prototype.battleback1Name=function(){return this._battleback1Name},Game_Map.prototype.battleback2Name=function(){return this._battleback2Name},Game_Map.prototype.requestRefresh=function(t){this._needsRefresh=!0},Game_Map.prototype.isNameDisplayEnabled=function(){return this._nameDisplay},Game_Map.prototype.disableNameDisplay=function(){this._nameDisplay=!1},Game_Map.prototype.enableNameDisplay=function(){this._nameDisplay=!0},Game_Map.prototype.createVehicles=function(){this._vehicles=[],this._vehicles[0]=new Game_Vehicle("boat"),this._vehicles[1]=new Game_Vehicle("ship"),this._vehicles[2]=new Game_Vehicle("airship")},Game_Map.prototype.refereshVehicles=function(){this._vehicles.forEach((function(t){t.refresh()}))},Game_Map.prototype.vehicles=function(){return this._vehicles},Game_Map.prototype.vehicle=function(t){return 0===t||"boat"===t?this.boat():1===t||"ship"===t?this.ship():2===t||"airship"===t?this.airship():null},Game_Map.prototype.boat=function(){return this._vehicles[0]},Game_Map.prototype.ship=function(){return this._vehicles[1]},Game_Map.prototype.airship=function(){return this._vehicles[2]},Game_Map.prototype.setupEvents=function(){this._events=[];for(var t=0;t<$dataMap.events.length;t++)$dataMap.events[t]&&(this._events[t]=new Game_Event(this._mapId,t));this._commonEvents=this.parallelCommonEvents().map((function(t){return new Game_CommonEvent(t.id)})),this.refreshTileEvents()},Game_Map.prototype.events=function(){return this._events.filter((function(t){return!!t}))},Game_Map.prototype.event=function(t){return this._events[t]},Game_Map.prototype.eraseEvent=function(t){this._events[t].erase()},Game_Map.prototype.parallelCommonEvents=function(){return $dataCommonEvents.filter((function(t){return t&&2===t.trigger}))},Game_Map.prototype.setupScroll=function(){this._scrollDirection=2,this._scrollRest=0,this._scrollSpeed=4},Game_Map.prototype.setupParallax=function(){this._parallaxName=$dataMap.parallaxName||"",this._parallaxZero=ImageManager.isZeroParallax(this._parallaxName),this._parallaxLoopX=$dataMap.parallaxLoopX,this._parallaxLoopY=$dataMap.parallaxLoopY,this._parallaxSx=$dataMap.parallaxSx,this._parallaxSy=$dataMap.parallaxSy,this._parallaxX=0,this._parallaxY=0},Game_Map.prototype.setupBattleback=function(){$dataMap.specifyBattleback?(this._battleback1Name=$dataMap.battleback1Name,this._battleback2Name=$dataMap.battleback2Name):(this._battleback1Name=null,this._battleback2Name=null)},Game_Map.prototype.setDisplayPos=function(t,e){if(this.isLoopHorizontal())this._displayX=t.mod(this.width()),this._parallaxX=t;else{var a=this.width()-this.screenTileX();this._displayX=a<0?a/2:t.clamp(0,a),this._parallaxX=this._displayX}if(this.isLoopVertical())this._displayY=e.mod(this.height()),this._parallaxY=e;else{var i=this.height()-this.screenTileY();this._displayY=i<0?i/2:e.clamp(0,i),this._parallaxY=this._displayY}},Game_Map.prototype.parallaxOx=function(){return this._parallaxZero?this._parallaxX*this.tileWidth():this._parallaxLoopX?this._parallaxX*this.tileWidth()/2:0},Game_Map.prototype.parallaxOy=function(){return this._parallaxZero?this._parallaxY*this.tileHeight():this._parallaxLoopY?this._parallaxY*this.tileHeight()/2:0},Game_Map.prototype.tileset=function(){return $dataTilesets[this._tilesetId]},Game_Map.prototype.tilesetFlags=function(){var t=this.tileset();return t?t.flags:[]},Game_Map.prototype.displayName=function(){return $dataMap.displayName},Game_Map.prototype.width=function(){return $dataMap.width},Game_Map.prototype.height=function(){return $dataMap.height},Game_Map.prototype.data=function(){return $dataMap.data},Game_Map.prototype.isLoopHorizontal=function(){return 2===$dataMap.scrollType||3===$dataMap.scrollType},Game_Map.prototype.isLoopVertical=function(){return 1===$dataMap.scrollType||3===$dataMap.scrollType},Game_Map.prototype.isDashDisabled=function(){return $dataMap.disableDashing},Game_Map.prototype.encounterList=function(){return $dataMap.encounterList},Game_Map.prototype.encounterStep=function(){return $dataMap.encounterStep},Game_Map.prototype.isOverworld=function(){return this.tileset()&&0===this.tileset().mode},Game_Map.prototype.screenTileX=function(){return Graphics.width/this.tileWidth()},Game_Map.prototype.screenTileY=function(){return Graphics.height/this.tileHeight()},Game_Map.prototype.adjustX=function(t){return this.isLoopHorizontal()&&t<this._displayX-(this.width()-this.screenTileX())/2?t-this._displayX+$dataMap.width:t-this._displayX},Game_Map.prototype.adjustY=function(t){return this.isLoopVertical()&&t<this._displayY-(this.height()-this.screenTileY())/2?t-this._displayY+$dataMap.height:t-this._displayY},Game_Map.prototype.roundX=function(t){return this.isLoopHorizontal()?t.mod(this.width()):t},Game_Map.prototype.roundY=function(t){return this.isLoopVertical()?t.mod(this.height()):t},Game_Map.prototype.xWithDirection=function(t,e){return t+(6===e?1:4===e?-1:0)},Game_Map.prototype.yWithDirection=function(t,e){return t+(2===e?1:8===e?-1:0)},Game_Map.prototype.roundXWithDirection=function(t,e){return this.roundX(t+(6===e?1:4===e?-1:0))},Game_Map.prototype.roundYWithDirection=function(t,e){return this.roundY(t+(2===e?1:8===e?-1:0))},Game_Map.prototype.deltaX=function(t,e){var a=t-e;return this.isLoopHorizontal()&&Math.abs(a)>this.width()/2&&(a<0?a+=this.width():a-=this.width()),a},Game_Map.prototype.deltaY=function(t,e){var a=t-e;return this.isLoopVertical()&&Math.abs(a)>this.height()/2&&(a<0?a+=this.height():a-=this.height()),a},Game_Map.prototype.distance=function(t,e,a,i){return Math.abs(this.deltaX(t,a))+Math.abs(this.deltaY(e,i))},Game_Map.prototype.canvasToMapX=function(t){var e=this.tileWidth(),a=this._displayX*e,i=Math.floor((a+t)/e);return this.roundX(i)},Game_Map.prototype.canvasToMapY=function(t){var e=this.tileHeight(),a=this._displayY*e,i=Math.floor((a+t)/e);return this.roundY(i)},Game_Map.prototype.autoplay=function(){$dataMap.autoplayBgm&&AudioManager.playBgm($dataMap.bgm),$dataMap.autoplayBgs&&AudioManager.playBgs($dataMap.bgs)},Game_Map.prototype.refreshIfNeeded=function(){this._needsRefresh&&this.refresh()},Game_Map.prototype.refresh=function(){this.events().forEach((function(t){t.refresh()})),this._commonEvents.forEach((function(t){t.refresh()})),this.refreshTileEvents(),this._needsRefresh=!1},Game_Map.prototype.refreshTileEvents=function(){this.tileEvents=this.events().filter((function(t){return t.isTile()}))},Game_Map.prototype.eventsXy=function(t,e){return this.events().filter((function(a){return a.pos(t,e)}))},Game_Map.prototype.eventsXyNt=function(t,e){return this.events().filter((function(a){return a.posNt(t,e)}))},Game_Map.prototype.tileEventsXy=function(t,e){return this.tileEvents.filter((function(a){return a.posNt(t,e)}))},Game_Map.prototype.eventIdXy=function(t,e){var a=this.eventsXy(t,e);return 0===a.length?0:a[0].eventId()},Game_Map.prototype.scrollDown=function(t){if(this.isLoopVertical())this._displayY+=t,this._displayY%=$dataMap.height,this._parallaxLoopY&&(this._parallaxY+=t);else if(this.height()>=this.screenTileY()){var e=this._displayY;this._displayY=Math.min(this._displayY+t,this.height()-this.screenTileY()),this._parallaxY+=this._displayY-e}},Game_Map.prototype.scrollLeft=function(t){if(this.isLoopHorizontal())this._displayX+=$dataMap.width-t,this._displayX%=$dataMap.width,this._parallaxLoopX&&(this._parallaxX-=t);else if(this.width()>=this.screenTileX()){var e=this._displayX;this._displayX=Math.max(this._displayX-t,0),this._parallaxX+=this._displayX-e}},Game_Map.prototype.scrollRight=function(t){if(this.isLoopHorizontal())this._displayX+=t,this._displayX%=$dataMap.width,this._parallaxLoopX&&(this._parallaxX+=t);else if(this.width()>=this.screenTileX()){var e=this._displayX;this._displayX=Math.min(this._displayX+t,this.width()-this.screenTileX()),this._parallaxX+=this._displayX-e}},Game_Map.prototype.scrollUp=function(t){if(this.isLoopVertical())this._displayY+=$dataMap.height-t,this._displayY%=$dataMap.height,this._parallaxLoopY&&(this._parallaxY-=t);else if(this.height()>=this.screenTileY()){var e=this._displayY;this._displayY=Math.max(this._displayY-t,0),this._parallaxY+=this._displayY-e}},Game_Map.prototype.isValid=function(t,e){return t>=0&&t<this.width()&&e>=0&&e<this.height()},Game_Map.prototype.checkPassage=function(t,e,a){for(var i=this.tilesetFlags(),r=this.allTiles(t,e),s=0;s<r.length;s++){var o=i[r[s]];if(0==(16&o)){if(0==(o&a))return!0;if((o&a)===a)return!1}}return!1},Game_Map.prototype.tileId=function(t,e,a){var i=$dataMap.width,r=$dataMap.height;return $dataMap.data[(a*r+e)*i+t]||0},Game_Map.prototype.layeredTiles=function(t,e){for(var a=[],i=0;i<4;i++)a.push(this.tileId(t,e,3-i));return a},Game_Map.prototype.allTiles=function(t,e){return this.tileEventsXy(t,e).map((function(t){return t.tileId()})).concat(this.layeredTiles(t,e))},Game_Map.prototype.autotileType=function(t,e,a){var i=this.tileId(t,e,a);return i>=2048?Math.floor((i-2048)/48):-1},Game_Map.prototype.isPassable=function(t,e,a){return this.checkPassage(t,e,1<<a/2-1&15)},Game_Map.prototype.isBoatPassable=function(t,e){return this.checkPassage(t,e,512)},Game_Map.prototype.isShipPassable=function(t,e){return this.checkPassage(t,e,1024)},Game_Map.prototype.isAirshipLandOk=function(t,e){return this.checkPassage(t,e,2048)&&this.checkPassage(t,e,15)},Game_Map.prototype.checkLayeredTilesFlags=function(t,e,a){var i=this.tilesetFlags();return this.layeredTiles(t,e).some((function(t){return 0!=(i[t]&a)}))},Game_Map.prototype.isLadder=function(t,e){return this.isValid(t,e)&&this.checkLayeredTilesFlags(t,e,32)},Game_Map.prototype.isBush=function(t,e){return this.isValid(t,e)&&this.checkLayeredTilesFlags(t,e,64)},Game_Map.prototype.isCounter=function(t,e){return this.isValid(t,e)&&this.checkLayeredTilesFlags(t,e,128)},Game_Map.prototype.isDamageFloor=function(t,e){return this.isValid(t,e)&&this.checkLayeredTilesFlags(t,e,256)},Game_Map.prototype.terrainTag=function(t,e){if(this.isValid(t,e))for(var a=this.tilesetFlags(),i=this.layeredTiles(t,e),r=0;r<i.length;r++){var s=a[i[r]]>>12;if(s>0)return s}return 0},Game_Map.prototype.regionId=function(t,e){return this.isValid(t,e)?this.tileId(t,e,5):0},Game_Map.prototype.startScroll=function(t,e,a){this._scrollDirection=t,this._scrollRest=e,this._scrollSpeed=a},Game_Map.prototype.isScrolling=function(){return this._scrollRest>0},Game_Map.prototype.update=function(t){this.refreshIfNeeded(),t&&this.updateInterpreter(),this.updateScroll(),this.updateEvents(),this.updateVehicles(),this.updateParallax()},Game_Map.prototype.updateScroll=function(){if(this.isScrolling()){var t=this._displayX,e=this._displayY;this.doScroll(this._scrollDirection,this.scrollDistance()),this._displayX===t&&this._displayY===e?this._scrollRest=0:this._scrollRest-=this.scrollDistance()}},Game_Map.prototype.scrollDistance=function(){return Math.pow(2,this._scrollSpeed)/256},Game_Map.prototype.doScroll=function(t,e){switch(t){case 2:this.scrollDown(e);break;case 4:this.scrollLeft(e);break;case 6:this.scrollRight(e);break;case 8:this.scrollUp(e)}},Game_Map.prototype.updateEvents=function(){this.events().forEach((function(t){t.update()})),this._commonEvents.forEach((function(t){t.update()}))},Game_Map.prototype.updateVehicles=function(){this._vehicles.forEach((function(t){t.update()}))},Game_Map.prototype.updateParallax=function(){this._parallaxLoopX&&(this._parallaxX+=this._parallaxSx/this.tileWidth()/2),this._parallaxLoopY&&(this._parallaxY+=this._parallaxSy/this.tileHeight()/2)},Game_Map.prototype.changeTileset=function(t){this._tilesetId=t,this.refresh()},Game_Map.prototype.changeBattleback=function(t,e){this._battleback1Name=t,this._battleback2Name=e},Game_Map.prototype.changeParallax=function(t,e,a,i,r){this._parallaxName=t,this._parallaxZero=ImageManager.isZeroParallax(this._parallaxName),this._parallaxLoopX&&!e&&(this._parallaxX=0),this._parallaxLoopY&&!a&&(this._parallaxY=0),this._parallaxLoopX=e,this._parallaxLoopY=a,this._parallaxSx=i,this._parallaxSy=r},Game_Map.prototype.updateInterpreter=function(){for(;;){if(this._interpreter.update(),this._interpreter.isRunning())return;if(this._interpreter.eventId()>0&&(this.unlockEvent(this._interpreter.eventId()),this._interpreter.clear()),!this.setupStartingEvent())return}},Game_Map.prototype.unlockEvent=function(t){this._events[t]&&this._events[t].unlock()},Game_Map.prototype.setupStartingEvent=function(){return this.refreshIfNeeded(),!!this._interpreter.setupReservedCommonEvent()||(!!this.setupTestEvent()||(!!this.setupStartingMapEvent()||!!this.setupAutorunCommonEvent()))},Game_Map.prototype.setupTestEvent=function(){return!!$testEvent&&(this._interpreter.setup($testEvent,0),$testEvent=null,!0)},Game_Map.prototype.setupStartingMapEvent=function(){for(var t=this.events(),e=0;e<t.length;e++){var a=t[e];if(a.isStarting())return a.clearStartingFlag(),this._interpreter.setup(a.list(),a.eventId()),!0}return!1},Game_Map.prototype.setupAutorunCommonEvent=function(){for(var t=0;t<$dataCommonEvents.length;t++){var e=$dataCommonEvents[t];if(e&&1===e.trigger&&$gameSwitches.value(e.switchId))return this._interpreter.setup(e.list),!0}return!1},Game_Map.prototype.isAnyEventStarting=function(){return this.events().some((function(t){return t.isStarting()}))},Game_CommonEvent.prototype.initialize=function(t){this._commonEventId=t,this.refresh()},Game_CommonEvent.prototype.event=function(){return $dataCommonEvents[this._commonEventId]},Game_CommonEvent.prototype.list=function(){return this.event().list},Game_CommonEvent.prototype.refresh=function(){this.isActive()?this._interpreter||(this._interpreter=new Game_Interpreter):this._interpreter=null},Game_CommonEvent.prototype.isActive=function(){var t=this.event();return 2===t.trigger&&$gameSwitches.value(t.switchId)},Game_CommonEvent.prototype.update=function(){this._interpreter&&(this._interpreter.isRunning()||this._interpreter.setup(this.list()),this._interpreter.update())},Object.defineProperties(Game_CharacterBase.prototype,{x:{get:function(){return this._x},configurable:!0},y:{get:function(){return this._y},configurable:!0}}),Game_CharacterBase.prototype.initialize=function(){this.initMembers()},Game_CharacterBase.prototype.initMembers=function(){this._x=0,this._y=0,this._realX=0,this._realY=0,this._moveSpeed=4,this._moveFrequency=6,this._opacity=255,this._blendMode=0,this._direction=2,this._pattern=1,this._priorityType=1,this._tileId=0,this._characterName="",this._characterIndex=0,this._isObjectCharacter=!1,this._walkAnime=!0,this._stepAnime=!1,this._directionFix=!1,this._through=!1,this._transparent=!1,this._bushDepth=0,this._animationId=0,this._balloonId=0,this._animationPlaying=!1,this._balloonPlaying=!1,this._animationCount=0,this._stopCount=0,this._jumpCount=0,this._jumpPeak=0,this._movementSuccess=!0},Game_CharacterBase.prototype.pos=function(t,e){return this._x===t&&this._y===e},Game_CharacterBase.prototype.posNt=function(t,e){return this.pos(t,e)&&!this.isThrough()},Game_CharacterBase.prototype.moveSpeed=function(){return this._moveSpeed},Game_CharacterBase.prototype.setMoveSpeed=function(t){this._moveSpeed=t},Game_CharacterBase.prototype.moveFrequency=function(){return this._moveFrequency},Game_CharacterBase.prototype.setMoveFrequency=function(t){this._moveFrequency=t},Game_CharacterBase.prototype.opacity=function(){return this._opacity},Game_CharacterBase.prototype.setOpacity=function(t){this._opacity=t},Game_CharacterBase.prototype.blendMode=function(){return this._blendMode},Game_CharacterBase.prototype.setBlendMode=function(t){this._blendMode=t},Game_CharacterBase.prototype.isNormalPriority=function(){return 1===this._priorityType},Game_CharacterBase.prototype.setPriorityType=function(t){this._priorityType=t},Game_CharacterBase.prototype.isMoving=function(){return this._realX!==this._x||this._realY!==this._y},Game_CharacterBase.prototype.isJumping=function(){return this._jumpCount>0},Game_CharacterBase.prototype.jumpHeight=function(){return(this._jumpPeak*this._jumpPeak-Math.pow(Math.abs(this._jumpCount-this._jumpPeak),2))/2},Game_CharacterBase.prototype.isStopping=function(){return!this.isMoving()&&!this.isJumping()},Game_CharacterBase.prototype.checkStop=function(t){return this._stopCount>t},Game_CharacterBase.prototype.resetStopCount=function(){this._stopCount=0},Game_CharacterBase.prototype.realMoveSpeed=function(){return this._moveSpeed+(this.isDashing()?1:0)},Game_CharacterBase.prototype.distancePerFrame=function(){return Math.pow(2,this.realMoveSpeed())/256},Game_CharacterBase.prototype.isDashing=function(){return!1},Game_CharacterBase.prototype.isDebugThrough=function(){return!1},Game_CharacterBase.prototype.straighten=function(){(this.hasWalkAnime()||this.hasStepAnime())&&(this._pattern=1),this._animationCount=0},Game_CharacterBase.prototype.reverseDir=function(t){return 10-t},Game_CharacterBase.prototype.canPass=function(t,e,a){var i=$gameMap.roundXWithDirection(t,a),r=$gameMap.roundYWithDirection(e,a);return!!$gameMap.isValid(i,r)&&(!(!this.isThrough()&&!this.isDebugThrough())||!!this.isMapPassable(t,e,a)&&!this.isCollidedWithCharacters(i,r))},Game_CharacterBase.prototype.canPassDiagonally=function(t,e,a,i){var r=$gameMap.roundXWithDirection(t,a),s=$gameMap.roundYWithDirection(e,i);return!(!this.canPass(t,e,i)||!this.canPass(t,s,a))||!(!this.canPass(t,e,a)||!this.canPass(r,e,i))},Game_CharacterBase.prototype.isMapPassable=function(t,e,a){var i=$gameMap.roundXWithDirection(t,a),r=$gameMap.roundYWithDirection(e,a),s=this.reverseDir(a);return $gameMap.isPassable(t,e,a)&&$gameMap.isPassable(i,r,s)},Game_CharacterBase.prototype.isCollidedWithCharacters=function(t,e){return this.isCollidedWithEvents(t,e)||this.isCollidedWithVehicles(t,e)},Game_CharacterBase.prototype.isCollidedWithEvents=function(t,e){return $gameMap.eventsXyNt(t,e).some((function(t){return t.isNormalPriority()}))},Game_CharacterBase.prototype.isCollidedWithVehicles=function(t,e){return $gameMap.boat().posNt(t,e)||$gameMap.ship().posNt(t,e)},Game_CharacterBase.prototype.setPosition=function(t,e){this._x=Math.round(t),this._y=Math.round(e),this._realX=t,this._realY=e},Game_CharacterBase.prototype.copyPosition=function(t){this._x=t._x,this._y=t._y,this._realX=t._realX,this._realY=t._realY,this._direction=t._direction},Game_CharacterBase.prototype.locate=function(t,e){this.setPosition(t,e),this.straighten(),this.refreshBushDepth()},Game_CharacterBase.prototype.direction=function(){return this._direction},Game_CharacterBase.prototype.setDirection=function(t){!this.isDirectionFixed()&&t&&(this._direction=t),this.resetStopCount()},Game_CharacterBase.prototype.isTile=function(){return this._tileId>0&&0===this._priorityType},Game_CharacterBase.prototype.isObjectCharacter=function(){return this._isObjectCharacter},Game_CharacterBase.prototype.shiftY=function(){return this.isObjectCharacter()?0:6},Game_CharacterBase.prototype.scrolledX=function(){return $gameMap.adjustX(this._realX)},Game_CharacterBase.prototype.scrolledY=function(){return $gameMap.adjustY(this._realY)},Game_CharacterBase.prototype.screenX=function(){var t=$gameMap.tileWidth();return Math.round(this.scrolledX()*t+t/2)},Game_CharacterBase.prototype.screenY=function(){var t=$gameMap.tileHeight();return Math.round(this.scrolledY()*t+t-this.shiftY()-this.jumpHeight())},Game_CharacterBase.prototype.screenZ=function(){return 2*this._priorityType+1},Game_CharacterBase.prototype.isNearTheScreen=function(){var t=Graphics.width,e=Graphics.height,a=$gameMap.tileWidth(),i=$gameMap.tileHeight(),r=this.scrolledX()*a+a/2-t/2,s=this.scrolledY()*i+i/2-e/2;return r>=-t&&r<=t&&s>=-e&&s<=e},Game_CharacterBase.prototype.update=function(){this.isStopping()&&this.updateStop(),this.isJumping()?this.updateJump():this.isMoving()&&this.updateMove(),this.updateAnimation()},Game_CharacterBase.prototype.updateStop=function(){this._stopCount++},Game_CharacterBase.prototype.updateJump=function(){this._jumpCount--,this._realX=(this._realX*this._jumpCount+this._x)/(this._jumpCount+1),this._realY=(this._realY*this._jumpCount+this._y)/(this._jumpCount+1),this.refreshBushDepth(),0===this._jumpCount&&(this._realX=this._x=$gameMap.roundX(this._x),this._realY=this._y=$gameMap.roundY(this._y))},Game_CharacterBase.prototype.updateMove=function(){this._x<this._realX&&(this._realX=Math.max(this._realX-this.distancePerFrame(),this._x)),this._x>this._realX&&(this._realX=Math.min(this._realX+this.distancePerFrame(),this._x)),this._y<this._realY&&(this._realY=Math.max(this._realY-this.distancePerFrame(),this._y)),this._y>this._realY&&(this._realY=Math.min(this._realY+this.distancePerFrame(),this._y)),this.isMoving()||this.refreshBushDepth()},Game_CharacterBase.prototype.updateAnimation=function(){this.updateAnimationCount(),this._animationCount>=this.animationWait()&&(this.updatePattern(),this._animationCount=0)},Game_CharacterBase.prototype.animationWait=function(){return 3*(9-this.realMoveSpeed())},Game_CharacterBase.prototype.updateAnimationCount=function(){this.isMoving()&&this.hasWalkAnime()?this._animationCount+=1.5:!this.hasStepAnime()&&this.isOriginalPattern()||this._animationCount++},Game_CharacterBase.prototype.updatePattern=function(){!this.hasStepAnime()&&this._stopCount>0?this.resetPattern():this._pattern=(this._pattern+1)%this.maxPattern()},Game_CharacterBase.prototype.maxPattern=function(){return 4},Game_CharacterBase.prototype.pattern=function(){return this._pattern<3?this._pattern:1},Game_CharacterBase.prototype.setPattern=function(t){this._pattern=t},Game_CharacterBase.prototype.isOriginalPattern=function(){return 1===this.pattern()},Game_CharacterBase.prototype.resetPattern=function(){this.setPattern(1)},Game_CharacterBase.prototype.refreshBushDepth=function(){this.isNormalPriority()&&!this.isObjectCharacter()&&this.isOnBush()&&!this.isJumping()?this.isMoving()||(this._bushDepth=12):this._bushDepth=0},Game_CharacterBase.prototype.isOnLadder=function(){return $gameMap.isLadder(this._x,this._y)},Game_CharacterBase.prototype.isOnBush=function(){return $gameMap.isBush(this._x,this._y)},Game_CharacterBase.prototype.terrainTag=function(){return $gameMap.terrainTag(this._x,this._y)},Game_CharacterBase.prototype.regionId=function(){return $gameMap.regionId(this._x,this._y)},Game_CharacterBase.prototype.increaseSteps=function(){this.isOnLadder()&&this.setDirection(8),this.resetStopCount(),this.refreshBushDepth()},Game_CharacterBase.prototype.tileId=function(){return this._tileId},Game_CharacterBase.prototype.characterName=function(){return this._characterName},Game_CharacterBase.prototype.characterIndex=function(){return this._characterIndex},Game_CharacterBase.prototype.setImage=function(t,e){this._tileId=0,this._characterName=t,this._characterIndex=e,this._isObjectCharacter=ImageManager.isObjectCharacter(t)},Game_CharacterBase.prototype.setTileImage=function(t){this._tileId=t,this._characterName="",this._characterIndex=0,this._isObjectCharacter=!0},Game_CharacterBase.prototype.checkEventTriggerTouchFront=function(t){var e=$gameMap.roundXWithDirection(this._x,t),a=$gameMap.roundYWithDirection(this._y,t);this.checkEventTriggerTouch(e,a)},Game_CharacterBase.prototype.checkEventTriggerTouch=function(t,e){return!1},Game_CharacterBase.prototype.isMovementSucceeded=function(t,e){return this._movementSuccess},Game_CharacterBase.prototype.setMovementSuccess=function(t){this._movementSuccess=t},Game_CharacterBase.prototype.moveStraight=function(t){this.setMovementSuccess(this.canPass(this._x,this._y,t)),this.isMovementSucceeded()?(this.setDirection(t),this._x=$gameMap.roundXWithDirection(this._x,t),this._y=$gameMap.roundYWithDirection(this._y,t),this._realX=$gameMap.xWithDirection(this._x,this.reverseDir(t)),this._realY=$gameMap.yWithDirection(this._y,this.reverseDir(t)),this.increaseSteps()):(this.setDirection(t),this.checkEventTriggerTouchFront(t))},Game_CharacterBase.prototype.moveDiagonally=function(t,e){this.setMovementSuccess(this.canPassDiagonally(this._x,this._y,t,e)),this.isMovementSucceeded()&&(this._x=$gameMap.roundXWithDirection(this._x,t),this._y=$gameMap.roundYWithDirection(this._y,e),this._realX=$gameMap.xWithDirection(this._x,this.reverseDir(t)),this._realY=$gameMap.yWithDirection(this._y,this.reverseDir(e)),this.increaseSteps()),this._direction===this.reverseDir(t)&&this.setDirection(t),this._direction===this.reverseDir(e)&&this.setDirection(e)},Game_CharacterBase.prototype.jump=function(t,e){Math.abs(t)>Math.abs(e)?0!==t&&this.setDirection(t<0?4:6):0!==e&&this.setDirection(e<0?8:2),this._x+=t,this._y+=e;var a=Math.round(Math.sqrt(t*t+e*e));this._jumpPeak=10+a-this._moveSpeed,this._jumpCount=2*this._jumpPeak,this.resetStopCount(),this.straighten()},Game_CharacterBase.prototype.hasWalkAnime=function(){return this._walkAnime},Game_CharacterBase.prototype.setWalkAnime=function(t){this._walkAnime=t},Game_CharacterBase.prototype.hasStepAnime=function(){return this._stepAnime},Game_CharacterBase.prototype.setStepAnime=function(t){this._stepAnime=t},Game_CharacterBase.prototype.isDirectionFixed=function(){return this._directionFix},Game_CharacterBase.prototype.setDirectionFix=function(t){this._directionFix=t},Game_CharacterBase.prototype.isThrough=function(){return this._through},Game_CharacterBase.prototype.setThrough=function(t){this._through=t},Game_CharacterBase.prototype.isTransparent=function(){return this._transparent},Game_CharacterBase.prototype.bushDepth=function(){return this._bushDepth},Game_CharacterBase.prototype.setTransparent=function(t){this._transparent=t},Game_CharacterBase.prototype.requestAnimation=function(t){this._animationId=t},Game_CharacterBase.prototype.requestBalloon=function(t){this._balloonId=t},Game_CharacterBase.prototype.animationId=function(){return this._animationId},Game_CharacterBase.prototype.balloonId=function(){return this._balloonId},Game_CharacterBase.prototype.startAnimation=function(){this._animationId=0,this._animationPlaying=!0},Game_CharacterBase.prototype.startBalloon=function(){this._balloonId=0,this._balloonPlaying=!0},Game_CharacterBase.prototype.isAnimationPlaying=function(){return this._animationId>0||this._animationPlaying},Game_CharacterBase.prototype.isBalloonPlaying=function(){return this._balloonId>0||this._balloonPlaying},Game_CharacterBase.prototype.endAnimation=function(){this._animationPlaying=!1},Game_CharacterBase.prototype.endBalloon=function(){this._balloonPlaying=!1},Game_Character.prototype=Object.create(Game_CharacterBase.prototype),Game_Character.prototype.constructor=Game_Character,Game_Character.ROUTE_END=0,Game_Character.ROUTE_MOVE_DOWN=1,Game_Character.ROUTE_MOVE_LEFT=2,Game_Character.ROUTE_MOVE_RIGHT=3,Game_Character.ROUTE_MOVE_UP=4,Game_Character.ROUTE_MOVE_LOWER_L=5,Game_Character.ROUTE_MOVE_LOWER_R=6,Game_Character.ROUTE_MOVE_UPPER_L=7,Game_Character.ROUTE_MOVE_UPPER_R=8,Game_Character.ROUTE_MOVE_RANDOM=9,Game_Character.ROUTE_MOVE_TOWARD=10,Game_Character.ROUTE_MOVE_AWAY=11,Game_Character.ROUTE_MOVE_FORWARD=12,Game_Character.ROUTE_MOVE_BACKWARD=13,Game_Character.ROUTE_JUMP=14,Game_Character.ROUTE_WAIT=15,Game_Character.ROUTE_TURN_DOWN=16,Game_Character.ROUTE_TURN_LEFT=17,Game_Character.ROUTE_TURN_RIGHT=18,Game_Character.ROUTE_TURN_UP=19,Game_Character.ROUTE_TURN_90D_R=20,Game_Character.ROUTE_TURN_90D_L=21,Game_Character.ROUTE_TURN_180D=22,Game_Character.ROUTE_TURN_90D_R_L=23,Game_Character.ROUTE_TURN_RANDOM=24,Game_Character.ROUTE_TURN_TOWARD=25,Game_Character.ROUTE_TURN_AWAY=26,Game_Character.ROUTE_SWITCH_ON=27,Game_Character.ROUTE_SWITCH_OFF=28,Game_Character.ROUTE_CHANGE_SPEED=29,Game_Character.ROUTE_CHANGE_FREQ=30,Game_Character.ROUTE_WALK_ANIME_ON=31,Game_Character.ROUTE_WALK_ANIME_OFF=32,Game_Character.ROUTE_STEP_ANIME_ON=33,Game_Character.ROUTE_STEP_ANIME_OFF=34,Game_Character.ROUTE_DIR_FIX_ON=35,Game_Character.ROUTE_DIR_FIX_OFF=36,Game_Character.ROUTE_THROUGH_ON=37,Game_Character.ROUTE_THROUGH_OFF=38,Game_Character.ROUTE_TRANSPARENT_ON=39,Game_Character.ROUTE_TRANSPARENT_OFF=40,Game_Character.ROUTE_CHANGE_IMAGE=41,Game_Character.ROUTE_CHANGE_OPACITY=42,Game_Character.ROUTE_CHANGE_BLEND_MODE=43,Game_Character.ROUTE_PLAY_SE=44,Game_Character.ROUTE_SCRIPT=45,Game_Character.prototype.initialize=function(){Game_CharacterBase.prototype.initialize.call(this)},Game_Character.prototype.initMembers=function(){Game_CharacterBase.prototype.initMembers.call(this),this._moveRouteForcing=!1,this._moveRoute=null,this._moveRouteIndex=0,this._originalMoveRoute=null,this._originalMoveRouteIndex=0,this._waitCount=0},Game_Character.prototype.memorizeMoveRoute=function(){this._originalMoveRoute=this._moveRoute,this._originalMoveRouteIndex=this._moveRouteIndex},Game_Character.prototype.restoreMoveRoute=function(){this._moveRoute=this._originalMoveRoute,this._moveRouteIndex=this._originalMoveRouteIndex,this._originalMoveRoute=null},Game_Character.prototype.isMoveRouteForcing=function(){return this._moveRouteForcing},Game_Character.prototype.setMoveRoute=function(t){this._moveRoute=t,this._moveRouteIndex=0,this._moveRouteForcing=!1},Game_Character.prototype.forceMoveRoute=function(t){this._originalMoveRoute||this.memorizeMoveRoute(),this._moveRoute=t,this._moveRouteIndex=0,this._moveRouteForcing=!0,this._waitCount=0},Game_Character.prototype.updateStop=function(){Game_CharacterBase.prototype.updateStop.call(this),this._moveRouteForcing&&this.updateRoutineMove()},Game_Character.prototype.updateRoutineMove=function(){if(this._waitCount>0)this._waitCount--;else{this.setMovementSuccess(!0);var t=this._moveRoute.list[this._moveRouteIndex];t&&(this.processMoveCommand(t),this.advanceMoveRouteIndex())}},Game_Character.prototype.processMoveCommand=function(command){var gc=Game_Character,params=command.parameters;switch(command.code){case gc.ROUTE_END:this.processRouteEnd();break;case gc.ROUTE_MOVE_DOWN:this.moveStraight(2);break;case gc.ROUTE_MOVE_LEFT:this.moveStraight(4);break;case gc.ROUTE_MOVE_RIGHT:this.moveStraight(6);break;case gc.ROUTE_MOVE_UP:this.moveStraight(8);break;case gc.ROUTE_MOVE_LOWER_L:this.moveDiagonally(4,2);break;case gc.ROUTE_MOVE_LOWER_R:this.moveDiagonally(6,2);break;case gc.ROUTE_MOVE_UPPER_L:this.moveDiagonally(4,8);break;case gc.ROUTE_MOVE_UPPER_R:this.moveDiagonally(6,8);break;case gc.ROUTE_MOVE_RANDOM:this.moveRandom();break;case gc.ROUTE_MOVE_TOWARD:this.moveTowardPlayer();break;case gc.ROUTE_MOVE_AWAY:this.moveAwayFromPlayer();break;case gc.ROUTE_MOVE_FORWARD:this.moveForward();break;case gc.ROUTE_MOVE_BACKWARD:this.moveBackward();break;case gc.ROUTE_JUMP:this.jump(params[0],params[1]);break;case gc.ROUTE_WAIT:this._waitCount=params[0]-1;break;case gc.ROUTE_TURN_DOWN:this.setDirection(2);break;case gc.ROUTE_TURN_LEFT:this.setDirection(4);break;case gc.ROUTE_TURN_RIGHT:this.setDirection(6);break;case gc.ROUTE_TURN_UP:this.setDirection(8);break;case gc.ROUTE_TURN_90D_R:this.turnRight90();break;case gc.ROUTE_TURN_90D_L:this.turnLeft90();break;case gc.ROUTE_TURN_180D:this.turn180();break;case gc.ROUTE_TURN_90D_R_L:this.turnRightOrLeft90();break;case gc.ROUTE_TURN_RANDOM:this.turnRandom();break;case gc.ROUTE_TURN_TOWARD:this.turnTowardPlayer();break;case gc.ROUTE_TURN_AWAY:this.turnAwayFromPlayer();break;case gc.ROUTE_SWITCH_ON:$gameSwitches.setValue(params[0],!0);break;case gc.ROUTE_SWITCH_OFF:$gameSwitches.setValue(params[0],!1);break;case gc.ROUTE_CHANGE_SPEED:this.setMoveSpeed(params[0]);break;case gc.ROUTE_CHANGE_FREQ:this.setMoveFrequency(params[0]);break;case gc.ROUTE_WALK_ANIME_ON:this.setWalkAnime(!0);break;case gc.ROUTE_WALK_ANIME_OFF:this.setWalkAnime(!1);break;case gc.ROUTE_STEP_ANIME_ON:this.setStepAnime(!0);break;case gc.ROUTE_STEP_ANIME_OFF:this.setStepAnime(!1);break;case gc.ROUTE_DIR_FIX_ON:this.setDirectionFix(!0);break;case gc.ROUTE_DIR_FIX_OFF:this.setDirectionFix(!1);break;case gc.ROUTE_THROUGH_ON:this.setThrough(!0);break;case gc.ROUTE_THROUGH_OFF:this.setThrough(!1);break;case gc.ROUTE_TRANSPARENT_ON:this.setTransparent(!0);break;case gc.ROUTE_TRANSPARENT_OFF:this.setTransparent(!1);break;case gc.ROUTE_CHANGE_IMAGE:this.setImage(params[0],params[1]);break;case gc.ROUTE_CHANGE_OPACITY:this.setOpacity(params[0]);break;case gc.ROUTE_CHANGE_BLEND_MODE:this.setBlendMode(params[0]);break;case gc.ROUTE_PLAY_SE:AudioManager.playSe(params[0]);break;case gc.ROUTE_SCRIPT:eval(params[0])}},Game_Character.prototype.deltaXFrom=function(t){return $gameMap.deltaX(this.x,t)},Game_Character.prototype.deltaYFrom=function(t){return $gameMap.deltaY(this.y,t)},Game_Character.prototype.moveRandom=function(){var t=2+2*Math.randomInt(4);this.canPass(this.x,this.y,t)&&this.moveStraight(t)},Game_Character.prototype.moveTowardCharacter=function(t){var e=this.deltaXFrom(t.x),a=this.deltaYFrom(t.y);Math.abs(e)>Math.abs(a)?(this.moveStraight(e>0?4:6),this.isMovementSucceeded()||0===a||this.moveStraight(a>0?8:2)):0!==a&&(this.moveStraight(a>0?8:2),this.isMovementSucceeded()||0===e||this.moveStraight(e>0?4:6))},Game_Character.prototype.moveAwayFromCharacter=function(t){var e=this.deltaXFrom(t.x),a=this.deltaYFrom(t.y);Math.abs(e)>Math.abs(a)?(this.moveStraight(e>0?6:4),this.isMovementSucceeded()||0===a||this.moveStraight(a>0?2:8)):0!==a&&(this.moveStraight(a>0?2:8),this.isMovementSucceeded()||0===e||this.moveStraight(e>0?6:4))},Game_Character.prototype.turnTowardCharacter=function(t){var e=this.deltaXFrom(t.x),a=this.deltaYFrom(t.y);Math.abs(e)>Math.abs(a)?this.setDirection(e>0?4:6):0!==a&&this.setDirection(a>0?8:2)},Game_Character.prototype.turnAwayFromCharacter=function(t){var e=this.deltaXFrom(t.x),a=this.deltaYFrom(t.y);Math.abs(e)>Math.abs(a)?this.setDirection(e>0?6:4):0!==a&&this.setDirection(a>0?2:8)},Game_Character.prototype.turnTowardPlayer=function(){this.turnTowardCharacter($gamePlayer)},Game_Character.prototype.turnAwayFromPlayer=function(){this.turnAwayFromCharacter($gamePlayer)},Game_Character.prototype.moveTowardPlayer=function(){this.moveTowardCharacter($gamePlayer)},Game_Character.prototype.moveAwayFromPlayer=function(){this.moveAwayFromCharacter($gamePlayer)},Game_Character.prototype.moveForward=function(){this.moveStraight(this.direction())},Game_Character.prototype.moveBackward=function(){var t=this.isDirectionFixed();this.setDirectionFix(!0),this.moveStraight(this.reverseDir(this.direction())),this.setDirectionFix(t)},Game_Character.prototype.processRouteEnd=function(){this._moveRoute.repeat?this._moveRouteIndex=-1:this._moveRouteForcing&&(this._moveRouteForcing=!1,this.restoreMoveRoute())},Game_Character.prototype.advanceMoveRouteIndex=function(){var t=this._moveRoute;if(t&&(this.isMovementSucceeded()||t.skippable)){var e=t.list.length-1;this._moveRouteIndex++,t.repeat&&this._moveRouteIndex>=e&&(this._moveRouteIndex=0)}},Game_Character.prototype.turnRight90=function(){switch(this.direction()){case 2:this.setDirection(4);break;case 4:this.setDirection(8);break;case 6:this.setDirection(2);break;case 8:this.setDirection(6)}},Game_Character.prototype.turnLeft90=function(){switch(this.direction()){case 2:this.setDirection(6);break;case 4:this.setDirection(2);break;case 6:this.setDirection(8);break;case 8:this.setDirection(4)}},Game_Character.prototype.turn180=function(){this.setDirection(this.reverseDir(this.direction()))},Game_Character.prototype.turnRightOrLeft90=function(){switch(Math.randomInt(2)){case 0:this.turnRight90();break;case 1:this.turnLeft90()}},Game_Character.prototype.turnRandom=function(){this.setDirection(2+2*Math.randomInt(4))},Game_Character.prototype.swap=function(t){var e=t.x,a=t.y;t.locate(this.x,this.y),this.locate(e,a)},Game_Character.prototype.findDirectionTo=function(t,e){var a=this.searchLimit(),i=$gameMap.width(),r=[],s=[],o=[],n={},p=n;if(this.x===t&&this.y===e)return 0;for(n.parent=null,n.x=this.x,n.y=this.y,n.g=0,n.f=$gameMap.distance(n.x,n.y,t,e),r.push(n),s.push(n.y*i+n.x);r.length>0;){for(var h=0,c=0;c<r.length;c++)r[c].f<r[h].f&&(h=c);var m=r[h],u=m.x,_=m.y,l=_*i+u,f=m.g;if(r.splice(h,1),s.splice(s.indexOf(l),1),o.push(l),m.x===t&&m.y===e){p=m,goaled=!0;break}if(!(f>=a))for(var y=0;y<4;y++){var d=2+2*y,G=$gameMap.roundXWithDirection(u,d),g=$gameMap.roundYWithDirection(_,d),v=g*i+G;if(!o.contains(v)&&this.canPass(u,_,d)){var A,I=f+1,M=s.indexOf(v);if(M<0||I<r[M].g)M>=0?A=r[M]:(A={},r.push(A),s.push(v)),A.parent=m,A.x=G,A.y=g,A.g=I,A.f=I+$gameMap.distance(G,g,t,e),(!p||A.f-A.g<p.f-p.g)&&(p=A)}}}for(var E=p;E.parent&&E.parent!==n;)E=E.parent;var T=$gameMap.deltaX(E.x,n.x),B=$gameMap.deltaY(E.y,n.y);if(B>0)return 2;if(T<0)return 4;if(T>0)return 6;if(B<0)return 8;var S=this.deltaXFrom(t),b=this.deltaYFrom(e);return Math.abs(S)>Math.abs(b)?S>0?4:6:0!==b?b>0?8:2:0},Game_Character.prototype.searchLimit=function(){return 12},Game_Player.prototype=Object.create(Game_Character.prototype),Game_Player.prototype.constructor=Game_Player,Game_Player.prototype.initialize=function(){Game_Character.prototype.initialize.call(this),this.setTransparent($dataSystem.optTransparent)},Game_Player.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._vehicleType="walk",this._vehicleGettingOn=!1,this._vehicleGettingOff=!1,this._dashing=!1,this._needsMapReload=!1,this._transferring=!1,this._newMapId=0,this._newX=0,this._newY=0,this._newDirection=0,this._fadeType=0,this._followers=new Game_Followers,this._encounterCount=0},Game_Player.prototype.clearTransferInfo=function(){this._transferring=!1,this._newMapId=0,this._newX=0,this._newY=0,this._newDirection=0},Game_Player.prototype.followers=function(){return this._followers},Game_Player.prototype.refresh=function(){var t=$gameParty.leader(),e=t?t.characterName():"",a=t?t.characterIndex():0;this.setImage(e,a),this._followers.refresh()},Game_Player.prototype.isStopping=function(){return!this._vehicleGettingOn&&!this._vehicleGettingOff&&Game_Character.prototype.isStopping.call(this)},Game_Player.prototype.reserveTransfer=function(t,e,a,i,r){this._transferring=!0,this._newMapId=t,this._newX=e,this._newY=a,this._newDirection=i,this._fadeType=r},Game_Player.prototype.requestMapReload=function(){this._needsMapReload=!0},Game_Player.prototype.isTransferring=function(){return this._transferring},Game_Player.prototype.newMapId=function(){return this._newMapId},Game_Player.prototype.fadeType=function(){return this._fadeType},Game_Player.prototype.performTransfer=function(){this.isTransferring()&&(this.setDirection(this._newDirection),(this._newMapId!==$gameMap.mapId()||this._needsMapReload)&&($gameMap.setup(this._newMapId),this._needsMapReload=!1),this.locate(this._newX,this._newY),this.refresh(),this.clearTransferInfo())},Game_Player.prototype.isMapPassable=function(t,e,a){var i=this.vehicle();return i?i.isMapPassable(t,e,a):Game_Character.prototype.isMapPassable.call(this,t,e,a)},Game_Player.prototype.vehicle=function(){return $gameMap.vehicle(this._vehicleType)},Game_Player.prototype.isInBoat=function(){return"boat"===this._vehicleType},Game_Player.prototype.isInShip=function(){return"ship"===this._vehicleType},Game_Player.prototype.isInAirship=function(){return"airship"===this._vehicleType},Game_Player.prototype.isInVehicle=function(){return this.isInBoat()||this.isInShip()||this.isInAirship()},Game_Player.prototype.isNormal=function(){return"walk"===this._vehicleType&&!this.isMoveRouteForcing()},Game_Player.prototype.isDashing=function(){return this._dashing},Game_Player.prototype.isDebugThrough=function(){return Input.isPressed("control")&&$gameTemp.isPlaytest()},Game_Player.prototype.isCollided=function(t,e){return!this.isThrough()&&(this.pos(t,e)||this._followers.isSomeoneCollided(t,e))},Game_Player.prototype.centerX=function(){return(Graphics.width/$gameMap.tileWidth()-1)/2},Game_Player.prototype.centerY=function(){return(Graphics.height/$gameMap.tileHeight()-1)/2},Game_Player.prototype.center=function(t,e){return $gameMap.setDisplayPos(t-this.centerX(),e-this.centerY())},Game_Player.prototype.locate=function(t,e){Game_Character.prototype.locate.call(this,t,e),this.center(t,e),this.makeEncounterCount(),this.isInVehicle()&&this.vehicle().refresh(),this._followers.synchronize(t,e,this.direction())},Game_Player.prototype.increaseSteps=function(){Game_Character.prototype.increaseSteps.call(this),this.isNormal()&&$gameParty.increaseSteps()},Game_Player.prototype.makeEncounterCount=function(){var t=$gameMap.encounterStep();this._encounterCount=Math.randomInt(t)+Math.randomInt(t)+1},Game_Player.prototype.makeEncounterTroopId=function(){var t=[],e=0;if($gameMap.encounterList().forEach((function(a){this.meetsEncounterConditions(a)&&(t.push(a),e+=a.weight)}),this),e>0)for(var a=Math.randomInt(e),i=0;i<t.length;i++)if((a-=t[i].weight)<0)return t[i].troopId;return 0},Game_Player.prototype.meetsEncounterConditions=function(t){return 0===t.regionSet.length||t.regionSet.contains(this.regionId())},Game_Player.prototype.executeEncounter=function(){if(!$gameMap.isEventRunning()&&this._encounterCount<=0){this.makeEncounterCount();var t=this.makeEncounterTroopId();return!!$dataTroops[t]&&(BattleManager.setup(t,!0,!1),BattleManager.onEncounter(),!0)}return!1},Game_Player.prototype.startMapEvent=function(t,e,a,i){$gameMap.isEventRunning()||$gameMap.eventsXy(t,e).forEach((function(t){t.isTriggerIn(a)&&t.isNormalPriority()===i&&t.start()}))},Game_Player.prototype.moveByInput=function(){if(!this.isMoving()&&this.canMove()){var t=this.getInputDirection();if(t>0)$gameTemp.clearDestination();else if($gameTemp.isDestinationValid()){var e=$gameTemp.destinationX(),a=$gameTemp.destinationY();t=this.findDirectionTo(e,a)}t>0&&this.executeMove(t)}},Game_Player.prototype.canMove=function(){return!$gameMap.isEventRunning()&&!$gameMessage.isBusy()&&(!this.isMoveRouteForcing()&&!this.areFollowersGathering()&&(!this._vehicleGettingOn&&!this._vehicleGettingOff&&!(this.isInVehicle()&&!this.vehicle().canMove())))},Game_Player.prototype.getInputDirection=function(){return Input.dir4},Game_Player.prototype.executeMove=function(t){this.moveStraight(t)},Game_Player.prototype.update=function(t){var e=this.scrolledX(),a=this.scrolledY(),i=this.isMoving();this.updateDashing(),t&&this.moveByInput(),Game_Character.prototype.update.call(this),this.updateScroll(e,a),this.updateVehicle(),this.isMoving()||this.updateNonmoving(i),this._followers.update()},Game_Player.prototype.updateDashing=function(){this.isMoving()||(!this.canMove()||this.isInVehicle()||$gameMap.isDashDisabled()?this._dashing=!1:this._dashing=this.isDashButtonPressed()||$gameTemp.isDestinationValid())},Game_Player.prototype.isDashButtonPressed=function(){var t=Input.isPressed("shift");return ConfigManager.alwaysDash?!t:t},Game_Player.prototype.updateScroll=function(t,e){var a=t,i=e,r=this.scrolledX(),s=this.scrolledY();s>i&&s>this.centerY()&&$gameMap.scrollDown(s-i),r<a&&r<this.centerX()&&$gameMap.scrollLeft(a-r),r>a&&r>this.centerX()&&$gameMap.scrollRight(r-a),s<i&&s<this.centerY()&&$gameMap.scrollUp(i-s)},Game_Player.prototype.updateVehicle=function(){this.isInVehicle()&&!this.areFollowersGathering()&&(this._vehicleGettingOn?this.updateVehicleGetOn():this._vehicleGettingOff?this.updateVehicleGetOff():this.vehicle().syncWithPlayer())},Game_Player.prototype.updateVehicleGetOn=function(){this.areFollowersGathering()||this.isMoving()||(this.setDirection(this.vehicle().direction()),this.setMoveSpeed(this.vehicle().moveSpeed()),this._vehicleGettingOn=!1,this.setTransparent(!0),this.isInAirship()&&this.setThrough(!0),this.vehicle().getOn())},Game_Player.prototype.updateVehicleGetOff=function(){!this.areFollowersGathering()&&this.vehicle().isLowest()&&(this._vehicleGettingOff=!1,this._vehicleType="walk",this.setTransparent(!1))},Game_Player.prototype.updateNonmoving=function(t){if(!$gameMap.isEventRunning()){if(t&&($gameParty.onPlayerWalk(),this.checkEventTriggerHere([1,2]),$gameMap.setupStartingEvent()))return;if(this.triggerAction())return;t?this.updateEncounterCount():$gameTemp.clearDestination()}},Game_Player.prototype.triggerAction=function(){if(this.canMove()){if(this.triggerButtonAction())return!0;if(this.triggerTouchAction())return!0}return!1},Game_Player.prototype.triggerButtonAction=function(){if(Input.isTriggered("ok")){if(this.getOnOffVehicle())return!0;if(this.checkEventTriggerHere([0]),$gameMap.setupStartingEvent())return!0;if(this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent())return!0}return!1},Game_Player.prototype.triggerTouchAction=function(){if($gameTemp.isDestinationValid()){var t=this.direction(),e=this.x,a=this.y,i=$gameMap.roundXWithDirection(e,t),r=$gameMap.roundYWithDirection(a,t),s=$gameMap.roundXWithDirection(i,t),o=$gameMap.roundYWithDirection(r,t),n=$gameTemp.destinationX(),p=$gameTemp.destinationY();if(n===e&&p===a)return this.triggerTouchActionD1(e,a);if(n===i&&p===r)return this.triggerTouchActionD2(i,r);if(n===s&&p===o)return this.triggerTouchActionD3(i,r)}return!1},Game_Player.prototype.triggerTouchActionD1=function(t,e){return!!($gameMap.airship().pos(t,e)&&TouchInput.isTriggered()&&this.getOnOffVehicle())||(this.checkEventTriggerHere([0]),$gameMap.setupStartingEvent())},Game_Player.prototype.triggerTouchActionD2=function(t,e){return!(!$gameMap.boat().pos(t,e)&&!$gameMap.ship().pos(t,e)||!TouchInput.isTriggered()||!this.getOnVehicle())||(!(!this.isInBoat()&&!this.isInShip()||!TouchInput.isTriggered()||!this.getOffVehicle())||(this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent()))},Game_Player.prototype.triggerTouchActionD3=function(t,e){return $gameMap.isCounter(t,e)&&this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent()},Game_Player.prototype.updateEncounterCount=function(){this.canEncounter()&&(this._encounterCount-=this.encounterProgressValue())},Game_Player.prototype.canEncounter=function(){return!$gameParty.hasEncounterNone()&&$gameSystem.isEncounterEnabled()&&!this.isInAirship()&&!this.isMoveRouteForcing()&&!this.isDebugThrough()},Game_Player.prototype.encounterProgressValue=function(){var t=$gameMap.isBush(this.x,this.y)?2:1;return $gameParty.hasEncounterHalf()&&(t*=.5),this.isInShip()&&(t*=.5),t},Game_Player.prototype.checkEventTriggerHere=function(t){this.canStartLocalEvents()&&this.startMapEvent(this.x,this.y,t,!1)},Game_Player.prototype.checkEventTriggerThere=function(t){if(this.canStartLocalEvents()){var e=this.direction(),a=this.x,i=this.y,r=$gameMap.roundXWithDirection(a,e),s=$gameMap.roundYWithDirection(i,e);if(this.startMapEvent(r,s,t,!0),!$gameMap.isAnyEventStarting()&&$gameMap.isCounter(r,s)){var o=$gameMap.roundXWithDirection(r,e),n=$gameMap.roundYWithDirection(s,e);this.startMapEvent(o,n,t,!0)}}},Game_Player.prototype.checkEventTriggerTouch=function(t,e){this.canStartLocalEvents()&&this.startMapEvent(t,e,[1,2],!0)},Game_Player.prototype.canStartLocalEvents=function(){return!this.isInAirship()},Game_Player.prototype.getOnOffVehicle=function(){return this.isInVehicle()?this.getOffVehicle():this.getOnVehicle()},Game_Player.prototype.getOnVehicle=function(){var t=this.direction(),e=this.x,a=this.y,i=$gameMap.roundXWithDirection(e,t),r=$gameMap.roundYWithDirection(a,t);return $gameMap.airship().pos(e,a)?this._vehicleType="airship":$gameMap.ship().pos(i,r)?this._vehicleType="ship":$gameMap.boat().pos(i,r)&&(this._vehicleType="boat"),this.isInVehicle()&&(this._vehicleGettingOn=!0,this.isInAirship()||this.forceMoveForward(),this.gatherFollowers()),this._vehicleGettingOn},Game_Player.prototype.getOffVehicle=function(){return this.vehicle().isLandOk(this.x,this.y,this.direction())&&(this.isInAirship()&&this.setDirection(2),this._followers.synchronize(this.x,this.y,this.direction()),this.vehicle().getOff(),this.isInAirship()||(this.forceMoveForward(),this.setTransparent(!1)),this._vehicleGettingOff=!0,this.setMoveSpeed(4),this.setThrough(!1),this.makeEncounterCount(),this.gatherFollowers()),this._vehicleGettingOff},Game_Player.prototype.forceMoveForward=function(){this.setThrough(!0),this.moveForward(),this.setThrough(!1)},Game_Player.prototype.isOnDamageFloor=function(){return $gameMap.isDamageFloor(this.x,this.y)&&!this.isInAirship()},Game_Player.prototype.moveStraight=function(t){this.canPass(this.x,this.y,t)&&this._followers.updateMove(),Game_Character.prototype.moveStraight.call(this,t)},Game_Player.prototype.moveDiagonally=function(t,e){this.canPassDiagonally(this.x,this.y,t,e)&&this._followers.updateMove(),Game_Character.prototype.moveDiagonally.call(this,t,e)},Game_Player.prototype.jump=function(t,e){Game_Character.prototype.jump.call(this,t,e),this._followers.jumpAll()},Game_Player.prototype.showFollowers=function(){this._followers.show()},Game_Player.prototype.hideFollowers=function(){this._followers.hide()},Game_Player.prototype.gatherFollowers=function(){this._followers.gather()},Game_Player.prototype.areFollowersGathering=function(){return this._followers.areGathering()},Game_Player.prototype.areFollowersGathered=function(){return this._followers.areGathered()},Game_Follower.prototype=Object.create(Game_Character.prototype),Game_Follower.prototype.constructor=Game_Follower,Game_Follower.prototype.initialize=function(t){Game_Character.prototype.initialize.call(this),this._memberIndex=t,this.setTransparent($dataSystem.optTransparent),this.setThrough(!0)},Game_Follower.prototype.refresh=function(){var t=this.isVisible()?this.actor().characterName():"",e=this.isVisible()?this.actor().characterIndex():0;this.setImage(t,e)},Game_Follower.prototype.actor=function(){return $gameParty.battleMembers()[this._memberIndex]},Game_Follower.prototype.isVisible=function(){return this.actor()&&$gamePlayer.followers().isVisible()},Game_Follower.prototype.update=function(){Game_Character.prototype.update.call(this),this.setMoveSpeed($gamePlayer.realMoveSpeed()),this.setOpacity($gamePlayer.opacity()),this.setBlendMode($gamePlayer.blendMode()),this.setWalkAnime($gamePlayer.hasWalkAnime()),this.setStepAnime($gamePlayer.hasStepAnime()),this.setDirectionFix($gamePlayer.isDirectionFixed()),this.setTransparent($gamePlayer.isTransparent())},Game_Follower.prototype.chaseCharacter=function(t){var e=this.deltaXFrom(t.x),a=this.deltaYFrom(t.y);0!==e&&0!==a?this.moveDiagonally(e>0?4:6,a>0?8:2):0!==e?this.moveStraight(e>0?4:6):0!==a&&this.moveStraight(a>0?8:2),this.setMoveSpeed($gamePlayer.realMoveSpeed())},Game_Followers.prototype.initialize=function(){this._visible=$dataSystem.optFollowers,this._gathering=!1,this._data=[];for(var t=1;t<$gameParty.maxBattleMembers();t++)this._data.push(new Game_Follower(t))},Game_Followers.prototype.isVisible=function(){return this._visible},Game_Followers.prototype.show=function(){this._visible=!0},Game_Followers.prototype.hide=function(){this._visible=!1},Game_Followers.prototype.follower=function(t){return this._data[t]},Game_Followers.prototype.forEach=function(t,e){this._data.forEach(t,e)},Game_Followers.prototype.reverseEach=function(t,e){this._data.reverse(),this._data.forEach(t,e),this._data.reverse()},Game_Followers.prototype.refresh=function(){this.forEach((function(t){return t.refresh()}),this)},Game_Followers.prototype.update=function(){this.areGathering()&&(this.areMoving()||this.updateMove(),this.areGathered()&&(this._gathering=!1)),this.forEach((function(t){t.update()}),this)},Game_Followers.prototype.updateMove=function(){for(var t=this._data.length-1;t>=0;t--){var e=t>0?this._data[t-1]:$gamePlayer;this._data[t].chaseCharacter(e)}},Game_Followers.prototype.jumpAll=function(){if($gamePlayer.isJumping())for(var t=0;t<this._data.length;t++){var e=this._data[t],a=$gamePlayer.deltaXFrom(e.x),i=$gamePlayer.deltaYFrom(e.y);e.jump(a,i)}},Game_Followers.prototype.synchronize=function(t,e,a){this.forEach((function(i){i.locate(t,e),i.setDirection(a)}),this)},Game_Followers.prototype.gather=function(){this._gathering=!0},Game_Followers.prototype.areGathering=function(){return this._gathering},Game_Followers.prototype.visibleFollowers=function(){return this._data.filter((function(t){return t.isVisible()}),this)},Game_Followers.prototype.areMoving=function(){return this.visibleFollowers().some((function(t){return t.isMoving()}),this)},Game_Followers.prototype.areGathered=function(){return this.visibleFollowers().every((function(t){return!t.isMoving()&&t.pos($gamePlayer.x,$gamePlayer.y)}),this)},Game_Followers.prototype.isSomeoneCollided=function(t,e){return this.visibleFollowers().some((function(a){return a.pos(t,e)}),this)},Game_Vehicle.prototype=Object.create(Game_Character.prototype),Game_Vehicle.prototype.constructor=Game_Vehicle,Game_Vehicle.prototype.initialize=function(t){Game_Character.prototype.initialize.call(this),this._type=t,this.resetDirection(),this.initMoveSpeed(),this.loadSystemSettings()},Game_Vehicle.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._type="",this._mapId=0,this._altitude=0,this._driving=!1,this._bgm=null},Game_Vehicle.prototype.isBoat=function(){return"boat"===this._type},Game_Vehicle.prototype.isShip=function(){return"ship"===this._type},Game_Vehicle.prototype.isAirship=function(){return"airship"===this._type},Game_Vehicle.prototype.resetDirection=function(){this.setDirection(4)},Game_Vehicle.prototype.initMoveSpeed=function(){this.isBoat()?this.setMoveSpeed(4):this.isShip()?this.setMoveSpeed(5):this.isAirship()&&this.setMoveSpeed(6)},Game_Vehicle.prototype.vehicle=function(){return this.isBoat()?$dataSystem.boat:this.isShip()?$dataSystem.ship:this.isAirship()?$dataSystem.airship:null},Game_Vehicle.prototype.loadSystemSettings=function(){var t=this.vehicle();this._mapId=t.startMapId,this.setPosition(t.startX,t.startY),this.setImage(t.characterName,t.characterIndex)},Game_Vehicle.prototype.refresh=function(){this._driving?(this._mapId=$gameMap.mapId(),this.syncWithPlayer()):this._mapId===$gameMap.mapId()&&this.locate(this.x,this.y),this.isAirship()?this.setPriorityType(this._driving?2:0):this.setPriorityType(1),this.setWalkAnime(this._driving),this.setStepAnime(this._driving),this.setTransparent(this._mapId!==$gameMap.mapId())},Game_Vehicle.prototype.setLocation=function(t,e,a){this._mapId=t,this.setPosition(e,a),this.refresh()},Game_Vehicle.prototype.pos=function(t,e){return this._mapId===$gameMap.mapId()&&Game_Character.prototype.pos.call(this,t,e)},Game_Vehicle.prototype.isMapPassable=function(t,e,a){var i=$gameMap.roundXWithDirection(t,a),r=$gameMap.roundYWithDirection(e,a);return this.isBoat()?$gameMap.isBoatPassable(i,r):this.isShip()?$gameMap.isShipPassable(i,r):!!this.isAirship()},Game_Vehicle.prototype.getOn=function(){this._driving=!0,this.setWalkAnime(!0),this.setStepAnime(!0),$gameSystem.saveWalkingBgm(),this.playBgm()},Game_Vehicle.prototype.getOff=function(){this._driving=!1,this.setWalkAnime(!1),this.setStepAnime(!1),this.resetDirection(),$gameSystem.replayWalkingBgm()},Game_Vehicle.prototype.setBgm=function(t){this._bgm=t},Game_Vehicle.prototype.playBgm=function(){AudioManager.playBgm(this._bgm||this.vehicle().bgm)},Game_Vehicle.prototype.syncWithPlayer=function(){this.copyPosition($gamePlayer),this.refreshBushDepth()},Game_Vehicle.prototype.screenY=function(){return Game_Character.prototype.screenY.call(this)-this._altitude},Game_Vehicle.prototype.shadowX=function(){return this.screenX()},Game_Vehicle.prototype.shadowY=function(){return this.screenY()+this._altitude},Game_Vehicle.prototype.shadowOpacity=function(){return 255*this._altitude/this.maxAltitude()},Game_Vehicle.prototype.canMove=function(){return!this.isAirship()||this.isHighest()},Game_Vehicle.prototype.update=function(){Game_Character.prototype.update.call(this),this.isAirship()&&this.updateAirship()},Game_Vehicle.prototype.updateAirship=function(){this.updateAirshipAltitude(),this.setStepAnime(this.isHighest()),this.setPriorityType(this.isLowest()?0:2)},Game_Vehicle.prototype.updateAirshipAltitude=function(){this._driving&&!this.isHighest()&&this._altitude++,this._driving||this.isLowest()||this._altitude--},Game_Vehicle.prototype.maxAltitude=function(){return 48},Game_Vehicle.prototype.isLowest=function(){return this._altitude<=0},Game_Vehicle.prototype.isHighest=function(){return this._altitude>=this.maxAltitude()},Game_Vehicle.prototype.isTakeoffOk=function(){return $gamePlayer.areFollowersGathered()},Game_Vehicle.prototype.isLandOk=function(t,e,a){if(this.isAirship()){if(!$gameMap.isAirshipLandOk(t,e))return!1;if($gameMap.eventsXy(t,e).length>0)return!1}else{var i=$gameMap.roundXWithDirection(t,a),r=$gameMap.roundYWithDirection(e,a);if(!$gameMap.isValid(i,r))return!1;if(!$gameMap.isPassable(i,r,this.reverseDir(a)))return!1;if(this.isCollidedWithCharacters(i,r))return!1}return!0},Game_Event.prototype=Object.create(Game_Character.prototype),Game_Event.prototype.constructor=Game_Event,Game_Event.prototype.initialize=function(t,e){Game_Character.prototype.initialize.call(this),this._mapId=t,this._eventId=e,this.locate(this.event().x,this.event().y),this.refresh()},Game_Event.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._moveType=0,this._trigger=0,this._starting=!1,this._erased=!1,this._pageIndex=-2,this._originalPattern=1,this._originalDirection=2,this._prelockDirection=0,this._locked=!1},Game_Event.prototype.eventId=function(){return this._eventId},Game_Event.prototype.event=function(){return $dataMap.events[this._eventId]},Game_Event.prototype.page=function(){return this.event().pages[this._pageIndex]},Game_Event.prototype.list=function(){return this.page().list},Game_Event.prototype.isCollidedWithCharacters=function(t,e){return Game_Character.prototype.isCollidedWithCharacters.call(this,t,e)||this.isCollidedWithPlayerCharacters(t,e)},Game_Event.prototype.isCollidedWithEvents=function(t,e){return $gameMap.eventsXyNt(t,e).length>0},Game_Event.prototype.isCollidedWithPlayerCharacters=function(t,e){return this.isNormalPriority()&&$gamePlayer.isCollided(t,e)},Game_Event.prototype.lock=function(){this._locked||(this._prelockDirection=this.direction(),this.turnTowardPlayer(),this._locked=!0)},Game_Event.prototype.unlock=function(){this._locked&&(this._locked=!1,this.setDirection(this._prelockDirection))},Game_Event.prototype.updateStop=function(){this._locked&&this.resetStopCount(),Game_Character.prototype.updateStop.call(this),this.isMoveRouteForcing()||this.updateSelfMovement()},Game_Event.prototype.updateSelfMovement=function(){if(!this._locked&&this.isNearTheScreen()&&this.checkStop(this.stopCountThreshold()))switch(this._moveType){case 1:this.moveTypeRandom();break;case 2:this.moveTypeTowardPlayer();break;case 3:this.moveTypeCustom()}},Game_Event.prototype.stopCountThreshold=function(){return 30*(5-this.moveFrequency())},Game_Event.prototype.moveTypeRandom=function(){switch(Math.randomInt(6)){case 0:case 1:this.moveRandom();break;case 2:case 3:case 4:this.moveForward();break;case 5:this.resetStopCount()}},Game_Event.prototype.moveTypeTowardPlayer=function(){if(this.isNearThePlayer())switch(Math.randomInt(6)){case 0:case 1:case 2:case 3:this.moveTowardPlayer();break;case 4:this.moveRandom();break;case 5:this.moveForward()}else this.moveRandom()},Game_Event.prototype.isNearThePlayer=function(){return Math.abs(this.deltaXFrom($gamePlayer.x))+Math.abs(this.deltaYFrom($gamePlayer.y))<20},Game_Event.prototype.moveTypeCustom=function(){this.updateRoutineMove()},Game_Event.prototype.isStarting=function(){return this._starting},Game_Event.prototype.clearStartingFlag=function(){this._starting=!1},Game_Event.prototype.isTriggerIn=function(t){return t.contains(this._trigger)},Game_Event.prototype.start=function(){var t=this.list();t&&t.length>1&&(this._starting=!0,this.isTriggerIn([0,1,2])&&this.lock())},Game_Event.prototype.erase=function(){this._erased=!0,this.refresh()},Game_Event.prototype.refresh=function(){var t=this._erased?-1:this.findProperPageIndex();this._pageIndex!==t&&(this._pageIndex=t,this.setupPage())},Game_Event.prototype.findProperPageIndex=function(){for(var t=this.event().pages,e=t.length-1;e>=0;e--){var a=t[e];if(this.meetsConditions(a))return e}return-1},Game_Event.prototype.meetsConditions=function(t){var e=t.conditions;if(e.switch1Valid&&!$gameSwitches.value(e.switch1Id))return!1;if(e.switch2Valid&&!$gameSwitches.value(e.switch2Id))return!1;if(e.variableValid&&$gameVariables.value(e.variableId)<e.variableValue)return!1;if(e.selfSwitchValid){var a=[this._mapId,this._eventId,e.selfSwitchCh];if(!0!==$gameSelfSwitches.value(a))return!1}if(e.itemValid){var i=$dataItems[e.itemId];if(!$gameParty.hasItem(i))return!1}if(e.actorValid){var r=$gameActors.actor(e.actorId);if(!$gameParty.members().contains(r))return!1}return!0},Game_Event.prototype.setupPage=function(){this._pageIndex>=0?this.setupPageSettings():this.clearPageSettings(),this.refreshBushDepth(),this.clearStartingFlag(),this.checkEventTriggerAuto()},Game_Event.prototype.clearPageSettings=function(){this.setImage("",0),this._moveType=0,this._trigger=null,this._interpreter=null,this.setThrough(!0)},Game_Event.prototype.setupPageSettings=function(){var t=this.page(),e=t.image;e.tileId>0?this.setTileImage(e.tileId):this.setImage(e.characterName,e.characterIndex),this._originalDirection!==e.direction&&(this._originalDirection=e.direction,this._prelockDirection=0,this.setDirectionFix(!1),this.setDirection(e.direction)),this._originalPattern!==e.pattern&&(this._originalPattern=e.pattern,this.setPattern(e.pattern)),this.setMoveSpeed(t.moveSpeed),this.setMoveFrequency(t.moveFrequency),this.setPriorityType(t.priorityType),this.setWalkAnime(t.walkAnime),this.setStepAnime(t.stepAnime),this.setDirectionFix(t.directionFix),this.setThrough(t.through),this.setMoveRoute(t.moveRoute),this._moveType=t.moveType,this._trigger=t.trigger,4===this._trigger?this._interpreter=new Game_Interpreter:this._interpreter=null},Game_Event.prototype.isOriginalPattern=function(){return this.pattern()===this._originalPattern},Game_Event.prototype.resetPattern=function(){this.setPattern(this._originalPattern)},Game_Event.prototype.checkEventTriggerTouch=function(t,e){$gameMap.isEventRunning()||2===this._trigger&&$gamePlayer.pos(t,e)&&!this.isJumping()&&this.isNormalPriority()&&this.start()},Game_Event.prototype.checkEventTriggerAuto=function(){3===this._trigger&&this.start()},Game_Event.prototype.update=function(){Game_Character.prototype.update.call(this),this.checkEventTriggerAuto(),this.updateParallel()},Game_Event.prototype.updateParallel=function(){this._interpreter&&(this._interpreter.isRunning()||this._interpreter.setup(this.list(),this._eventId),this._interpreter.update())},Game_Event.prototype.locate=function(t,e){Game_Character.prototype.locate.call(this,t,e),this._prelockDirection=0},Game_Event.prototype.forceMoveRoute=function(t){Game_Character.prototype.forceMoveRoute.call(this,t),this._prelockDirection=0},Game_Interpreter.prototype.initialize=function(t){this._depth=t||0,this.checkOverflow(),this.clear(),this._branch={},this._params=[],this._indent=0,this._frameCount=0,this._freezeChecker=0},Game_Interpreter.prototype.checkOverflow=function(){if(this._depth>=100)throw new Error("Common event calls exceeded the limit")},Game_Interpreter.prototype.clear=function(){this._mapId=0,this._eventId=0,this._list=null,this._index=0,this._waitCount=0,this._waitMode="",this._comments="",this._character=null,this._childInterpreter=null},Game_Interpreter.prototype.setup=function(t,e){this.clear(),this._mapId=$gameMap.mapId(),this._eventId=e||0,this._list=t},Game_Interpreter.prototype.eventId=function(){return this._eventId},Game_Interpreter.prototype.isOnCurrentMap=function(){return this._mapId===$gameMap.mapId()},Game_Interpreter.prototype.setupReservedCommonEvent=function(){return!!$gameTemp.isCommonEventReserved()&&(this.setup($gameTemp.reservedCommonEvent().list),$gameTemp.clearCommonEvent(),!0)},Game_Interpreter.prototype.isRunning=function(){return!!this._list},Game_Interpreter.prototype.update=function(){for(;this.isRunning()&&!this.updateChild()&&!this.updateWait()&&!SceneManager.isSceneChanging()&&this.executeCommand()&&!this.checkFreeze(););},Game_Interpreter.prototype.updateChild=function(){if(this._childInterpreter){if(this._childInterpreter.update(),this._childInterpreter.isRunning())return!0;this._childInterpreter=null}return!1},Game_Interpreter.prototype.updateWait=function(){return this.updateWaitCount()||this.updateWaitMode()},Game_Interpreter.prototype.updateWaitCount=function(){return this._waitCount>0&&(this._waitCount--,!0)},Game_Interpreter.prototype.updateWaitMode=function(){var t=!1;switch(this._waitMode){case"message":t=$gameMessage.isBusy();break;case"transfer":t=$gamePlayer.isTransferring();break;case"scroll":t=$gameMap.isScrolling();break;case"route":t=this._character.isMoveRouteForcing();break;case"animation":t=this._character.isAnimationPlaying();break;case"balloon":t=this._character.isBalloonPlaying();break;case"gather":t=$gamePlayer.areFollowersGathering();break;case"action":t=BattleManager.isActionForced();break;case"video":t=Graphics.isVideoPlaying();break;case"image":t=!ImageManager.isReady()}return t||(this._waitMode=""),t},Game_Interpreter.prototype.setWaitMode=function(t){this._waitMode=t},Game_Interpreter.prototype.wait=function(t){this._waitCount=t},Game_Interpreter.prototype.fadeSpeed=function(){return 24},Game_Interpreter.prototype.executeCommand=function(){var t=this.currentCommand();if(t){this._params=t.parameters,this._indent=t.indent;var e="command"+t.code;if("function"==typeof this[e]&&!this[e]())return!1;this._index++}else this.terminate();return!0},Game_Interpreter.prototype.checkFreeze=function(){return this._frameCount!==Graphics.frameCount&&(this._frameCount=Graphics.frameCount,this._freezeChecker=0),this._freezeChecker++>=1e5},Game_Interpreter.prototype.terminate=function(){this._list=null,this._comments=""},Game_Interpreter.prototype.skipBranch=function(){for(;this._list[this._index+1].indent>this._indent;)this._index++},Game_Interpreter.prototype.currentCommand=function(){return this._list[this._index]},Game_Interpreter.prototype.nextEventCode=function(){var t=this._list[this._index+1];return t?t.code:0},Game_Interpreter.prototype.iterateActorId=function(t,e){if(0===t)$gameParty.members().forEach(e);else{var a=$gameActors.actor(t);a&&e(a)}},Game_Interpreter.prototype.iterateActorEx=function(t,e,a){0===t?this.iterateActorId(e,a):this.iterateActorId($gameVariables.value(e),a)},Game_Interpreter.prototype.iterateActorIndex=function(t,e){if(t<0)$gameParty.members().forEach(e);else{var a=$gameParty.members()[t];a&&e(a)}},Game_Interpreter.prototype.iterateEnemyIndex=function(t,e){if(t<0)$gameTroop.members().forEach(e);else{var a=$gameTroop.members()[t];a&&e(a)}},Game_Interpreter.prototype.iterateBattler=function(t,e,a){$gameParty.inBattle()&&(0===t?this.iterateEnemyIndex(e,a):this.iterateActorId(e,a))},Game_Interpreter.prototype.character=function(t){return $gameParty.inBattle()?null:t<0?$gamePlayer:this.isOnCurrentMap()?$gameMap.event(t>0?t:this._eventId):null},Game_Interpreter.prototype.operateValue=function(t,e,a){var i=0===e?a:$gameVariables.value(a);return 0===t?i:-i},Game_Interpreter.prototype.changeHp=function(t,e,a){t.isAlive()&&(!a&&t.hp<=-e&&(e=1-t.hp),t.gainHp(e),t.isDead()&&t.performCollapse())},Game_Interpreter.prototype.command101=function(){if(!$gameMessage.isBusy()){for($gameMessage.setFaceImage(this._params[0],this._params[1]),$gameMessage.setBackground(this._params[2]),$gameMessage.setPositionType(this._params[3]);401===this.nextEventCode();)this._index++,$gameMessage.add(this.currentCommand().parameters[0]);switch(this.nextEventCode()){case 102:this._index++,this.setupChoices(this.currentCommand().parameters);break;case 103:this._index++,this.setupNumInput(this.currentCommand().parameters);break;case 104:this._index++,this.setupItemChoice(this.currentCommand().parameters)}this._index++,this.setWaitMode("message")}return!1},Game_Interpreter.prototype.command102=function(){return $gameMessage.isBusy()||(this.setupChoices(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupChoices=function(t){var e=t[0].clone(),a=t[1],i=t.length>2?t[2]:0,r=t.length>3?t[3]:2,s=t.length>4?t[4]:0;a>=e.length&&(a=-2),$gameMessage.setChoices(e,i,a),$gameMessage.setChoiceBackground(s),$gameMessage.setChoicePositionType(r),$gameMessage.setChoiceCallback(function(t){this._branch[this._indent]=t}.bind(this))},Game_Interpreter.prototype.command402=function(){return this._branch[this._indent]!==this._params[0]&&this.skipBranch(),!0},Game_Interpreter.prototype.command403=function(){return this._branch[this._indent]>=0&&this.skipBranch(),!0},Game_Interpreter.prototype.command103=function(){return $gameMessage.isBusy()||(this.setupNumInput(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupNumInput=function(t){$gameMessage.setNumberInput(t[0],t[1])},Game_Interpreter.prototype.command104=function(){return $gameMessage.isBusy()||(this.setupItemChoice(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupItemChoice=function(t){$gameMessage.setItemChoice(t[0],t[1]||2)},Game_Interpreter.prototype.command105=function(){if(!$gameMessage.isBusy()){for($gameMessage.setScroll(this._params[0],this._params[1]);405===this.nextEventCode();)this._index++,$gameMessage.add(this.currentCommand().parameters[0]);this._index++,this.setWaitMode("message")}return!1},Game_Interpreter.prototype.command108=function(){for(this._comments=[this._params[0]];408===this.nextEventCode();)this._index++,this._comments.push(this.currentCommand().parameters[0]);return!0},Game_Interpreter.prototype.command111=function(){var result=!1;switch(this._params[0]){case 0:result=$gameSwitches.value(this._params[1])===(0===this._params[2]);break;case 1:var value1=$gameVariables.value(this._params[1]),value2;switch(value2=0===this._params[2]?this._params[3]:$gameVariables.value(this._params[3]),this._params[4]){case 0:result=value1===value2;break;case 1:result=value1>=value2;break;case 2:result=value1<=value2;break;case 3:result=value1>value2;break;case 4:result=value1<value2;break;case 5:result=value1!==value2}break;case 2:if(this._eventId>0){var key=[this._mapId,this._eventId,this._params[1]];result=$gameSelfSwitches.value(key)===(0===this._params[2])}break;case 3:$gameTimer.isWorking()&&(result=0===this._params[2]?$gameTimer.seconds()>=this._params[1]:$gameTimer.seconds()<=this._params[1]);break;case 4:var actor=$gameActors.actor(this._params[1]);if(actor){var n=this._params[3];switch(this._params[2]){case 0:result=$gameParty.members().contains(actor);break;case 1:result=actor.name()===n;break;case 2:result=actor.isClass($dataClasses[n]);break;case 3:result=actor.isLearnedSkill(n);break;case 4:result=actor.hasWeapon($dataWeapons[n]);break;case 5:result=actor.hasArmor($dataArmors[n]);break;case 6:result=actor.isStateAffected(n)}}break;case 5:var enemy=$gameTroop.members()[this._params[1]];if(enemy)switch(this._params[2]){case 0:result=enemy.isAlive();break;case 1:result=enemy.isStateAffected(this._params[3])}break;case 6:var character=this.character(this._params[1]);character&&(result=character.direction()===this._params[2]);break;case 7:switch(this._params[2]){case 0:result=$gameParty.gold()>=this._params[1];break;case 1:result=$gameParty.gold()<=this._params[1];break;case 2:result=$gameParty.gold()<this._params[1]}break;case 8:result=$gameParty.hasItem($dataItems[this._params[1]]);break;case 9:result=$gameParty.hasItem($dataWeapons[this._params[1]],this._params[2]);break;case 10:result=$gameParty.hasItem($dataArmors[this._params[1]],this._params[2]);break;case 11:result=Input.isPressed(this._params[1]);break;case 12:result=!!eval(this._params[1]);break;case 13:result=$gamePlayer.vehicle()===$gameMap.vehicle(this._params[1])}return this._branch[this._indent]=result,!1===this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command411=function(){return!1!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command112=function(){return!0},Game_Interpreter.prototype.command413=function(){do{this._index--}while(this.currentCommand().indent!==this._indent);return!0},Game_Interpreter.prototype.command113=function(){for(;this._index<this._list.length-1;){this._index++;var t=this.currentCommand();if(413===t.code&&t.indent<this._indent)break}return!0},Game_Interpreter.prototype.command115=function(){return this._index=this._list.length,!0},Game_Interpreter.prototype.command117=function(){var t=$dataCommonEvents[this._params[0]];if(t){var e=this.isOnCurrentMap()?this._eventId:0;this.setupChild(t.list,e)}return!0},Game_Interpreter.prototype.setupChild=function(t,e){this._childInterpreter=new Game_Interpreter(this._depth+1),this._childInterpreter.setup(t,e)},Game_Interpreter.prototype.command118=function(){return!0},Game_Interpreter.prototype.command119=function(){for(var t=this._params[0],e=0;e<this._list.length;e++){var a=this._list[e];if(118===a.code&&a.parameters[0]===t)return void this.jumpTo(e)}return!0},Game_Interpreter.prototype.jumpTo=function(t){for(var e=this._index,a=Math.min(t,e),i=Math.max(t,e),r=this._indent,s=a;s<=i;s++){var o=this._list[s].indent;o!==r&&(this._branch[r]=null,r=o)}this._index=t},Game_Interpreter.prototype.command121=function(){for(var t=this._params[0];t<=this._params[1];t++)$gameSwitches.setValue(t,0===this._params[2]);return!0},Game_Interpreter.prototype.command122=function(){var value=0;switch(this._params[3]){case 0:value=this._params[4];break;case 1:value=$gameVariables.value(this._params[4]);break;case 2:value=this._params[4]+Math.randomInt(this._params[5]-this._params[4]+1);break;case 3:value=this.gameDataOperand(this._params[4],this._params[5],this._params[6]);break;case 4:value=eval(this._params[4])}for(var i=this._params[0];i<=this._params[1];i++)this.operateVariable(i,this._params[2],value);return!0},Game_Interpreter.prototype.gameDataOperand=function(t,e,a){switch(t){case 0:return $gameParty.numItems($dataItems[e]);case 1:return $gameParty.numItems($dataWeapons[e]);case 2:return $gameParty.numItems($dataArmors[e]);case 3:var i=$gameActors.actor(e);if(i)switch(a){case 0:return i.level;case 1:return i.currentExp();case 2:return i.hp;case 3:return i.mp;default:if(a>=4&&a<=11)return i.param(a-4)}break;case 4:var r=$gameTroop.members()[e];if(r)switch(a){case 0:return r.hp;case 1:return r.mp;default:if(a>=2&&a<=9)return r.param(a-2)}break;case 5:var s=this.character(e);if(s)switch(a){case 0:return s.x;case 1:return s.y;case 2:return s.direction();case 3:return s.screenX();case 4:return s.screenY()}break;case 6:return(i=$gameParty.members()[e])?i.actorId():0;case 7:switch(e){case 0:return $gameMap.mapId();case 1:return $gameParty.size();case 2:return $gameParty.gold();case 3:return $gameParty.steps();case 4:return $gameSystem.playtime();case 5:return $gameTimer.seconds();case 6:return $gameSystem.saveCount();case 7:return $gameSystem.battleCount();case 8:return $gameSystem.winCount();case 9:return $gameSystem.escapeCount()}}return 0},Game_Interpreter.prototype.operateVariable=function(t,e,a){try{var i=$gameVariables.value(t);switch(e){case 0:$gameVariables.setValue(t,i=a);break;case 1:$gameVariables.setValue(t,i+a);break;case 2:$gameVariables.setValue(t,i-a);break;case 3:$gameVariables.setValue(t,i*a);break;case 4:$gameVariables.setValue(t,i/a);break;case 5:$gameVariables.setValue(t,i%a)}}catch(e){$gameVariables.setValue(t,0)}},Game_Interpreter.prototype.command123=function(){if(this._eventId>0){var t=[this._mapId,this._eventId,this._params[0]];$gameSelfSwitches.setValue(t,0===this._params[1])}return!0},Game_Interpreter.prototype.command124=function(){return 0===this._params[0]?$gameTimer.start(60*this._params[1]):$gameTimer.stop(),!0},Game_Interpreter.prototype.command125=function(){var t=this.operateValue(this._params[0],this._params[1],this._params[2]);return $gameParty.gainGold(t),!0},Game_Interpreter.prototype.command126=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataItems[this._params[0]],t),!0},Game_Interpreter.prototype.command127=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataWeapons[this._params[0]],t,this._params[4]),!0},Game_Interpreter.prototype.command128=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataArmors[this._params[0]],t,this._params[4]),!0},Game_Interpreter.prototype.command129=function(){return $gameActors.actor(this._params[0])&&(0===this._params[1]?(this._params[2]&&$gameActors.actor(this._params[0]).setup(this._params[0]),$gameParty.addActor(this._params[0])):$gameParty.removeActor(this._params[0])),!0},Game_Interpreter.prototype.command132=function(){return $gameSystem.setBattleBgm(this._params[0]),!0},Game_Interpreter.prototype.command133=function(){return $gameSystem.setVictoryMe(this._params[0]),!0},Game_Interpreter.prototype.command134=function(){return 0===this._params[0]?$gameSystem.disableSave():$gameSystem.enableSave(),!0},Game_Interpreter.prototype.command135=function(){return 0===this._params[0]?$gameSystem.disableMenu():$gameSystem.enableMenu(),!0},Game_Interpreter.prototype.command136=function(){return 0===this._params[0]?$gameSystem.disableEncounter():$gameSystem.enableEncounter(),$gamePlayer.makeEncounterCount(),!0},Game_Interpreter.prototype.command137=function(){return 0===this._params[0]?$gameSystem.disableFormation():$gameSystem.enableFormation(),!0},Game_Interpreter.prototype.command138=function(){return $gameSystem.setWindowTone(this._params[0]),!0},Game_Interpreter.prototype.command139=function(){return $gameSystem.setDefeatMe(this._params[0]),!0},Game_Interpreter.prototype.command140=function(){var t=$gameMap.vehicle(this._params[0]);return t&&t.setBgm(this._params[1]),!0},Game_Interpreter.prototype.command201=function(){var t,e,a;$gameParty.inBattle()||$gameMessage.isBusy()||(0===this._params[0]?(t=this._params[1],e=this._params[2],a=this._params[3]):(t=$gameVariables.value(this._params[1]),e=$gameVariables.value(this._params[2]),a=$gameVariables.value(this._params[3])),$gamePlayer.reserveTransfer(t,e,a,this._params[4],this._params[5]),this.setWaitMode("transfer"),this._index++);return!1},Game_Interpreter.prototype.command202=function(){var t,e,a;0===this._params[1]?(t=this._params[2],e=this._params[3],a=this._params[4]):(t=$gameVariables.value(this._params[2]),e=$gameVariables.value(this._params[3]),a=$gameVariables.value(this._params[4]));var i=$gameMap.vehicle(this._params[0]);return i&&i.setLocation(t,e,a),!0},Game_Interpreter.prototype.command203=function(){var t=this.character(this._params[0]);if(t){if(0===this._params[1])t.locate(this._params[2],this._params[3]);else if(1===this._params[1]){var e=$gameVariables.value(this._params[2]),a=$gameVariables.value(this._params[3]);t.locate(e,a)}else{var i=this.character(this._params[2]);i&&t.swap(i)}this._params[4]>0&&t.setDirection(this._params[4])}return!0},Game_Interpreter.prototype.command204=function(){if(!$gameParty.inBattle()){if($gameMap.isScrolling())return this.setWaitMode("scroll"),!1;$gameMap.startScroll(this._params[0],this._params[1],this._params[2])}return!0},Game_Interpreter.prototype.command205=function(){return $gameMap.refreshIfNeeded(),this._character=this.character(this._params[0]),this._character&&(this._character.forceMoveRoute(this._params[1]),this._params[1].wait&&this.setWaitMode("route")),!0},Game_Interpreter.prototype.command206=function(){return $gamePlayer.getOnOffVehicle(),!0},Game_Interpreter.prototype.command211=function(){return $gamePlayer.setTransparent(0===this._params[0]),!0},Game_Interpreter.prototype.command212=function(){return this._character=this.character(this._params[0]),this._character&&(this._character.requestAnimation(this._params[1]),this._params[2]&&this.setWaitMode("animation")),!0},Game_Interpreter.prototype.command213=function(){return this._character=this.character(this._params[0]),this._character&&(this._character.requestBalloon(this._params[1]),this._params[2]&&this.setWaitMode("balloon")),!0},Game_Interpreter.prototype.command214=function(){return this.isOnCurrentMap()&&this._eventId>0&&$gameMap.eraseEvent(this._eventId),!0},Game_Interpreter.prototype.command216=function(){return 0===this._params[0]?$gamePlayer.showFollowers():$gamePlayer.hideFollowers(),$gamePlayer.refresh(),!0},Game_Interpreter.prototype.command217=function(){return $gameParty.inBattle()||($gamePlayer.gatherFollowers(),this.setWaitMode("gather")),!0},Game_Interpreter.prototype.command221=function(){return $gameMessage.isBusy()||($gameScreen.startFadeOut(this.fadeSpeed()),this.wait(this.fadeSpeed()),this._index++),!1},Game_Interpreter.prototype.command222=function(){return $gameMessage.isBusy()||($gameScreen.startFadeIn(this.fadeSpeed()),this.wait(this.fadeSpeed()),this._index++),!1},Game_Interpreter.prototype.command223=function(){return $gameScreen.startTint(this._params[0],this._params[1]),this._params[2]&&this.wait(this._params[1]),!0},Game_Interpreter.prototype.command224=function(){return $gameScreen.startFlash(this._params[0],this._params[1]),this._params[2]&&this.wait(this._params[1]),!0},Game_Interpreter.prototype.command225=function(){return $gameScreen.startShake(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2]),!0},Game_Interpreter.prototype.command230=function(){return this.wait(this._params[0]),!0},Game_Interpreter.prototype.command231=function(){var t,e;return 0===this._params[3]?(t=this._params[4],e=this._params[5]):(t=$gameVariables.value(this._params[4]),e=$gameVariables.value(this._params[5])),$gameScreen.showPicture(this._params[0],this._params[1],this._params[2],t,e,this._params[6],this._params[7],this._params[8],this._params[9]),!0},Game_Interpreter.prototype.command232=function(){var t,e;return 0===this._params[3]?(t=this._params[4],e=this._params[5]):(t=$gameVariables.value(this._params[4]),e=$gameVariables.value(this._params[5])),$gameScreen.movePicture(this._params[0],this._params[2],t,e,this._params[6],this._params[7],this._params[8],this._params[9],this._params[10]),this._params[11]&&this.wait(this._params[10]),!0},Game_Interpreter.prototype.command233=function(){return $gameScreen.rotatePicture(this._params[0],this._params[1]),!0},Game_Interpreter.prototype.command234=function(){return $gameScreen.tintPicture(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2]),!0},Game_Interpreter.prototype.command235=function(){return $gameScreen.erasePicture(this._params[0]),!0},Game_Interpreter.prototype.command236=function(){return $gameParty.inBattle()||($gameScreen.changeWeather(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2])),!0},Game_Interpreter.prototype.command241=function(){return AudioManager.playBgm(this._params[0]),!0},Game_Interpreter.prototype.command242=function(){return AudioManager.fadeOutBgm(this._params[0]),!0},Game_Interpreter.prototype.command243=function(){return $gameSystem.saveBgm(),!0},Game_Interpreter.prototype.command244=function(){return $gameSystem.replayBgm(),!0},Game_Interpreter.prototype.command245=function(){return AudioManager.playBgs(this._params[0]),!0},Game_Interpreter.prototype.command246=function(){return AudioManager.fadeOutBgs(this._params[0]),!0},Game_Interpreter.prototype.command249=function(){return AudioManager.playMe(this._params[0]),!0},Game_Interpreter.prototype.command250=function(){return AudioManager.playSe(this._params[0]),!0},Game_Interpreter.prototype.command251=function(){return AudioManager.stopSe(),!0},Game_Interpreter.prototype.command261=function(){if(!$gameMessage.isBusy()){var t=this._params[0];if(t.length>0){var e=this.videoFileExt();Graphics.playVideo("movies/"+t+e),this.setWaitMode("video")}this._index++}return!1},Game_Interpreter.prototype.videoFileExt=function(){return Graphics.canPlayVideoType("video/webm")&&!Utils.isMobileDevice()?".webm":".mp4"},Game_Interpreter.prototype.command281=function(){return 0===this._params[0]?$gameMap.enableNameDisplay():$gameMap.disableNameDisplay(),!0},Game_Interpreter.prototype.command282=function(){for(var t=$dataTilesets[this._params[0]],e=0;e<t.tilesetNames.length;e++)ImageManager.loadTileset(t.tilesetNames[e]);return!!ImageManager.isReady()&&($gameMap.changeTileset(this._params[0]),!0)},Game_Interpreter.prototype.command283=function(){return $gameMap.changeBattleback(this._params[0],this._params[1]),!0},Game_Interpreter.prototype.command284=function(){return $gameMap.changeParallax(this._params[0],this._params[1],this._params[2],this._params[3],this._params[4]),!0},Game_Interpreter.prototype.command285=function(){var t,e,a;switch(0===this._params[2]?(t=this._params[3],e=this._params[4]):(t=$gameVariables.value(this._params[3]),e=$gameVariables.value(this._params[4])),this._params[1]){case 0:a=$gameMap.terrainTag(t,e);break;case 1:a=$gameMap.eventIdXy(t,e);break;case 2:case 3:case 4:case 5:a=$gameMap.tileId(t,e,this._params[1]-2);break;default:a=$gameMap.regionId(t,e)}return $gameVariables.setValue(this._params[0],a),!0},Game_Interpreter.prototype.command301=function(){var t;$gameParty.inBattle()||(t=0===this._params[0]?this._params[1]:1===this._params[0]?$gameVariables.value(this._params[1]):$gamePlayer.makeEncounterTroopId(),$dataTroops[t]&&(BattleManager.setup(t,this._params[2],this._params[3]),BattleManager.setEventCallback(function(t){this._branch[this._indent]=t}.bind(this)),$gamePlayer.makeEncounterCount(),SceneManager.push(Scene_Battle)));return!0},Game_Interpreter.prototype.command601=function(){return 0!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command602=function(){return 1!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command603=function(){return 2!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command302=function(){if(!$gameParty.inBattle()){for(var t=[this._params];605===this.nextEventCode();)this._index++,t.push(this.currentCommand().parameters);SceneManager.push(Scene_Shop),SceneManager.prepareNextScene(t,this._params[4])}return!0},Game_Interpreter.prototype.command303=function(){return $gameParty.inBattle()||$dataActors[this._params[0]]&&(SceneManager.push(Scene_Name),SceneManager.prepareNextScene(this._params[0],this._params[1])),!0},Game_Interpreter.prototype.command311=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(e){this.changeHp(e,t,this._params[5])}.bind(this)),!0},Game_Interpreter.prototype.command312=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(e){e.gainMp(t)}.bind(this)),!0},Game_Interpreter.prototype.command326=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(e){e.gainTp(t)}.bind(this)),!0},Game_Interpreter.prototype.command313=function(){return this.iterateActorEx(this._params[0],this._params[1],function(t){var e=t.isDead();0===this._params[2]?t.addState(this._params[3]):t.removeState(this._params[3]),t.isDead()&&!e&&t.performCollapse(),t.clearResult()}.bind(this)),!0},Game_Interpreter.prototype.command314=function(){return this.iterateActorEx(this._params[0],this._params[1],function(t){t.recoverAll()}.bind(this)),!0},Game_Interpreter.prototype.command315=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(e){e.changeExp(e.currentExp()+t,this._params[5])}.bind(this)),!0},Game_Interpreter.prototype.command316=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(e){e.changeLevel(e.level+t,this._params[5])}.bind(this)),!0},Game_Interpreter.prototype.command317=function(){var t=this.operateValue(this._params[3],this._params[4],this._params[5]);return this.iterateActorEx(this._params[0],this._params[1],function(e){e.addParam(this._params[2],t)}.bind(this)),!0},Game_Interpreter.prototype.command318=function(){return this.iterateActorEx(this._params[0],this._params[1],function(t){0===this._params[2]?t.learnSkill(this._params[3]):t.forgetSkill(this._params[3])}.bind(this)),!0},Game_Interpreter.prototype.command319=function(){var t=$gameActors.actor(this._params[0]);return t&&t.changeEquipById(this._params[1],this._params[2]),!0},Game_Interpreter.prototype.command320=function(){var t=$gameActors.actor(this._params[0]);return t&&t.setName(this._params[1]),!0},Game_Interpreter.prototype.command321=function(){var t=$gameActors.actor(this._params[0]);return t&&$dataClasses[this._params[1]]&&t.changeClass(this._params[1],!1),!0},Game_Interpreter.prototype.command322=function(){var t=$gameActors.actor(this._params[0]);return t&&(t.setCharacterImage(this._params[1],this._params[2]),t.setFaceImage(this._params[3],this._params[4]),t.setBattlerImage(this._params[5])),$gamePlayer.refresh(),!0},Game_Interpreter.prototype.command323=function(){var t=$gameMap.vehicle(this._params[0]);return t&&t.setImage(this._params[1],this._params[2]),!0},Game_Interpreter.prototype.command324=function(){var t=$gameActors.actor(this._params[0]);return t&&t.setNickname(this._params[1]),!0},Game_Interpreter.prototype.command325=function(){var t=$gameActors.actor(this._params[0]);return t&&t.setProfile(this._params[1]),!0},Game_Interpreter.prototype.command331=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],function(e){this.changeHp(e,t,this._params[4])}.bind(this)),!0},Game_Interpreter.prototype.command332=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],function(e){e.gainMp(t)}.bind(this)),!0},Game_Interpreter.prototype.command342=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],function(e){e.gainTp(t)}.bind(this)),!0},Game_Interpreter.prototype.command333=function(){return this.iterateEnemyIndex(this._params[0],function(t){var e=t.isDead();0===this._params[1]?t.addState(this._params[2]):t.removeState(this._params[2]),t.isDead()&&!e&&t.performCollapse(),t.clearResult()}.bind(this)),!0},Game_Interpreter.prototype.command334=function(){return this.iterateEnemyIndex(this._params[0],function(t){t.recoverAll()}.bind(this)),!0},Game_Interpreter.prototype.command335=function(){return this.iterateEnemyIndex(this._params[0],function(t){t.appear(),$gameTroop.makeUniqueNames()}.bind(this)),!0},Game_Interpreter.prototype.command336=function(){return this.iterateEnemyIndex(this._params[0],function(t){t.transform(this._params[1]),$gameTroop.makeUniqueNames()}.bind(this)),!0},Game_Interpreter.prototype.command337=function(){return this.iterateEnemyIndex(this._params[0],function(t){t.isAlive()&&t.startAnimation(this._params[1],!1,0)}.bind(this)),!0},Game_Interpreter.prototype.command339=function(){return this.iterateBattler(this._params[0],this._params[1],function(t){t.isDeathStateAffected()||(t.forceAction(this._params[2],this._params[3]),BattleManager.forceAction(t),this.setWaitMode("action"))}.bind(this)),!0},Game_Interpreter.prototype.command340=function(){return BattleManager.abort(),!0},Game_Interpreter.prototype.command351=function(){return $gameParty.inBattle()||(SceneManager.push(Scene_Menu),Window_MenuCommand.initCommandPosition()),!0},Game_Interpreter.prototype.command352=function(){return $gameParty.inBattle()||SceneManager.push(Scene_Save),!0},Game_Interpreter.prototype.command353=function(){return SceneManager.goto(Scene_Gameover),!0},Game_Interpreter.prototype.command354=function(){return SceneManager.goto(Scene_Title),!0},Game_Interpreter.prototype.command355=function(){for(var script=this.currentCommand().parameters[0]+"\n";655===this.nextEventCode();)this._index++,script+=this.currentCommand().parameters[0]+"\n";return eval(script),!0},Game_Interpreter.prototype.command356=function(){var t=this._params[0].split(" "),e=t.shift();return this.pluginCommand(e,t),!0},Game_Interpreter.prototype.pluginCommand=function(t,e){};